!function(t){function e(e){for(var r,s,a=e[0],h=e[1],l=e[2],c=0,p=[];c<a.length;c++)s=a[c],n[s]&&p.push(n[s][0]),n[s]=0;for(r in h)Object.prototype.hasOwnProperty.call(h,r)&&(t[r]=h[r]);for(u&&u(e);p.length;)p.shift()();return o.push.apply(o,l||[]),i()}function i(){for(var t,e=0;e<o.length;e++){for(var i=o[e],r=!0,a=1;a<i.length;a++){var h=i[a];0!==n[h]&&(r=!1)}r&&(o.splice(e--,1),t=s(s.s=i[0]))}return t}var r={},n={11:0},o=[];function s(e){if(r[e])return r[e].exports;var i=r[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=r,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(i,r,function(e){return t[e]}.bind(null,r));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var a=window.webpackJsonp=window.webpackJsonp||[],h=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var u=h;o.push([487,0]),i()}([,,,function(t,e,i){(function(t,e){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r;"undefined"!=typeof window&&window,r=function(){var t={hello:"[ㅇㄹㄱ] 이롭게",width:0,height:0,scrollTop:0,_scrollTop:0,scrolling:!1,_oldSize:-1,size:0,bpNames:["default"]};return t.$win=$(window),t.$doc=$(document),t.setScroll=function(){t._scrollTop=t.scrollTop,t.scrollTop=Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop),t._scrollTop===t.scrollTop?t.scrolling=!1:t.scrolling=!0},t.getBreakpoint=function(){var e=parseInt(t.$bp.css("zIndex"))-1;Modernizr.mediaqueries||(e=4),e!==t.size&&(t._oldSize=t.size,t.size=e),t.width=isNaN(window.innerWidth)?t.$win.width():window.innerWidth,t.height=isNaN(window.innerHeight)?t.$win.height():window.innerHeight},$(function(){t.$body=$("body"),t.$wrapper=$("#wrapper"),t.$header=$("#header"),t.$sidenav=$("#sidenav"),t.$gnb=$("#gnb"),t.$main=$("#main"),t.$footer=$("#footer"),t.$goTop=$("#go-top"),$("#viewport-breakpoint").length||$('<div id="viewport-breakpoint"></div>').appendTo($("body")),t.$bp=$("#viewport-breakpoint"),t.bpNames=t.bpNames.concat(t.$bp.css("content").replace(/"/g,"").split(",")),requestAnimationFrame(function e(){t.getBreakpoint(),t.setScroll(),requestAnimationFrame(e)}),t.getBreakpoint(),t.setScroll(),t.ease=Sine.easeInOut}),t},"object"===i(t)&&"object"===i(t.exports)?t.exports=e.document?r():function(t){if(!t.document)throw new Error("IG requires a window with a document");return r()}:r()}).call(this,i(68)(t),i(17))},,,function(t,e,i){"use strict";t.exports=function(t){for(var e in t)t.hasOwnProperty(e)&&(t[e]=void 0)}},,,function(t,e,i){"use strict";function r(t){for(var e=document.documentElement.style,i=["Moz","Webkit","Khtml","O","ms"],r=0;r<i.length;r++){var n=i[r]+(t[0].toUpperCase()+t.slice(1));if(n in e)return n}return t}function n(t){var e=r(t);return function(t,i){return t.style[e]=i}}var o=n("transform"),s=n("transformOrigin");t.exports={prefixProperty:r,getWithVendorPrefix:function(t){var e=r(t);return function(t){return t.style[e]}},setWithVendorPrefix:n,setTransform:o,setTransformOrigin:s,setNullTransform:function(t){o(t,"translateZ(0)")},setNullTransformOrigin:function(t){s(t,"0 0 0")},setAbsolute:function(t){t.style.position="absolute"},setPixelPosition:function(t,e,i){t.style.left=e+"px",t.style.top=i+"px"},setPixelSize:function(t,e,i){t.style.width=e+"px",t.style.height=i+"px"},setNullSize:function(t){t.style.width=t.style.height=0},setFullSize:function(t){t.style.width=t.style.height="100%"},setOverflowHidden:function(t){t.style.overflow="hidden"},setOverflowVisible:function(t){t.style.overflow="visible"},setNoPointerEvents:function(t){t.style.pointerEvents="none"},setBlocking:function(t){t.style.backgroundColor="#000",t.style.opacity="0",t.style.filter="alpha(opacity=0)"}}},,,,,,,function(t,e,i){"use strict";function r(){}r.prototype.addEventListener=function(t,e){var i=this.__events=this.__events||{},r=i[t]=i[t]||[];r.indexOf(e)<0&&r.push(e)},r.prototype.removeEventListener=function(t,e){var i=(this.__events=this.__events||{})[t];if(i){var r=i.indexOf(e);r>=0&&i.splice(r,1)}},r.prototype.emit=function(t,e){var i=(this.__events=this.__events||{})[t],r=Array.prototype.slice.call(arguments,1);if(i)for(var n=0;n<i.length;n++){i[n].apply(this,r)}},t.exports=function(t){for(var e in r.prototype)r.prototype.hasOwnProperty(e)&&(t.prototype[e]=r.prototype[e])}},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},,,,,,,,,,,,function(t,e,i){"use strict";t.exports=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";t.exports=function(t,e){for(var i in e)i in t||(t[i]=e[i]);return t}},,,,,,function(t,e){var i={EPSILON:1e-6};i.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,i.RANDOM=Math.random,i.ENABLE_SIMD=!1,i.SIMD_AVAILABLE=i.ARRAY_TYPE===this.Float32Array&&"undefined"!=typeof SIMD,i.USE_SIMD=i.ENABLE_SIMD&&i.SIMD_AVAILABLE,i.setMatrixArrayType=function(t){i.ARRAY_TYPE=t};var r=Math.PI/180;i.toRadian=function(t){return t*r},i.equals=function(t,e){return Math.abs(t-e)<=i.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},t.exports=i},function(t,e,i){"use strict";function r(){this.velocity=null,this.friction=null,this.offset=null}r.equals=function(t,e){return t.velocity===e.velocity&&t.friction===e.friction&&t.offset===e.offset},r.prototype.equals=function(t){return r.equals(this,t)},r.prototype.update=function(t,e){t.offset&&(this.offset=this.offset||0,this.offset+=t.offset);var i=this.offsetFromVelocity(e);i&&(this.offset=this.offset||0,this.offset+=i),this.velocity=t.velocity,this.friction=t.friction},r.prototype.reset=function(){this.velocity=null,this.friction=null,this.offset=null},r.prototype.velocityAfter=function(t){return this.velocity?this.friction?function(t,e){if(t<0)return Math.min(0,t+e);if(t>0)return Math.max(0,t-e);return 0}(this.velocity,this.friction*t):this.velocity:null},r.prototype.offsetFromVelocity=function(t){t=Math.min(t,this.nullVelocityTime());var e=this.velocityAfter(t);return(this.velocity+e)/2*t},r.prototype.nullVelocityTime=function(){return null==this.velocity?0:this.velocity&&!this.friction?1/0:Math.abs(this.velocity/this.friction)},t.exports=r},,,,function(t,e,i){var r=i(54),n={scalar:{},SIMD:{},create:function(){var t=new r.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},clone:function(t){var e=new r.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},fromValues:function(t,e,i,n,o,s,a,h,l,u,c,p,f,d,m,v){var _=new r.ARRAY_TYPE(16);return _[0]=t,_[1]=e,_[2]=i,_[3]=n,_[4]=o,_[5]=s,_[6]=a,_[7]=h,_[8]=l,_[9]=u,_[10]=c,_[11]=p,_[12]=f,_[13]=d,_[14]=m,_[15]=v,_},set:function(t,e,i,r,n,o,s,a,h,l,u,c,p,f,d,m,v){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t[4]=o,t[5]=s,t[6]=a,t[7]=h,t[8]=l,t[9]=u,t[10]=c,t[11]=p,t[12]=f,t[13]=d,t[14]=m,t[15]=v,t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}};n.scalar.transpose=function(t,e){if(t===e){var i=e[1],r=e[2],n=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=n,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},n.SIMD.transpose=function(t,e){var i,r,n,o,s,a,h,l,u,c;return i=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),n=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4.shuffle(i,r,0,1,4,5),a=SIMD.Float32x4.shuffle(n,o,0,1,4,5),h=SIMD.Float32x4.shuffle(s,a,0,2,4,6),l=SIMD.Float32x4.shuffle(s,a,1,3,5,7),SIMD.Float32x4.store(t,0,h),SIMD.Float32x4.store(t,4,l),s=SIMD.Float32x4.shuffle(i,r,2,3,6,7),a=SIMD.Float32x4.shuffle(n,o,2,3,6,7),u=SIMD.Float32x4.shuffle(s,a,0,2,4,6),c=SIMD.Float32x4.shuffle(s,a,1,3,5,7),SIMD.Float32x4.store(t,8,u),SIMD.Float32x4.store(t,12,c),t},n.transpose=r.USE_SIMD?n.SIMD.transpose:n.scalar.transpose,n.scalar.invert=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],s=e[4],a=e[5],h=e[6],l=e[7],u=e[8],c=e[9],p=e[10],f=e[11],d=e[12],m=e[13],v=e[14],_=e[15],y=i*a-r*s,g=i*h-n*s,w=i*l-o*s,x=r*h-n*a,M=r*l-o*a,b=n*l-o*h,S=u*m-c*d,E=u*v-p*d,I=u*_-f*d,T=c*v-p*m,D=c*_-f*m,L=p*_-f*v,C=y*L-g*D+w*T+x*I-M*E+b*S;return C?(C=1/C,t[0]=(a*L-h*D+l*T)*C,t[1]=(n*D-r*L-o*T)*C,t[2]=(m*b-v*M+_*x)*C,t[3]=(p*M-c*b-f*x)*C,t[4]=(h*I-s*L-l*E)*C,t[5]=(i*L-n*I+o*E)*C,t[6]=(v*w-d*b-_*g)*C,t[7]=(u*b-p*w+f*g)*C,t[8]=(s*D-a*I+l*S)*C,t[9]=(r*I-i*D-o*S)*C,t[10]=(d*M-m*w+_*y)*C,t[11]=(c*w-u*M-f*y)*C,t[12]=(a*E-s*T-h*S)*C,t[13]=(i*T-r*E+n*S)*C,t[14]=(m*g-d*x-v*y)*C,t[15]=(u*x-c*g+p*y)*C,t):null},n.SIMD.invert=function(t,e){var i,r,n,o,s,a,h,l,u,c,p=SIMD.Float32x4.load(e,0),f=SIMD.Float32x4.load(e,4),d=SIMD.Float32x4.load(e,8),m=SIMD.Float32x4.load(e,12);return s=SIMD.Float32x4.shuffle(p,f,0,1,4,5),r=SIMD.Float32x4.shuffle(d,m,0,1,4,5),i=SIMD.Float32x4.shuffle(s,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,s,1,3,5,7),s=SIMD.Float32x4.shuffle(p,f,2,3,6,7),o=SIMD.Float32x4.shuffle(d,m,2,3,6,7),n=SIMD.Float32x4.shuffle(s,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,s,1,3,5,7),s=SIMD.Float32x4.mul(n,o),s=SIMD.Float32x4.swizzle(s,1,0,3,2),a=SIMD.Float32x4.mul(r,s),h=SIMD.Float32x4.mul(i,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),a=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,s),a),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,s),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),s=SIMD.Float32x4.mul(r,n),s=SIMD.Float32x4.swizzle(s,1,0,3,2),a=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,s),a),u=SIMD.Float32x4.mul(i,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),a=SIMD.Float32x4.sub(a,SIMD.Float32x4.mul(o,s)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,s),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),s=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,3,0,1),o),s=SIMD.Float32x4.swizzle(s,1,0,3,2),n=SIMD.Float32x4.swizzle(n,2,3,0,1),a=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,s),a),l=SIMD.Float32x4.mul(i,s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),a=SIMD.Float32x4.sub(a,SIMD.Float32x4.mul(n,s)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,s),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),s=SIMD.Float32x4.mul(i,r),s=SIMD.Float32x4.swizzle(s,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,s),l),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,s),u),s=SIMD.Float32x4.swizzle(s,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,s),l),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(n,s)),s=SIMD.Float32x4.mul(i,o),s=SIMD.Float32x4.swizzle(s,1,0,3,2),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(n,s)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,s),l),s=SIMD.Float32x4.swizzle(s,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,s),h),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,s)),s=SIMD.Float32x4.mul(i,n),s=SIMD.Float32x4.swizzle(s,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,s),h),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(r,s)),s=SIMD.Float32x4.swizzle(s,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(o,s)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,s),u),c=SIMD.Float32x4.mul(i,a),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,2,3,0,1),c),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,1,0,3,2),c),s=SIMD.Float32x4.reciprocalApproximation(c),c=SIMD.Float32x4.sub(SIMD.Float32x4.add(s,s),SIMD.Float32x4.mul(c,SIMD.Float32x4.mul(s,s))),(c=SIMD.Float32x4.swizzle(c,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(c,a)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(c,h)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(c,l)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(c,u)),t):null},n.invert=r.USE_SIMD?n.SIMD.invert:n.scalar.invert,n.scalar.adjoint=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],s=e[4],a=e[5],h=e[6],l=e[7],u=e[8],c=e[9],p=e[10],f=e[11],d=e[12],m=e[13],v=e[14],_=e[15];return t[0]=a*(p*_-f*v)-c*(h*_-l*v)+m*(h*f-l*p),t[1]=-(r*(p*_-f*v)-c*(n*_-o*v)+m*(n*f-o*p)),t[2]=r*(h*_-l*v)-a*(n*_-o*v)+m*(n*l-o*h),t[3]=-(r*(h*f-l*p)-a*(n*f-o*p)+c*(n*l-o*h)),t[4]=-(s*(p*_-f*v)-u*(h*_-l*v)+d*(h*f-l*p)),t[5]=i*(p*_-f*v)-u*(n*_-o*v)+d*(n*f-o*p),t[6]=-(i*(h*_-l*v)-s*(n*_-o*v)+d*(n*l-o*h)),t[7]=i*(h*f-l*p)-s*(n*f-o*p)+u*(n*l-o*h),t[8]=s*(c*_-f*m)-u*(a*_-l*m)+d*(a*f-l*c),t[9]=-(i*(c*_-f*m)-u*(r*_-o*m)+d*(r*f-o*c)),t[10]=i*(a*_-l*m)-s*(r*_-o*m)+d*(r*l-o*a),t[11]=-(i*(a*f-l*c)-s*(r*f-o*c)+u*(r*l-o*a)),t[12]=-(s*(c*v-p*m)-u*(a*v-h*m)+d*(a*p-h*c)),t[13]=i*(c*v-p*m)-u*(r*v-n*m)+d*(r*p-n*c),t[14]=-(i*(a*v-h*m)-s*(r*v-n*m)+d*(r*h-n*a)),t[15]=i*(a*p-h*c)-s*(r*p-n*c)+u*(r*h-n*a),t},n.SIMD.adjoint=function(t,e){var i,r,n,o,s,a,h,l,u,c,p,f,d;return i=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),n=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4.shuffle(i,r,0,1,4,5),a=SIMD.Float32x4.shuffle(n,o,0,1,4,5),s=SIMD.Float32x4.shuffle(u,a,0,2,4,6),a=SIMD.Float32x4.shuffle(a,u,1,3,5,7),u=SIMD.Float32x4.shuffle(i,r,2,3,6,7),l=SIMD.Float32x4.shuffle(n,o,2,3,6,7),h=SIMD.Float32x4.shuffle(u,l,0,2,4,6),l=SIMD.Float32x4.shuffle(l,u,1,3,5,7),u=SIMD.Float32x4.mul(h,l),u=SIMD.Float32x4.swizzle(u,1,0,3,2),c=SIMD.Float32x4.mul(a,u),p=SIMD.Float32x4.mul(s,u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,u),c),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,u),p),p=SIMD.Float32x4.swizzle(p,2,3,0,1),u=SIMD.Float32x4.mul(a,h),u=SIMD.Float32x4.swizzle(u,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,u),c),d=SIMD.Float32x4.mul(s,u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(l,u)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,u),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),u=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,3,0,1),l),u=SIMD.Float32x4.swizzle(u,1,0,3,2),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,u),c),f=SIMD.Float32x4.mul(s,u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(h,u)),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,u),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),u=SIMD.Float32x4.mul(s,a),u=SIMD.Float32x4.swizzle(u,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,u),f),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,u),d),u=SIMD.Float32x4.swizzle(u,2,3,0,1),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,u),f),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(h,u)),u=SIMD.Float32x4.mul(s,l),u=SIMD.Float32x4.swizzle(u,1,0,3,2),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(h,u)),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,u),f),u=SIMD.Float32x4.swizzle(u,2,3,0,1),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,u),p),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(a,u)),u=SIMD.Float32x4.mul(s,h),u=SIMD.Float32x4.swizzle(u,1,0,3,2),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,u),p),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(a,u)),u=SIMD.Float32x4.swizzle(u,2,3,0,1),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(l,u)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,u),d),SIMD.Float32x4.store(t,0,c),SIMD.Float32x4.store(t,4,p),SIMD.Float32x4.store(t,8,f),SIMD.Float32x4.store(t,12,d),t},n.adjoint=r.USE_SIMD?n.SIMD.adjoint:n.scalar.adjoint,n.determinant=function(t){var e=t[0],i=t[1],r=t[2],n=t[3],o=t[4],s=t[5],a=t[6],h=t[7],l=t[8],u=t[9],c=t[10],p=t[11],f=t[12],d=t[13],m=t[14],v=t[15];return(e*s-i*o)*(c*v-p*m)-(e*a-r*o)*(u*v-p*d)+(e*h-n*o)*(u*m-c*d)+(i*a-r*s)*(l*v-p*f)-(i*h-n*s)*(l*m-c*f)+(r*h-n*a)*(l*d-u*f)},n.SIMD.multiply=function(t,e,i){var r=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),s=SIMD.Float32x4.load(e,12),a=SIMD.Float32x4.load(i,0),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,3,3,3,3),s))));SIMD.Float32x4.store(t,0,h);var l=SIMD.Float32x4.load(i,4),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),s))));SIMD.Float32x4.store(t,4,u);var c=SIMD.Float32x4.load(i,8),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),s))));SIMD.Float32x4.store(t,8,p);var f=SIMD.Float32x4.load(i,12),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),s))));return SIMD.Float32x4.store(t,12,d),t},n.scalar.multiply=function(t,e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=e[4],h=e[5],l=e[6],u=e[7],c=e[8],p=e[9],f=e[10],d=e[11],m=e[12],v=e[13],_=e[14],y=e[15],g=i[0],w=i[1],x=i[2],M=i[3];return t[0]=g*r+w*a+x*c+M*m,t[1]=g*n+w*h+x*p+M*v,t[2]=g*o+w*l+x*f+M*_,t[3]=g*s+w*u+x*d+M*y,g=i[4],w=i[5],x=i[6],M=i[7],t[4]=g*r+w*a+x*c+M*m,t[5]=g*n+w*h+x*p+M*v,t[6]=g*o+w*l+x*f+M*_,t[7]=g*s+w*u+x*d+M*y,g=i[8],w=i[9],x=i[10],M=i[11],t[8]=g*r+w*a+x*c+M*m,t[9]=g*n+w*h+x*p+M*v,t[10]=g*o+w*l+x*f+M*_,t[11]=g*s+w*u+x*d+M*y,g=i[12],w=i[13],x=i[14],M=i[15],t[12]=g*r+w*a+x*c+M*m,t[13]=g*n+w*h+x*p+M*v,t[14]=g*o+w*l+x*f+M*_,t[15]=g*s+w*u+x*d+M*y,t},n.multiply=r.USE_SIMD?n.SIMD.multiply:n.scalar.multiply,n.mul=n.multiply,n.scalar.translate=function(t,e,i){var r,n,o,s,a,h,l,u,c,p,f,d,m=i[0],v=i[1],_=i[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*_+e[12],t[13]=e[1]*m+e[5]*v+e[9]*_+e[13],t[14]=e[2]*m+e[6]*v+e[10]*_+e[14],t[15]=e[3]*m+e[7]*v+e[11]*_+e[15]):(r=e[0],n=e[1],o=e[2],s=e[3],a=e[4],h=e[5],l=e[6],u=e[7],c=e[8],p=e[9],f=e[10],d=e[11],t[0]=r,t[1]=n,t[2]=o,t[3]=s,t[4]=a,t[5]=h,t[6]=l,t[7]=u,t[8]=c,t[9]=p,t[10]=f,t[11]=d,t[12]=r*m+a*v+c*_+e[12],t[13]=n*m+h*v+p*_+e[13],t[14]=o*m+l*v+f*_+e[14],t[15]=s*m+u*v+d*_+e[15]),t},n.SIMD.translate=function(t,e,i){var r=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),s=SIMD.Float32x4.load(e,12),a=SIMD.Float32x4(i[0],i[1],i[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(a,0,0,0,0)),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(a,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(a,2,2,2,2));var h=SIMD.Float32x4.add(r,SIMD.Float32x4.add(n,SIMD.Float32x4.add(o,s)));return SIMD.Float32x4.store(t,12,h),t},n.translate=r.USE_SIMD?n.SIMD.translate:n.scalar.translate,n.scalar.scale=function(t,e,i){var r=i[0],n=i[1],o=i[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},n.SIMD.scale=function(t,e,i){var r,n,o,s=SIMD.Float32x4(i[0],i[1],i[2],0);return r=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(s,0,0,0,0))),n=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(s,1,1,1,1))),o=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},n.scale=r.USE_SIMD?n.SIMD.scale:n.scalar.scale,n.rotate=function(t,e,i,n){var o,s,a,h,l,u,c,p,f,d,m,v,_,y,g,w,x,M,b,S,E,I,T,D,L=n[0],C=n[1],F=n[2],A=Math.sqrt(L*L+C*C+F*F);return Math.abs(A)<r.EPSILON?null:(L*=A=1/A,C*=A,F*=A,o=Math.sin(i),a=1-(s=Math.cos(i)),h=e[0],l=e[1],u=e[2],c=e[3],p=e[4],f=e[5],d=e[6],m=e[7],v=e[8],_=e[9],y=e[10],g=e[11],w=L*L*a+s,x=C*L*a+F*o,M=F*L*a-C*o,b=L*C*a-F*o,S=C*C*a+s,E=F*C*a+L*o,I=L*F*a+C*o,T=C*F*a-L*o,D=F*F*a+s,t[0]=h*w+p*x+v*M,t[1]=l*w+f*x+_*M,t[2]=u*w+d*x+y*M,t[3]=c*w+m*x+g*M,t[4]=h*b+p*S+v*E,t[5]=l*b+f*S+_*E,t[6]=u*b+d*S+y*E,t[7]=c*b+m*S+g*E,t[8]=h*I+p*T+v*D,t[9]=l*I+f*T+_*D,t[10]=u*I+d*T+y*D,t[11]=c*I+m*T+g*D,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},n.scalar.rotateX=function(t,e,i){var r=Math.sin(i),n=Math.cos(i),o=e[4],s=e[5],a=e[6],h=e[7],l=e[8],u=e[9],c=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*n+l*r,t[5]=s*n+u*r,t[6]=a*n+c*r,t[7]=h*n+p*r,t[8]=l*n-o*r,t[9]=u*n-s*r,t[10]=c*n-a*r,t[11]=p*n-h*r,t},n.SIMD.rotateX=function(t,e,i){var r=SIMD.Float32x4.splat(Math.sin(i)),n=SIMD.Float32x4.splat(Math.cos(i));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,4),s=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(s,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,n),SIMD.Float32x4.mul(o,r))),t},n.rotateX=r.USE_SIMD?n.SIMD.rotateX:n.scalar.rotateX,n.scalar.rotateY=function(t,e,i){var r=Math.sin(i),n=Math.cos(i),o=e[0],s=e[1],a=e[2],h=e[3],l=e[8],u=e[9],c=e[10],p=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n-l*r,t[1]=s*n-u*r,t[2]=a*n-c*r,t[3]=h*n-p*r,t[8]=o*r+l*n,t[9]=s*r+u*n,t[10]=a*r+c*n,t[11]=h*r+p*n,t},n.SIMD.rotateY=function(t,e,i){var r=SIMD.Float32x4.splat(Math.sin(i)),n=SIMD.Float32x4.splat(Math.cos(i));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),s=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(s,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(s,n))),t},n.rotateY=r.USE_SIMD?n.SIMD.rotateY:n.scalar.rotateY,n.scalar.rotateZ=function(t,e,i){var r=Math.sin(i),n=Math.cos(i),o=e[0],s=e[1],a=e[2],h=e[3],l=e[4],u=e[5],c=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n+l*r,t[1]=s*n+u*r,t[2]=a*n+c*r,t[3]=h*n+p*r,t[4]=l*n-o*r,t[5]=u*n-s*r,t[6]=c*n-a*r,t[7]=p*n-h*r,t},n.SIMD.rotateZ=function(t,e,i){var r=SIMD.Float32x4.splat(Math.sin(i)),n=SIMD.Float32x4.splat(Math.cos(i));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),s=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(s,r))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,n),SIMD.Float32x4.mul(o,r))),t},n.rotateZ=r.USE_SIMD?n.SIMD.rotateZ:n.scalar.rotateZ,n.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromRotation=function(t,e,i){var n,o,s,a=i[0],h=i[1],l=i[2],u=Math.sqrt(a*a+h*h+l*l);return Math.abs(u)<r.EPSILON?null:(a*=u=1/u,h*=u,l*=u,n=Math.sin(e),s=1-(o=Math.cos(e)),t[0]=a*a*s+o,t[1]=h*a*s+l*n,t[2]=l*a*s-h*n,t[3]=0,t[4]=a*h*s-l*n,t[5]=h*h*s+o,t[6]=l*h*s+a*n,t[7]=0,t[8]=a*l*s+h*n,t[9]=h*l*s-a*n,t[10]=l*l*s+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},n.fromXRotation=function(t,e){var i=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromYRotation=function(t,e){var i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromZRotation=function(t,e){var i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromRotationTranslation=function(t,e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=r+r,h=n+n,l=o+o,u=r*a,c=r*h,p=r*l,f=n*h,d=n*l,m=o*l,v=s*a,_=s*h,y=s*l;return t[0]=1-(f+m),t[1]=c+y,t[2]=p-_,t[3]=0,t[4]=c-y,t[5]=1-(u+m),t[6]=d+v,t[7]=0,t[8]=p+_,t[9]=d-v,t[10]=1-(u+f),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},n.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},n.getScaling=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[4],s=e[5],a=e[6],h=e[8],l=e[9],u=e[10];return t[0]=Math.sqrt(i*i+r*r+n*n),t[1]=Math.sqrt(o*o+s*s+a*a),t[2]=Math.sqrt(h*h+l*l+u*u),t},n.getRotation=function(t,e){var i=e[0]+e[5]+e[10],r=0;return i>0?(r=2*Math.sqrt(i+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},n.fromRotationTranslationScale=function(t,e,i,r){var n=e[0],o=e[1],s=e[2],a=e[3],h=n+n,l=o+o,u=s+s,c=n*h,p=n*l,f=n*u,d=o*l,m=o*u,v=s*u,_=a*h,y=a*l,g=a*u,w=r[0],x=r[1],M=r[2];return t[0]=(1-(d+v))*w,t[1]=(p+g)*w,t[2]=(f-y)*w,t[3]=0,t[4]=(p-g)*x,t[5]=(1-(c+v))*x,t[6]=(m+_)*x,t[7]=0,t[8]=(f+y)*M,t[9]=(m-_)*M,t[10]=(1-(c+d))*M,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},n.fromRotationTranslationScaleOrigin=function(t,e,i,r,n){var o=e[0],s=e[1],a=e[2],h=e[3],l=o+o,u=s+s,c=a+a,p=o*l,f=o*u,d=o*c,m=s*u,v=s*c,_=a*c,y=h*l,g=h*u,w=h*c,x=r[0],M=r[1],b=r[2],S=n[0],E=n[1],I=n[2];return t[0]=(1-(m+_))*x,t[1]=(f+w)*x,t[2]=(d-g)*x,t[3]=0,t[4]=(f-w)*M,t[5]=(1-(p+_))*M,t[6]=(v+y)*M,t[7]=0,t[8]=(d+g)*b,t[9]=(v-y)*b,t[10]=(1-(p+m))*b,t[11]=0,t[12]=i[0]+S-(t[0]*S+t[4]*E+t[8]*I),t[13]=i[1]+E-(t[1]*S+t[5]*E+t[9]*I),t[14]=i[2]+I-(t[2]*S+t[6]*E+t[10]*I),t[15]=1,t},n.fromQuat=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],s=i+i,a=r+r,h=n+n,l=i*s,u=r*s,c=r*a,p=n*s,f=n*a,d=n*h,m=o*s,v=o*a,_=o*h;return t[0]=1-c-d,t[1]=u+_,t[2]=p-v,t[3]=0,t[4]=u-_,t[5]=1-l-d,t[6]=f+m,t[7]=0,t[8]=p+v,t[9]=f-m,t[10]=1-l-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.frustum=function(t,e,i,r,n,o,s){var a=1/(i-e),h=1/(n-r),l=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*h,t[6]=0,t[7]=0,t[8]=(i+e)*a,t[9]=(n+r)*h,t[10]=(s+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*l,t[15]=0,t},n.perspective=function(t,e,i,r,n){var o=1/Math.tan(e/2),s=1/(r-n);return t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(n+r)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*n*r*s,t[15]=0,t},n.perspectiveFromFieldOfView=function(t,e,i,r){var n=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),h=2/(s+a),l=2/(n+o);return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-(s-a)*h*.5,t[9]=(n-o)*l*.5,t[10]=r/(i-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*i/(i-r),t[15]=0,t},n.ortho=function(t,e,i,r,n,o,s){var a=1/(e-i),h=1/(r-n),l=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+i)*a,t[13]=(n+r)*h,t[14]=(s+o)*l,t[15]=1,t},n.lookAt=function(t,e,i,o){var s,a,h,l,u,c,p,f,d,m,v=e[0],_=e[1],y=e[2],g=o[0],w=o[1],x=o[2],M=i[0],b=i[1],S=i[2];return Math.abs(v-M)<r.EPSILON&&Math.abs(_-b)<r.EPSILON&&Math.abs(y-S)<r.EPSILON?n.identity(t):(p=v-M,f=_-b,d=y-S,s=w*(d*=m=1/Math.sqrt(p*p+f*f+d*d))-x*(f*=m),a=x*(p*=m)-g*d,h=g*f-w*p,(m=Math.sqrt(s*s+a*a+h*h))?(s*=m=1/m,a*=m,h*=m):(s=0,a=0,h=0),l=f*h-d*a,u=d*s-p*h,c=p*a-f*s,(m=Math.sqrt(l*l+u*u+c*c))?(l*=m=1/m,u*=m,c*=m):(l=0,u=0,c=0),t[0]=s,t[1]=l,t[2]=p,t[3]=0,t[4]=a,t[5]=u,t[6]=f,t[7]=0,t[8]=h,t[9]=c,t[10]=d,t[11]=0,t[12]=-(s*v+a*_+h*y),t[13]=-(l*v+u*_+c*y),t[14]=-(p*v+f*_+d*y),t[15]=1,t)},n.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},n.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t},n.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t},n.sub=n.subtract,n.multiplyScalar=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t},n.multiplyScalarAndAdd=function(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t[6]=e[6]+i[6]*r,t[7]=e[7]+i[7]*r,t[8]=e[8]+i[8]*r,t[9]=e[9]+i[9]*r,t[10]=e[10]+i[10]*r,t[11]=e[11]+i[11]*r,t[12]=e[12]+i[12]*r,t[13]=e[13]+i[13]*r,t[14]=e[14]+i[14]*r,t[15]=e[15]+i[15]*r,t},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},n.equals=function(t,e){var i=t[0],n=t[1],o=t[2],s=t[3],a=t[4],h=t[5],l=t[6],u=t[7],c=t[8],p=t[9],f=t[10],d=t[11],m=t[12],v=t[13],_=t[14],y=t[15],g=e[0],w=e[1],x=e[2],M=e[3],b=e[4],S=e[5],E=e[6],I=e[7],T=e[8],D=e[9],L=e[10],C=e[11],F=e[12],A=e[13],z=e[14],P=e[15];return Math.abs(i-g)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(n-w)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(o-x)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(s-M)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(a-b)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(h-S)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(l-E)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(u-I)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(c-T)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(p-D)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(f-L)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(L))&&Math.abs(d-C)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(m-F)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(F))&&Math.abs(v-A)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(A))&&Math.abs(_-z)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(z))&&Math.abs(y-P)<=r.EPSILON*Math.max(1,Math.abs(y),Math.abs(P))},t.exports=n},,,,,,,,,function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){"use strict";var r=(window.performance&&window.performance.now?function(){return window.performance.now()}:null)||function(){return Date.now()};t.exports=r},,,,,,,,function(t,e,i){"use strict";t.exports={WebGlStage:i(146),CssStage:i(152),FlashStage:i(153),WebGlCubeRenderer:i(155),WebGlFlatRenderer:i(158),WebGlEquirectRenderer:i(159),CssCubeRenderer:i(160),CssFlatRenderer:i(166),FlashCubeRenderer:i(168),FlashFlatRenderer:i(171),registerDefaultRenderers:i(172),CubeGeometry:i(128),FlatGeometry:i(130),EquirectGeometry:i(236),RectilinearView:i(237),FlatView:i(238),ImageUrlSource:i(239),SingleAssetSource:i(241),DynamicCanvasAsset:i(242),StaticCanvasAsset:i(151),TextureStore:i(176),Layer:i(178),RenderLoop:i(180),KeyControlMethod:i(181),DragControlMethod:i(182),QtvrControlMethod:i(185),ScrollZoomControlMethod:i(186),PinchZoomControlMethod:i(187),VelocityControlMethod:i(245),ElementPressControlMethod:i(246),Controls:i(188),Dynamics:i(55),Viewer:i(248),Scene:i(189),Hotspot:i(191),HotspotContainer:i(190),colorEffects:i(252),registerDefaultControls:i(193),autorotate:i(253),util:{async:i(148),cancelize:i(149),chain:i(132),clamp:i(83),clock:i(69),cmp:i(90),compose:i(174),convertFov:i(173),decimal:i(86),defaults:i(48),defer:i(154),degToRad:i(254),delay:i(175),dom:i(9),extend:i(179),hash:i(81),inherits:i(29),mod:i(85),noop:i(92),once:i(99),pixelRatio:i(100),radToDeg:i(170),real:i(131),retry:i(177),tween:i(194),type:i(91)},dependencies:{bowser:i(80),glMatrix:i(255),eventEmitter:i(16),hammerjs:i(183)}}},,,function(t,e,i){var r;r=function(){var t=!0;function e(e){function i(t){var i=e.match(t);return i&&i.length>1&&i[1]||""}function r(t){var i=e.match(t);return i&&i.length>1&&i[2]||""}var n,s=i(/(ipod|iphone|ipad)/i).toLowerCase(),a=!/like android/i.test(e)&&/android/i.test(e),h=/nexus\s*[0-6]\s*/i.test(e),l=!h&&/nexus\s*[0-9]+/i.test(e),u=/CrOS/.test(e),c=/silk/i.test(e),p=/sailfish/i.test(e),f=/tizen/i.test(e),d=/(web|hpw)(o|0)s/i.test(e),m=/windows phone/i.test(e),v=(/SamsungBrowser/i.test(e),!m&&/windows/i.test(e)),_=!s&&!c&&/macintosh/i.test(e),y=!a&&!p&&!f&&!d&&/linux/i.test(e),g=r(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),w=i(/version\/(\d+(\.\d+)?)/i),x=/tablet/i.test(e)&&!/tablet pc/i.test(e),M=!x&&/[^-]mobi/i.test(e),b=/xbox/i.test(e);/opera/i.test(e)?n={name:"Opera",opera:t,version:w||i(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(e)?n={name:"Opera",opera:t,version:i(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||w}:/SamsungBrowser/i.test(e)?n={name:"Samsung Internet for Android",samsungBrowser:t,version:w||i(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/Whale/i.test(e)?n={name:"NAVER Whale browser",whale:t,version:i(/(?:whale)[\s\/](\d+(?:\.\d+)+)/i)}:/MZBrowser/i.test(e)?n={name:"MZ Browser",mzbrowser:t,version:i(/(?:MZBrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/coast/i.test(e)?n={name:"Opera Coast",coast:t,version:w||i(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/focus/i.test(e)?n={name:"Focus",focus:t,version:i(/(?:focus)[\s\/](\d+(?:\.\d+)+)/i)}:/yabrowser/i.test(e)?n={name:"Yandex Browser",yandexbrowser:t,version:w||i(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(e)?n={name:"UC Browser",ucbrowser:t,version:i(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(e)?n={name:"Maxthon",maxthon:t,version:i(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(e)?n={name:"Epiphany",epiphany:t,version:i(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(e)?n={name:"Puffin",puffin:t,version:i(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(e)?n={name:"Sleipnir",sleipnir:t,version:i(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(e)?n={name:"K-Meleon",kMeleon:t,version:i(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:m?(n={name:"Windows Phone",osname:"Windows Phone",windowsphone:t},g?(n.msedge=t,n.version=g):(n.msie=t,n.version=i(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(e)?n={name:"Internet Explorer",msie:t,version:i(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:u?n={name:"Chrome",osname:"Chrome OS",chromeos:t,chromeBook:t,chrome:t,version:i(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(e)?n={name:"Microsoft Edge",msedge:t,version:g}:/vivaldi/i.test(e)?n={name:"Vivaldi",vivaldi:t,version:i(/vivaldi\/(\d+(\.\d+)?)/i)||w}:p?n={name:"Sailfish",osname:"Sailfish OS",sailfish:t,version:i(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(e)?n={name:"SeaMonkey",seamonkey:t,version:i(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(e)?(n={name:"Firefox",firefox:t,version:i(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(e)&&(n.firefoxos=t,n.osname="Firefox OS")):c?n={name:"Amazon Silk",silk:t,version:i(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(e)?n={name:"PhantomJS",phantom:t,version:i(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(e)?n={name:"SlimerJS",slimer:t,version:i(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(e)||/rim\stablet/i.test(e)?n={name:"BlackBerry",osname:"BlackBerry OS",blackberry:t,version:w||i(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:d?(n={name:"WebOS",osname:"WebOS",webos:t,version:w||i(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(e)&&(n.touchpad=t)):/bada/i.test(e)?n={name:"Bada",osname:"Bada",bada:t,version:i(/dolfin\/(\d+(\.\d+)?)/i)}:f?n={name:"Tizen",osname:"Tizen",tizen:t,version:i(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||w}:/qupzilla/i.test(e)?n={name:"QupZilla",qupzilla:t,version:i(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||w}:/chromium/i.test(e)?n={name:"Chromium",chromium:t,version:i(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||w}:/chrome|crios|crmo/i.test(e)?n={name:"Chrome",chrome:t,version:i(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:a?n={name:"Android",version:w}:/safari|applewebkit/i.test(e)?(n={name:"Safari",safari:t},w&&(n.version=w)):s?(n={name:"iphone"==s?"iPhone":"ipad"==s?"iPad":"iPod"},w&&(n.version=w)):n=/googlebot/i.test(e)?{name:"Googlebot",googlebot:t,version:i(/googlebot\/(\d+(\.\d+))/i)||w}:{name:i(/^(.*)\/(.*) /),version:r(/^(.*)\/(.*) /)},!n.msedge&&/(apple)?webkit/i.test(e)?(/(apple)?webkit\/537\.36/i.test(e)?(n.name=n.name||"Blink",n.blink=t):(n.name=n.name||"Webkit",n.webkit=t),!n.version&&w&&(n.version=w)):!n.opera&&/gecko\//i.test(e)&&(n.name=n.name||"Gecko",n.gecko=t,n.version=n.version||i(/gecko\/(\d+(\.\d+)?)/i)),n.windowsphone||!a&&!n.silk?!n.windowsphone&&s?(n[s]=t,n.ios=t,n.osname="iOS"):_?(n.mac=t,n.osname="macOS"):b?(n.xbox=t,n.osname="Xbox"):v?(n.windows=t,n.osname="Windows"):y&&(n.linux=t,n.osname="Linux"):(n.android=t,n.osname="Android");var S="";n.windows?S=function(t){switch(t){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}(i(/Windows ((NT|XP)( \d\d?.\d)?)/i)):n.windowsphone?S=i(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):n.mac?S=(S=i(/Mac OS X (\d+([_\.\s]\d+)*)/i)).replace(/[_\s]/g,"."):s?S=(S=i(/os (\d+([_\s]\d+)*) like mac os x/i)).replace(/[_\s]/g,"."):a?S=i(/android[ \/-](\d+(\.\d+)*)/i):n.webos?S=i(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):n.blackberry?S=i(/rim\stablet\sos\s(\d+(\.\d+)*)/i):n.bada?S=i(/bada\/(\d+(\.\d+)*)/i):n.tizen&&(S=i(/tizen[\/\s](\d+(\.\d+)*)/i)),S&&(n.osversion=S);var E=!n.windows&&S.split(".")[0];return x||l||"ipad"==s||a&&(3==E||E>=4&&!M)||n.silk?n.tablet=t:(M||"iphone"==s||"ipod"==s||a||h||n.blackberry||n.webos||n.bada)&&(n.mobile=t),n.msedge||n.msie&&n.version>=10||n.yandexbrowser&&n.version>=15||n.vivaldi&&n.version>=1||n.chrome&&n.version>=20||n.samsungBrowser&&n.version>=4||n.whale&&1===o([n.version,"1.0"])||n.mzbrowser&&1===o([n.version,"6.0"])||n.focus&&1===o([n.version,"1.0"])||n.firefox&&n.version>=20||n.safari&&n.version>=6||n.opera&&n.version>=10||n.ios&&n.osversion&&n.osversion.split(".")[0]>=6||n.blackberry&&n.version>=10.1||n.chromium&&n.version>=20?n.a=t:n.msie&&n.version<10||n.chrome&&n.version<20||n.firefox&&n.version<20||n.safari&&n.version<6||n.opera&&n.version<10||n.ios&&n.osversion&&n.osversion.split(".")[0]<6||n.chromium&&n.version<20?n.c=t:n.x=t,n}var i=e("undefined"!=typeof navigator&&navigator.userAgent||"");function r(t){return t.split(".").length}function n(t,e){var i,r=[];if(Array.prototype.map)return Array.prototype.map.call(t,e);for(i=0;i<t.length;i++)r.push(e(t[i]));return r}function o(t){for(var e=Math.max(r(t[0]),r(t[1])),i=n(t,function(t){var i=e-r(t);return n((t+=new Array(i+1).join(".0")).split("."),function(t){return new Array(20-t.length).join("0")+t}).reverse()});--e>=0;){if(i[0][e]>i[1][e])return 1;if(i[0][e]!==i[1][e])return-1;if(0===e)return 0}}function s(t,r,n){var s=i;"string"==typeof r&&(n=r,r=void 0),void 0===r&&(r=!1),n&&(s=e(n));var a=""+s.version;for(var h in t)if(t.hasOwnProperty(h)&&s[h]){if("string"!=typeof t[h])throw new Error("Browser version in the minVersion map should be a string: "+h+": "+String(t));return o([a,t[h]])<0}return r}return i.test=function(t){for(var e=0;e<t.length;++e){var r=t[e];if("string"==typeof r&&r in i)return!0}return!1},i.isUnsupportedBrowser=s,i.compareVersions=o,i.check=function(t,e,i){return!s(t,e,i)},i._detect=e,i.detect=e,i},t.exports?t.exports=r():i(227)("bowser",r)},function(t,e,i){"use strict";t.exports=function(){for(var t=0,e=0;e<arguments.length;e++){var i=arguments[e];t+=i,t+=i<<10,t^=i>>6}return t+=t<<3,t^=t>>11,(t+=t<<15)>=0?t:-t}},function(t,e,i){var r,n=i(54),o={};o.create=function(){var t=new n.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},o.clone=function(t){var e=new n.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},o.fromValues=function(t,e,i){var r=new n.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=i,r},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.set=function(t,e,i,r){return t[0]=e,t[1]=i,t[2]=r,t},o.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},o.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t},o.sub=o.subtract,o.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t},o.mul=o.multiply,o.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t},o.div=o.divide,o.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},o.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},o.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t},o.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t},o.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},o.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},o.scaleAndAdd=function(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t},o.distance=function(t,e){var i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(i*i+r*r+n*n)},o.dist=o.distance,o.squaredDistance=function(t,e){var i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2];return i*i+r*r+n*n},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],i=t[1],r=t[2];return Math.sqrt(e*e+i*i+r*r)},o.len=o.length,o.squaredLength=function(t){var e=t[0],i=t[1],r=t[2];return e*e+i*i+r*r},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},o.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},o.normalize=function(t,e){var i=e[0],r=e[1],n=e[2],o=i*i+r*r+n*n;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},o.cross=function(t,e,i){var r=e[0],n=e[1],o=e[2],s=i[0],a=i[1],h=i[2];return t[0]=n*h-o*a,t[1]=o*s-r*h,t[2]=r*a-n*s,t},o.lerp=function(t,e,i,r){var n=e[0],o=e[1],s=e[2];return t[0]=n+r*(i[0]-n),t[1]=o+r*(i[1]-o),t[2]=s+r*(i[2]-s),t},o.hermite=function(t,e,i,r,n,o){var s=o*o,a=s*(2*o-3)+1,h=s*(o-2)+o,l=s*(o-1),u=s*(3-2*o);return t[0]=e[0]*a+i[0]*h+r[0]*l+n[0]*u,t[1]=e[1]*a+i[1]*h+r[1]*l+n[1]*u,t[2]=e[2]*a+i[2]*h+r[2]*l+n[2]*u,t},o.bezier=function(t,e,i,r,n,o){var s=1-o,a=s*s,h=o*o,l=a*s,u=3*o*a,c=3*h*s,p=h*o;return t[0]=e[0]*l+i[0]*u+r[0]*c+n[0]*p,t[1]=e[1]*l+i[1]*u+r[1]*c+n[1]*p,t[2]=e[2]*l+i[2]*u+r[2]*c+n[2]*p,t},o.random=function(t,e){e=e||1;var i=2*n.RANDOM()*Math.PI,r=2*n.RANDOM()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(i)*o,t[1]=Math.sin(i)*o,t[2]=r*e,t},o.transformMat4=function(t,e,i){var r=e[0],n=e[1],o=e[2],s=i[3]*r+i[7]*n+i[11]*o+i[15];return s=s||1,t[0]=(i[0]*r+i[4]*n+i[8]*o+i[12])/s,t[1]=(i[1]*r+i[5]*n+i[9]*o+i[13])/s,t[2]=(i[2]*r+i[6]*n+i[10]*o+i[14])/s,t},o.transformMat3=function(t,e,i){var r=e[0],n=e[1],o=e[2];return t[0]=r*i[0]+n*i[3]+o*i[6],t[1]=r*i[1]+n*i[4]+o*i[7],t[2]=r*i[2]+n*i[5]+o*i[8],t},o.transformQuat=function(t,e,i){var r=e[0],n=e[1],o=e[2],s=i[0],a=i[1],h=i[2],l=i[3],u=l*r+a*o-h*n,c=l*n+h*r-s*o,p=l*o+s*n-a*r,f=-s*r-a*n-h*o;return t[0]=u*l+f*-s+c*-h-p*-a,t[1]=c*l+f*-a+p*-s-u*-h,t[2]=p*l+f*-h+u*-a-c*-s,t},o.rotateX=function(t,e,i,r){var n=[],o=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],o[0]=n[0],o[1]=n[1]*Math.cos(r)-n[2]*Math.sin(r),o[2]=n[1]*Math.sin(r)+n[2]*Math.cos(r),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},o.rotateY=function(t,e,i,r){var n=[],o=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],o[0]=n[2]*Math.sin(r)+n[0]*Math.cos(r),o[1]=n[1],o[2]=n[2]*Math.cos(r)-n[0]*Math.sin(r),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},o.rotateZ=function(t,e,i,r){var n=[],o=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],o[0]=n[0]*Math.cos(r)-n[1]*Math.sin(r),o[1]=n[0]*Math.sin(r)+n[1]*Math.cos(r),o[2]=n[2],t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},o.forEach=(r=o.create(),function(t,e,i,n,o,s){var a,h;for(e||(e=3),i||(i=0),h=n?Math.min(n*e+i,t.length):t.length,a=i;a<h;a+=e)r[0]=t[a],r[1]=t[a+1],r[2]=t[a+2],o(r,r,s),t[a]=r[0],t[a+1]=r[1],t[a+2]=r[2];return t}),o.angle=function(t,e){var i=o.fromValues(t[0],t[1],t[2]),r=o.fromValues(e[0],e[1],e[2]);o.normalize(i,i),o.normalize(r,r);var n=o.dot(i,r);return n>1?0:n<-1?Math.PI:Math.acos(n)},o.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},o.equals=function(t,e){var i=t[0],r=t[1],o=t[2],s=e[0],a=e[1],h=e[2];return Math.abs(i-s)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(r-a)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(o-h)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))},t.exports=o},function(t,e,i){"use strict";t.exports=function(t,e,i){return Math.min(Math.max(t,e),i)}},function(t,e,i){var r,n=i(54),o={};o.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},o.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},o.fromValues=function(t,e,i,r){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=i,o[3]=r,o},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},o.set=function(t,e,i,r,n){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t},o.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t},o.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t},o.sub=o.subtract,o.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t},o.mul=o.multiply,o.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t},o.div=o.divide,o.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},o.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},o.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t},o.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t},o.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},o.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},o.scaleAndAdd=function(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t},o.distance=function(t,e){var i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(i*i+r*r+n*n+o*o)},o.dist=o.distance,o.squaredDistance=function(t,e){var i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2],o=e[3]-t[3];return i*i+r*r+n*n+o*o},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],i=t[1],r=t[2],n=t[3];return Math.sqrt(e*e+i*i+r*r+n*n)},o.len=o.length,o.squaredLength=function(t){var e=t[0],i=t[1],r=t[2],n=t[3];return e*e+i*i+r*r+n*n},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},o.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},o.normalize=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],s=i*i+r*r+n*n+o*o;return s>0&&(s=1/Math.sqrt(s),t[0]=i*s,t[1]=r*s,t[2]=n*s,t[3]=o*s),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},o.lerp=function(t,e,i,r){var n=e[0],o=e[1],s=e[2],a=e[3];return t[0]=n+r*(i[0]-n),t[1]=o+r*(i[1]-o),t[2]=s+r*(i[2]-s),t[3]=a+r*(i[3]-a),t},o.random=function(t,e){return e=e||1,t[0]=n.RANDOM(),t[1]=n.RANDOM(),t[2]=n.RANDOM(),t[3]=n.RANDOM(),o.normalize(t,t),o.scale(t,t,e),t},o.transformMat4=function(t,e,i){var r=e[0],n=e[1],o=e[2],s=e[3];return t[0]=i[0]*r+i[4]*n+i[8]*o+i[12]*s,t[1]=i[1]*r+i[5]*n+i[9]*o+i[13]*s,t[2]=i[2]*r+i[6]*n+i[10]*o+i[14]*s,t[3]=i[3]*r+i[7]*n+i[11]*o+i[15]*s,t},o.transformQuat=function(t,e,i){var r=e[0],n=e[1],o=e[2],s=i[0],a=i[1],h=i[2],l=i[3],u=l*r+a*o-h*n,c=l*n+h*r-s*o,p=l*o+s*n-a*r,f=-s*r-a*n-h*o;return t[0]=u*l+f*-s+c*-h-p*-a,t[1]=c*l+f*-a+p*-s-u*-h,t[2]=p*l+f*-h+u*-a-c*-s,t[3]=e[3],t},o.forEach=(r=o.create(),function(t,e,i,n,o,s){var a,h;for(e||(e=4),i||(i=0),h=n?Math.min(n*e+i,t.length):t.length,a=i;a<h;a+=e)r[0]=t[a],r[1]=t[a+1],r[2]=t[a+2],r[3]=t[a+3],o(r,r,s),t[a]=r[0],t[a+1]=r[1],t[a+2]=r[2],t[a+3]=r[3];return t}),o.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},o.equals=function(t,e){var i=t[0],r=t[1],o=t[2],s=t[3],a=e[0],h=e[1],l=e[2],u=e[3];return Math.abs(i-a)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(r-h)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(o-l)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(s-u)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(u))},t.exports=o},function(t,e,i){"use strict";t.exports=function(t,e){return(+t%(e=+e)+e)%e}},function(t,e,i){"use strict";t.exports=function(t){return t.toPrecision(15)}},,function(t,e,i){"use strict";var r=32;function n(t,e,i){if("function"!=typeof t)throw new Error("Map: bad equals function");if(this._equals=t,"function"!=typeof e)throw new Error("Map: bad hash function");if(this._hash=e,null!=i){if("number"!=typeof i||isNaN(i)||i<1)throw new Error("Map: bad number of buckets");this._nbuckets=i}else this._nbuckets=r;this._keyBuckets=[],this._valBuckets=[];for(var n=0;n<this._nbuckets;n++)this._keyBuckets.push([]),this._valBuckets.push([])}n.prototype._hashmod=function(t){return this._hash(t)%this._nbuckets},n.prototype.get=function(t){for(var e=this._hashmod(t),i=this._keyBuckets[e],r=0;r<i.length;r++){var n=i[r];if(this._equals(t,n))return this._valBuckets[e][r]}return null},n.prototype.set=function(t,e){for(var i=this._hashmod(t),r=this._keyBuckets[i],n=this._valBuckets[i],o=0;o<r.length;o++){var s=r[o];if(this._equals(t,s)){var a=n[o];return r[o]=t,n[o]=e,a}}return r.push(t),n.push(e),null},n.prototype.del=function(t){for(var e=this._hashmod(t),i=this._keyBuckets[e],r=this._valBuckets[e],n=0;n<i.length;n++){var o=i[n];if(this._equals(t,o)){for(var s=r[n],a=n;a<i.length-1;a++)i[a]=i[a+1],r[a]=r[a+1];return i.length=i.length-1,r.length=r.length-1,s}}return null},n.prototype.has=function(t){for(var e=this._hashmod(t),i=this._keyBuckets[e],r=0;r<i.length;r++){var n=i[r];if(this._equals(t,n))return!0}return!1},n.prototype.size=function(){for(var t=0,e=0;e<this._nbuckets;e++){t+=this._keyBuckets[e].length}return t},n.prototype.clear=function(){for(var t=0;t<this._nbuckets;t++){var e=this._keyBuckets[t],i=this._valBuckets[t];e.length=0,i.length=0}},n.prototype.each=function(t){for(var e=0,i=0;i<this._nbuckets;i++)for(var r=this._keyBuckets[i],n=this._valBuckets[i],o=0;o<r.length;o++){t(r[o],n[o]),e+=1}return e},t.exports=n},function(t,e,i){"use strict";var r=i(90);t.exports={makeLevelList:function(t,e){for(var i=[],n=0;n<t.length;n++)i.push(new e(t[n]));return i.sort(function(t,e){return r(t.width(),e.width())}),i},makeSelectableLevelList:function(t){for(var e=[],i=0;i<t.length;i++)t[i]._fallbackOnly||e.push(t[i]);if(!e.length)throw new Error("No selectable levels in list");return e}}},function(t,e,i){"use strict";t.exports=function(t,e){return t<e?-1:t>e?1:0}},function(t,e,i){"use strict";t.exports=function(t){var e=typeof t;if("object"===e){if(null===t)return"null";if("[object Array]"===Object.prototype.toString.call(t))return"array";if("[object RegExp]"===Object.prototype.toString.call(t))return"regexp"}return e}},function(t,e,i){"use strict";t.exports=function(){}},,,,,,,function(t,e,i){"use strict";t.exports=function(t){var e,i=!1;return function(){return i||(i=!0,e=t.apply(null,arguments)),e}}},function(t,e,i){"use strict";var r=1;t.exports=function(){if("undefined"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t&&t.deviceXDPI&&t.logicalXDPI)return t.deviceXDPI/t.logicalXDPI;if(t&&t.systemXDPI&&t.logicalXDPI)return t.systemXDPI/t.logicalXDPI}return r}},function(t,e,i){"use strict";var r=i(183),n=i(88),o=i(81),s=i(80);function a(){this._managers=new n(h,l)}function h(t,e){return t===e}function l(t){for(var e=t.id||t.toString();e.length<5;)e+="0";return o(e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4))}function u(t,e,i,r){this._manager=e,this._element=i,this._type=r,this._hammerGestures=t,this._eventHandlers=[]}a.prototype.get=function(t,e){this._managers.has(t)||this._managers.set(t,{});var i=this._managers.get(t);i[e]||(i[e]=this._createManager(t,e));var r=i[e];return r.refs+=1,new u(this,r.manager,t,e)},a.prototype._createManager=function(t,e){var i=new r.Manager(t);return"mouse"===e?i.add(new r.Pan({direction:r.DIRECTION_ALL,threshold:0})):"touch"!==e&&"pen"!==e&&"kinect"!==e||(i.add(new r.Pan({direction:r.DIRECTION_ALL,threshold:20,pointers:1})),s.msie&&parseFloat(s.version)<10||i.add(new r.Pinch)),{manager:i,refs:0}},a.prototype._releaseHandle=function(t,e){var i=this._managers.get(t)[e];i.refs-=1,i.refs<=0&&(i.manager.destroy(),this._managers.get(t)[e]=null)},u.prototype.on=function(t,e){var i=this._type,r=function(t){i===t.pointerType&&e(t)};this._eventHandlers.push({events:t,handler:r}),this._manager.on(t,r)},u.prototype.release=function(){for(var t=0;t<this._eventHandlers.length;t++){var e=this._eventHandlers[t];this._manager.off(e.events,e.handler)}this._hammerGestures._releaseHandle(this._element,this._type),this._manager=null,this._element=null,this._type=null,this._hammerGestures=null},u.prototype.manager=function(){return this._manager},t.exports=new a},,,,,,,,,,,,function(t,e){t.exports=jQuery},,,,,,,,,,function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e,i){"use strict";var r=i(16),n=i(125),o=i(147),s=i(148),a=i(149),h=i(6),l=i(224),u=20;function c(t,e){return-t.cmp(e)}function p(t){this._layers=[],this._renderers=[],this._visibleTiles=[],this._parentTiles=[],this._childrenTiles=[],this._tmpTiles=[],this._width=0,this._height=0,this._tmpRect={},this._tmpSize={},this._createTextureWorkQueue=new n({delay:u}),this._emitRenderInvalid=this._emitRenderInvalid.bind(this),this._rendererRegistry=new l}r(p),p.prototype.destroy=function(){this.removeAllLayers(),h(this)},p.prototype.registerRenderer=function(t,e,i){return this._rendererRegistry.set(t,e,i)},p.prototype.domElement=function(){throw new Error("Stage implementation must override domElement")},p.prototype.width=function(){return this._width},p.prototype.height=function(){return this._height},p.prototype.size=function(t){return(t=t||{}).width=this._width,t.height=this._height,t},p.prototype.setSize=function(t){this._width=t.width,this._height=t.height,this.setSizeForType(),this.emit("resize"),this._emitRenderInvalid()},p.prototype.setSizeForType=function(t){throw new Error("Stage implementation must override setSizeForType")},p.prototype.loadImage=function(){throw new Error("Stage implementation must override loadImage")},p.prototype._emitRenderInvalid=function(){this.emit("renderInvalid")},p.prototype.validateLayer=function(t){throw new Error("Stage implementation must override validateLayer")},p.prototype.listLayers=function(){return[].concat(this._layers)},p.prototype.hasLayer=function(t){return this._layers.indexOf(t)>=0},p.prototype.addLayer=function(t,e){if(this._layers.indexOf(t)>=0)throw new Error("Layer already in stage");if(null==e&&(e=this._layers.length),e<0||e>this._layers.length)throw new Error("Invalid layer position");this.validateLayer(t),this._layers.splice(e,0,t),this._renderers.splice(e,0,null),t.addEventListener("viewChange",this._emitRenderInvalid),t.addEventListener("effectsChange",this._emitRenderInvalid),t.addEventListener("fixedLevelChange",this._emitRenderInvalid),t.addEventListener("textureStoreChange",this._emitRenderInvalid),this._emitRenderInvalid()},p.prototype.moveLayer=function(t,e){var i=this._layers.indexOf(t);if(i<0)throw new Error("No such layer in stage");if(e<0||e>=this._layers.length)throw new Error("Invalid layer position");t=this._layers.splice(i,1)[0];var r=this._renderers.splice(i,1)[0];this._layers.splice(e,0,t),this._renderers.splice(e,0,r),this._emitRenderInvalid()},p.prototype.removeLayer=function(t){var e=this._layers.indexOf(t);if(e<0)throw new Error("No such layer in stage");var i=this._layers.splice(e,1)[0],r=this._renderers.splice(e,1)[0];r&&this.destroyRenderer(r),i.removeEventListener("viewChange",this._emitRenderInvalid),i.removeEventListener("effectsChange",this._emitRenderInvalid),i.removeEventListener("fixedLevelChange",this._emitRenderInvalid),i.removeEventListener("textureStoreChange",this._emitRenderInvalid),this._emitRenderInvalid()},p.prototype.removeAllLayers=function(){for(;this._layers.length>0;)this.removeLayer(this._layers[0])},p.prototype.startFrame=function(){throw new Error("Stage implementation must override startFrame")},p.prototype.endFrame=function(){throw new Error("Stage implementation must override endFrame")},p.prototype.render=function(){var t,e=this._visibleTiles,i=this._parentTiles,r=this._childrenTiles,n=!0,s=this._width,a=this._height,h=this._tmpRect,l=this._tmpSize;if(!(s<=0||a<=0)){for(this.startFrame(),t=0;t<this._layers.length;t++)this._layers[t].textureStore().startFrame();for(t=0;t<this._layers.length;t++){var u=this._layers[t],p=u.effects(),f=u.view(),d=this._updateRenderer(t),m=this._layers.length-t,v=u.textureStore();o(s,a,p&&p.rect,h),h.width<=0||h.height<=0||(l.width=h.width*this._width,l.height=h.height*this._height,f.setSize(l),e.length=0,r.length=0,i.length=0,u.visibleTiles(e),d.startLayer(u,h),this._renderTiles(e,v,d,u,m,r,i)||(n=!1),this._renderTiles(r,v,d,u,m,null,null),i.sort(c),this._renderTiles(i,v,d,u,m,null,null),d.endLayer(u,h))}for(t=0;t<this._layers.length;t++)this._layers[t].textureStore().endFrame();this.endFrame(),this.emit("renderComplete",n)}},p.prototype._updateRenderer=function(t){var e=this._layers[t],i=this.type,r=e.geometry().type,n=e.view().type,o=this._rendererRegistry.get(r,n);if(!o)throw new Error("No "+i+" renderer avaiable for "+r+" geometry and "+n+" view");var s=this._renderers[t];return s?s instanceof o||(this._renderers[t]=this.createRenderer(o),this.destroyRenderer(s)):this._renderers[t]=this.createRenderer(o),this._renderers[t]},p.prototype._renderTiles=function(t,e,i,r,n,o,s){if(null==o!=(null==s))throw new Error("Inconsistent fallback arguments");for(var a=!0,h=0;h<t.length;h++){var l=t[h];e.markTile(l);var u=e.texture(l);u?i.renderTile(l,u,r,n,h):(a=!1,null==o&&null==s||this._collectFallbacks(l,e,o,s))}return a},p.prototype._collectFallbacks=function(t,e,i,r){return this._collectChildrenFallbacks(t,e,i)||this._collectParentFallbacks(t,e,r)},p.prototype._collectParentFallbacks=function(t,e,i){for(;null!=(t=t.parent());)if(t&&e.texture(t)){for(var r=0;r<i.length;r++)if(t.equals(i[r]))return!0;return i.push(t),!0}return!1},p.prototype._collectChildrenFallbacks=function(t,e,i){var r=this._tmpTiles;if(r.length=0,!t.children(r))return!1;if(1===r.length&&!e.texture(r[0]))return this._collectChildrenFallbacks(r[0],e,i);for(var n=!1,o=0;o<r.length;o++)e.texture(r[o])?i.push(r[o]):n=!0;return!n},p.prototype.createTexture=function(t,e,i){var r=this;var n=a(s(function(){return new r.TextureClass(r,t,e)}));return this._createTextureWorkQueue.push(n,function(r,n){i(r,t,e,n)})},t.exports=p},function(t,e,i){"use strict";var r=i(69);function n(t,e){this.fn=t,this.cb=e,this.cfn=null}function o(t){this._queue=[],this._delay=t&&t.delay||0,this._paused=t&&!!t.paused||!1,this._currentTask=null,this._lastFinished=null}o.prototype.length=function(){return this._queue.length},o.prototype.push=function(t,e){var i=new n(t,e),r=this._cancel.bind(this,i);return this._queue.push(i),this._next(),r},o.prototype.pause=function(){this._paused||(this._paused=!0)},o.prototype.resume=function(){this._paused&&(this._paused=!1,this._next())},o.prototype._start=function(t){if(this._currentTask)throw new Error("WorkQueue: called start while running task");this._currentTask=t;var e=this._finish.bind(this,t);if(t.cfn=t.fn(e),"function"!=typeof t.cfn)throw new Error("WorkQueue: function is not cancellable")},o.prototype._finish=function(t){var e=Array.prototype.slice.call(arguments,1);if(this._currentTask!==t)throw new Error("WorkQueue: called finish on wrong task");t.cb.apply(null,e),this._currentTask=null,this._lastFinished=r(),this._next()},o.prototype._cancel=function(t){var e=Array.prototype.slice.call(arguments,1);if(this._currentTask===t)t.cfn.apply(null,e);else{var i=this._queue.indexOf(t);i>=0&&(this._queue.splice(i,1),t.cb.apply(null,e))}},o.prototype._next=function(){if(!this._paused&&this._queue.length&&!this._currentTask){if(null!=this._lastFinished){var t=r()-this._lastFinished,e=this._delay-t;if(e>0)return void setTimeout(this._next.bind(this),e)}var i=this._queue.shift();this._start(i)}},t.exports=o},function(t,e,i){"use strict";function r(t){this.constructor.super_.apply(this,arguments),this.message=t}i(29)(r,Error),t.exports=r},function(t,e,i){"use strict";var r,n=i(9).prefixProperty;t.exports=function(){return void 0!==r?r:r=function(){var t=n("perspective"),e=document.createElement("div"),i=void 0!==e.style[t];if(i&&"WebkitPerspective"===t){var r="__marzipano_test_css3d_support__",o=document.createElement("style");o.textContent="@media(-webkit-transform-3d){#"+r+"{height: 3px;})",document.getElementsByTagName("head")[0].appendChild(o),e.id=r,document.body.appendChild(e),i=e.offsetHeight>0,o.parentNode.removeChild(o),e.parentNode.removeChild(e)}return i}()}},function(t,e,i){"use strict";for(var r=i(29),n=i(81),o=i(161),s=i(163),a=i(129),h=i(89).makeLevelList,l=i(89).makeSelectableLevelList,u=i(164),c=i(83),p=i(90),f=i(91),d=i(82),m={f:{x:0,y:0},b:{x:0,y:Math.PI},l:{x:0,y:Math.PI/2},r:{x:0,y:-Math.PI/2},u:{x:Math.PI/2,y:0},d:{x:-Math.PI/2,y:0}},v={},_=0;_<"fudlrb".length;_++){var y="fudlrb"[_],g=m[y],w=d.fromValues(0,0,-1);u(w,w,g.y,g.x,0),v[y]=w}var x={f:["l","r","u","d"],b:["r","l","u","d"],l:["b","f","u","d"],r:["f","b","u","d"],u:["l","r","b","f"],d:["l","r","f","b"]},M=[[0,1],[1,0],[0,-1],[-1,0]];function b(t,e,i,r,n){this.face=t,this.x=e,this.y=i,this.z=r,this._geometry=n,this._level=n.levelList[r]}function S(t){if(this.constructor.super_.call(this,t),this._size=t.size,this._tileSize=t.tileSize,this._size%this._tileSize!=0)throw new Error("Level size is not multiple of tile size: "+this._size+" "+this._tileSize)}function E(t){if("array"!==f(t))throw new Error("Level list must be an array");this.levelList=h(t,S),this.selectableLevelList=l(this.levelList);for(var e=1;e<this.levelList.length;e++)this.levelList[e]._validateWithParentLevel(this.levelList[e-1]);this._graphFinder=new o(b.equals,b.hash),this._neighborsCache=new s(b.equals,b.hash,64),this._vec=d.create(),this._viewSize={},this._viewParams={},this._tileVertices=[d.create(),d.create(),d.create(),d.create()]}b.prototype.rotX=function(){return m[this.face].x},b.prototype.rotY=function(){return m[this.face].y},b.prototype.centerX=function(){return(this.x+.5)/this._level.numHorizontalTiles()-.5},b.prototype.centerY=function(){return.5-(this.y+.5)/this._level.numVerticalTiles()},b.prototype.scaleX=function(){return 1/this._level.numHorizontalTiles()},b.prototype.scaleY=function(){return 1/this._level.numVerticalTiles()},b.prototype.width=function(){return this._level.tileWidth()},b.prototype.height=function(){return this._level.tileHeight()},b.prototype.levelWidth=function(){return this._level.width()},b.prototype.levelHeight=function(){return this._level.height()},b.prototype.atTopLevel=function(){return 0===this.z},b.prototype.atBottomLevel=function(){return this.z===this._geometry.levelList.length-1},b.prototype.atTopEdge=function(){return 0===this.y},b.prototype.atBottomEdge=function(){return this.y===this._level.numVerticalTiles()-1},b.prototype.atLeftEdge=function(){return 0===this.x},b.prototype.atRightEdge=function(){return this.x===this._level.numHorizontalTiles()-1},b.prototype.padTop=function(){return this.atTopEdge()&&/[fu]/.test(this.face)},b.prototype.padBottom=function(){return!this.atBottomEdge()||/[fd]/.test(this.face)},b.prototype.padLeft=function(){return this.atLeftEdge()&&/[flud]/.test(this.face)},b.prototype.padRight=function(){return!this.atRightEdge()||/[frud]/.test(this.face)},b.prototype.vertices=function(t){var e=m[this.face];function i(t,i,r){d.set(t,i,r,-.5),u(t,t,e.y,e.x,0)}var r=this.centerX()-this.scaleX()/2,n=this.centerX()+this.scaleX()/2,o=this.centerY()-this.scaleY()/2,s=this.centerY()+this.scaleY()/2;return i(t[0],r,s),i(t[1],n,s),i(t[2],n,o),i(t[3],r,o),t},b.prototype.parent=function(){if(this.atTopLevel())return null;var t=this.face,e=this.z,i=this.x,r=this.y,n=this._geometry,o=n.levelList[e],s=n.levelList[e-1];return new b(t,Math.floor(i/o.numHorizontalTiles()*s.numHorizontalTiles()),Math.floor(r/o.numVerticalTiles()*s.numVerticalTiles()),e-1,n)},b.prototype.children=function(t){if(this.atBottomLevel())return null;var e=this.face,i=this.z,r=this.x,n=this.y,o=this._geometry,s=o.levelList[i],a=o.levelList[i+1],h=a.numHorizontalTiles()/s.numHorizontalTiles(),l=a.numVerticalTiles()/s.numVerticalTiles();t=t||[];for(var u=0;u<h;u++)for(var c=0;c<l;c++){var p=h*r+u,f=l*n+c,d=i+1;t.push(new b(e,p,f,d,o))}return t},b.prototype.neighbors=function(){var t=this._geometry,e=t._neighborsCache,i=e.get(this);if(i)return i;for(var r=t._vec,n=this.face,o=this.x,s=this.y,a=this.z,h=this._level,l=h.numHorizontalTiles(),p=h.numVerticalTiles(),f=[],v=0;v<M.length;v++){var _=o+M[v][0],y=s+M[v][1],g=a,w=n;if(_<0||_>=l||y<0||y>=p){var S,E=this.centerX(),I=this.centerY();_<0?(d.set(r,-.5,I,-.5),w=x[n][0]):_>=l?(d.set(r,.5,I,-.5),w=x[n][1]):y<0?(d.set(r,E,.5,-.5),w=x[n][2]):y>=p&&(d.set(r,E,-.5,-.5),w=x[n][3]),u(r,r,(S=m[n]).y,S.x,0),u(r,r,-(S=m[w]).y,-S.x,0),_=c(Math.floor((.5+r[0])*l),0,l-1),y=c(Math.floor((.5-r[1])*p),0,p-1)}f.push(new b(w,_,y,g,t))}return e.set(this,f),f},b.prototype.hash=function(){return b.hash(this)},b.prototype.equals=function(t){return b.equals(this,t)},b.prototype.cmp=function(t){return b.cmp(this,t)},b.prototype.str=function(){return b.str(this)},b.hash=function(t){return null!=t?n(t.face.charCodeAt(0),t.z,t.x,t.y):0},b.equals=function(t,e){return null!=t&&null!=e&&t.face===e.face&&t.z===e.z&&t.x===e.x&&t.y===e.y},b.cmp=function(t,e){var i="fudlrb".indexOf(t.face),r="fudlrb".indexOf(e.face);return p(t.z,e.z)||p(i,r)||p(t.y,e.y)||p(t.x,e.x)},b.str=function(t){return"CubeTile("+t.face+", "+t.x+", "+t.y+", "+t.z+")"},r(S,a),S.prototype.width=function(){return this._size},S.prototype.height=function(){return this._size},S.prototype.tileWidth=function(){return this._tileSize},S.prototype.tileHeight=function(){return this._tileSize},S.prototype._validateWithParentLevel=function(t){var e=this.width(),i=this.height(),r=this.tileWidth(),n=this.tileHeight(),o=this.numHorizontalTiles(),s=this.numVerticalTiles(),a=t.width(),h=t.height(),l=t.tileWidth(),u=t.tileHeight(),c=t.numHorizontalTiles(),p=t.numVerticalTiles();if(e%a!=0)throw new Error("Level width must be multiple of parent level: "+e+" vs. "+a);if(i%h!=0)throw new Error("Level height must be multiple of parent level: "+i+" vs. "+h);if(o%c!=0)throw new Error("Number of horizontal tiles must be multiple of parent level: "+o+" ("+e+"/"+r+") vs. "+c+" ("+a+"/"+l+")");if(s%p!=0)throw new Error("Number of vertical tiles must be multiple of parent level: "+s+" ("+i+"/"+n+") vs. "+p+" ("+h+"/"+u+")")},E.prototype.maxTileSize=function(){for(var t=0,e=0;e<this.levelList.length;e++){var i=this.levelList[e];t=Math.max(t,i.tileWidth,i.tileHeight)}return t},E.prototype.levelTiles=function(t,e){var i=this.levelList.indexOf(t),r=t.numHorizontalTiles()-1,n=t.numVerticalTiles()-1;e=e||[];for(var o=0;o<"fudlrb".length;o++)for(var s="fudlrb"[o],a=0;a<=r;a++)for(var h=0;h<=n;h++)e.push(new b(s,a,h,i,this));return e},E.prototype._closestTile=function(t,e){var i=this._vec,r=1/0,n=null;for(var o in d.set(i,0,0,-1),u(i,i,-t.yaw,-t.pitch,-t.roll),v){var s=v[o],a=1-d.dot(s,i);a<r&&(r=a,n=o)}for(var h=Math.max(Math.abs(i[0]),Math.abs(i[1]),Math.abs(i[2]))/.5,l=0;l<3;l++)i[l]=i[l]/h;var p=m[n];u(i,i,-p.y,-p.x,-p.z);var f=this.levelList.indexOf(e),_=e.numHorizontalTiles(),y=e.numVerticalTiles(),g=i[0],w=i[1];return new b(n,c(Math.floor((.5+g)*_),0,_-1),c(Math.floor((.5-w)*y),0,y-1),f,this)},E.prototype.visibleTiles=function(t,e,i){var r=this._viewSize,n=this._viewParams,o=this._tileVertices,s=this._graphFinder;function a(e){return e.vertices(o),t.intersects(o)}if(i=i||[],t.size(r),0===r.width||0===r.height)return i;var h,l=this._closestTile(t.parameters(n),e);if(!a(l))throw new Error("Starting tile is not visible");for(s.start(l,function(t){return t.neighbors()},a);null!=(h=s.next());)i.push(h);return i},E.TileClass=E.prototype.TileClass=b,E.type=E.prototype.type="cube",b.type=b.prototype.type="cube",t.exports=E},function(t,e,i){"use strict";function r(t){this._fallbackOnly=!!t.fallbackOnly}r.prototype.numHorizontalTiles=function(){return Math.ceil(this.width()/this.tileWidth())},r.prototype.numVerticalTiles=function(){return Math.ceil(this.height()/this.tileHeight())},r.prototype.fallbackOnly=function(){return this._fallbackOnly},t.exports=r},function(t,e,i){"use strict";var r=i(29),n=i(81),o=i(161),s=i(163),a=i(129),h=i(89).makeLevelList,l=i(89).makeSelectableLevelList,u=i(83),c=i(85),p=i(90),f=i(91),d=i(167),m=[[0,1],[1,0],[0,-1],[-1,0]];function v(t,e,i,r){this.x=t,this.y=e,this.z=i,this._geometry=r,this._level=r.levelList[i]}function _(t){this.constructor.super_.call(this,t),this._width=t.width,this._height=t.height,this._tileWidth=t.tileWidth,this._tileHeight=t.tileHeight}function y(t){if("array"!==f(t))throw new Error("Level list must be an array");this.levelList=h(t,_),this.selectableLevelList=l(this.levelList);for(var e=1;e<this.levelList.length;e++)this.levelList[e]._validateWithParentLevel(this.levelList[e-1]);this._graphFinder=new o(v.equals,v.hash),this._neighborsCache=new s(v.equals,v.hash,64),this._viewSize={},this._viewParams={},this._tileVertices=[d.create(),d.create(),d.create(),d.create()]}v.prototype.rotX=function(){return 0},v.prototype.rotY=function(){return 0},v.prototype.centerX=function(){var t=this._level.width(),e=this._level.tileWidth();return(this.x*e+.5*this.width())/t-.5},v.prototype.centerY=function(){var t=this._level.height(),e=this._level.tileHeight();return.5-(this.y*e+.5*this.height())/t},v.prototype.scaleX=function(){var t=this._level.width();return this.width()/t},v.prototype.scaleY=function(){var t=this._level.height();return this.height()/t},v.prototype.width=function(){var t=this._level.width(),e=this._level.tileWidth();return this.atRightEdge()&&c(t,e)||e},v.prototype.height=function(){var t=this._level.height(),e=this._level.tileHeight();return this.atBottomEdge()&&c(t,e)||e},v.prototype.levelWidth=function(){return this._level.width()},v.prototype.levelHeight=function(){return this._level.height()},v.prototype.atTopLevel=function(){return 0===this.z},v.prototype.atBottomLevel=function(){return this.z===this._geometry.levelList.length-1},v.prototype.atTopEdge=function(){return 0===this.y},v.prototype.atBottomEdge=function(){return this.y===this._level.numVerticalTiles()-1},v.prototype.atLeftEdge=function(){return 0===this.x},v.prototype.atRightEdge=function(){return this.x===this._level.numHorizontalTiles()-1},v.prototype.padTop=function(){return!1},v.prototype.padBottom=function(){return!this.atBottomEdge()},v.prototype.padLeft=function(){return!1},v.prototype.padRight=function(){return!this.atRightEdge()},v.prototype.vertices=function(t){var e=this.centerX()-this.scaleX()/2,i=this.centerX()+this.scaleX()/2,r=this.centerY()-this.scaleY()/2,n=this.centerY()+this.scaleY()/2;return d.set(t[0],e,n),d.set(t[1],i,n),d.set(t[2],i,r),d.set(t[3],e,r),t},v.prototype.parent=function(){if(this.atTopLevel())return null;var t=this._geometry,e=this.z-1;return new v(Math.floor(this.x/2),Math.floor(this.y/2),e,t)},v.prototype.children=function(t){if(this.atBottomLevel())return null;var e=this._geometry,i=this.z+1;return(t=t||[]).push(new v(2*this.x,2*this.y,i,e)),t.push(new v(2*this.x,2*this.y+1,i,e)),t.push(new v(2*this.x+1,2*this.y,i,e)),t.push(new v(2*this.x+1,2*this.y+1,i,e)),t},v.prototype.neighbors=function(){var t=this._geometry,e=t._neighborsCache,i=e.get(this);if(i)return i;for(var r=this.x,n=this.y,o=this.z,s=this._level,a=s.numHorizontalTiles()-1,h=s.numVerticalTiles()-1,l=[],u=0;u<m.length;u++){var c=r+m[u][0],p=n+m[u][1],f=o;0<=c&&c<=a&&0<=p&&p<=h&&l.push(new v(c,p,f,t))}return e.set(this,l),l},v.prototype.hash=function(){return v.hash(this)},v.prototype.equals=function(t){return v.equals(this,t)},v.prototype.cmp=function(t){return v.cmp(this,t)},v.prototype.str=function(){return v.str(this)},v.hash=function(t){return null!=t?n(t.z,t.x,t.y):0},v.equals=function(t,e){return null!=t&&null!=e&&t.z===e.z&&t.x===e.x&&t.y===e.y},v.cmp=function(t,e){return p(t.z,e.z)||p(t.y,e.y)||p(t.x,e.x)},v.str=function(t){return"FlatTile("+t.x+", "+t.y+", "+t.z+")"},r(_,a),_.prototype.width=function(){return this._width},_.prototype.height=function(){return this._height},_.prototype.tileWidth=function(){return this._tileWidth},_.prototype.tileHeight=function(){return this._tileHeight},_.prototype._validateWithParentLevel=function(t){var e=this.width(),i=this.height(),r=this.tileWidth(),n=this.tileHeight(),o=t.width(),s=t.height(),a=t.tileWidth(),h=t.tileHeight();return e%o!=0?new Error("Level width must be multiple of parent level: "+e+" vs. "+o):i%s!=0?new Error("Level height must be multiple of parent level: "+i+" vs. "+s):r%a!=0?new Error("Level tile width must be multiple of parent level: "+r+" vs. "+a):n%h!=0?new Error("Level tile height must be multiple of parent level: "+n+" vs. "+h):void 0},y.prototype.maxTileSize=function(){for(var t=0,e=0;e<this.levelList.length;e++){var i=this.levelList[e];t=Math.max(t,i.tileWidth,i.tileHeight)}return t},y.prototype.levelTiles=function(t,e){var i=this.levelList.indexOf(t),r=t.numHorizontalTiles()-1,n=t.numVerticalTiles()-1;e||(e=[]);for(var o=0;o<=r;o++)for(var s=0;s<=n;s++)e.push(new v(o,s,i,this));return e},y.prototype._closestTile=function(t,e){var i=t.x,r=t.y,n=this.levelList.indexOf(e),o=e.width(),s=e.height(),a=e.tileWidth(),h=e.tileHeight(),l=e.numHorizontalTiles(),c=e.numVerticalTiles();return new v(u(Math.floor(i*o/a),0,l-1),u(Math.floor(r*s/h),0,c-1),n,this)},y.prototype.visibleTiles=function(t,e,i){var r=this._viewSize,n=this._viewParams,o=this._tileVertices,s=this._graphFinder;function a(e){return e.vertices(o),t.intersects(o)}if(i=i||[],t.size(r),0===r.width||0===r.height)return i;var h,l=this._closestTile(t.parameters(n),e);if(!a(l))throw new Error("Starting tile is not visible");for(s.start(l,function(t){return t.neighbors()},a);null!=(h=s.next());)i.push(h);return i},y.TileClass=y.prototype.TileClass=v,y.type=y.prototype.type="flat",v.type=v.prototype.type="flat",t.exports=y},function(t,e,i){"use strict";t.exports=function(t){return"number"==typeof t&&isFinite(t)}},function(t,e,i){"use strict";var r=i(92);t.exports=function(){var t=Array.prototype.slice.call(arguments,0);return function(){var e=t.slice(0),i=null,n=null,o=arguments.length?Array.prototype.slice.call(arguments,0,arguments.length-1):[],s=arguments.length?arguments[arguments.length-1]:r;return o.unshift(null),function t(){if(arguments[0])return i=n=null,void s.apply(null,arguments);if(!e.length)return i=n=null,void s.apply(null,arguments);var r=i=e.shift(),o=Array.prototype.slice.call(arguments,1);o.push(t);var a=i.apply(null,o);if(r===i){if("function"!=typeof a)throw new Error("chain: chaining on non-cancellable function");n=a}}.apply(null,o),function(){n&&n.apply(null,arguments)}}}},,,,,,,,,,,,,,function(t,e,i){"use strict";var r=i(124),n=i(150),o=i(226),s=i(80),a=i(88),h=i(29),l=i(100),u=i(81),c=i(228),p=i(9).setAbsolute,f=i(9).setFullSize,d=i(6),m="undefined"!=typeof MARZIPANODEBUG&&MARZIPANODEBUG.webGl,v=s.chrome;function _(t){t=t||{};var e=this;this.constructor.super_.call(this,t),this._generateMipmaps=null!=t.generateMipmaps&&t.generateMipmaps,this._loader=new n(this),this._domElement=document.createElement("canvas"),p(this._domElement),f(this._domElement),this._gl=function(t,e){var i={alpha:!0,premultipliedAlpha:!0,antialias:!(!e||!e.antialias),preserveDrawingBuffer:!(!e||!e.preserveDrawingBuffer)};m&&"undefined"!=typeof WebGLDebugUtils&&(console.log("Using WebGL lost context simulator"),t=WebGLDebugUtils.makeLostContextSimulatingCanvas(t));var r=t.getContext&&(t.getContext("webgl",i)||t.getContext("experimental-webgl",i));if(!r)throw new Error("Could not get WebGL context");return m&&"undefined"!=typeof WebGLDebugUtils&&(r=WebGLDebugUtils.makeDebugContext(r),console.log("Using WebGL debug context")),r}(this._domElement,t),this._handleContextLoss=function(){e.emit("webglcontextlost"),e._gl=null},this._domElement.addEventListener("webglcontextlost",this._handleContextLoss),this._rendererInstances=new a(function(t,e){return t===e},function(t){return u(t.toString())})}function y(t,e,i){this._stage=t,this._gl=t._gl,this._texture=null,this._timestamp=null,this._width=this._height=null,this.refresh(e,i)}h(_,r),_.prototype.destroy=function(){this._domElement.removeEventListener("webglcontextlost",this._handleContextLoss),this.constructor.super_.prototype.destroy.call(this)},_.supported=function(){return o()},_.prototype.domElement=function(){return this._domElement},_.prototype.webGlContext=function(){return this._gl},_.prototype.setSizeForType=function(){var t=l();this._domElement.width=t*this._width,this._domElement.height=t*this._height},_.prototype.loadImage=function(t,e,i){return this._loader.loadImage(t,e,i)},_.prototype.maxTextureSize=function(){return this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE)},_.prototype.validateLayer=function(t){var e=t.geometry().maxTileSize(),i=this.maxTextureSize();if(e>i)throw new Error("Layer has level with tile size larger than maximum texture size ("+e+" vs. "+i+")")},_.prototype.createRenderer=function(t){if(this._rendererInstances.has(t))return this._rendererInstances.get(t);var e=new t(this._gl);return this._rendererInstances.set(t,e),e},_.prototype.destroyRenderer=function(t){this._renderers.indexOf(t)<0&&(t.destroy(),this._rendererInstances.del(t.constructor))},_.prototype.startFrame=function(){var t=this._gl;if(!t)throw new Error("Bad WebGL context - maybe context was lost?");t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.enable(t.DEPTH_TEST),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)},_.prototype.endFrame=function(){},_.prototype.takeSnapshot=function(t){"object"==typeof t&&null!=t||(t={});var e=t.quality;if(void 0===e&&(e=75),"number"!=typeof e||e<0||e>100)throw new Error("WebGLStage: Snapshot quality needs to be a number between 0 and 100");return this.render(),this._domElement.toDataURL("image/jpeg",e/100)},_.type=_.prototype.type="webgl",y.prototype.refresh=function(t,e){var i,r=this._gl,n=this._stage,o=e.timestamp();if(o!==this._timestamp){var s=e.element(),a=e.width(),h=e.height();if(a!==this._width||h!==this._height){var l=n.maxTextureSize();if(a>l)throw new Error("Texture width larger than max size ("+a+" vs. "+l+")");if(h>l)throw new Error("Texture height larger than max size ("+h+" vs. "+l+")");this._texture&&r.deleteTexture(i),i=this._texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,i),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,s)}else i=this._texture,r.bindTexture(r.TEXTURE_2D,i),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),s instanceof HTMLVideoElement&&v?r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,s):r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,s);n._generateMipmaps&&c(a)&&c(h)?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_LINEAR),r.generateMipmap(r.TEXTURE_2D)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR)),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.bindTexture(r.TEXTURE_2D,null),this._timestamp=o,this._width=a,this._height=h}},y.prototype.destroy=function(){this._texture&&this._gl.deleteTexture(this._texture),d(this)},_.TextureClass=_.prototype.TextureClass=y,t.exports=_},function(t,e,i){"use strict";t.exports=function(t,e,i,r){var n,o,s,a;return r=r||{},n=null!=i&&null!=i.absoluteWidth?i.absoluteWidth/t:null!=i&&null!=i.relativeWidth?i.relativeWidth:1,o=i&&null!=i.absoluteHeight?i.absoluteHeight/e:null!=i&&null!=i.relativeHeight?i.relativeHeight:1,s=null!=i&&null!=i.absoluteX?i.absoluteX/t:null!=i&&null!=i.relativeX?i.relativeX:0,a=null!=i&&null!=i.absoluteY?i.absoluteY/e:null!=i&&null!=i.relativeY?i.relativeY:0,r.x=s,r.y=a,r.width=n,r.height=o,r}},function(t,e,i){"use strict";t.exports=function(t){return function(e){var i,r;try{r=t()}catch(t){i=t}finally{e(i||null,i?null:r)}}}},function(t,e,i){"use strict";var r=i(99);t.exports=function(t){return function(){if(!arguments.length)throw new Error("cancelized: expected at least one argument");var e=Array.prototype.slice.call(arguments,0),i=e[e.length-1]=r(e[e.length-1]);return t.apply(null,e),function(){i.apply(null,arguments)}}}},function(t,e,i){"use strict";var r=i(225),n=i(151),o=i(126),s=i(99);function a(t){if("webgl"!==t.type&&"css"!==t.type)throw new Error("Stage type incompatible with loader");this._stage=t}a.prototype.loadImage=function(t,e,i){var a=new Image;a.crossOrigin="anonymous";var h=e&&e.x||0,l=e&&e.y||0,u=e&&e.width||1,c=e&&e.height||1;return i=s(i),a.onload=function(){if(0===h&&0===l&&1===u&&1===c)i(null,new r(a));else{h*=a.naturalWidth,l*=a.naturalHeight,u*=a.naturalWidth,c*=a.naturalHeight;var t=document.createElement("canvas");t.width=u,t.height=c,t.getContext("2d").drawImage(a,h,l,u,c,0,0,u,c),i(null,new n(t))}},a.onerror=function(){i(new o("Network error: "+t))},a.src=t,function(){a.onload=a.onerror=null,a.src="",i.apply(null,arguments)}},t.exports=a},function(t,e,i){"use strict";var r=i(6);function n(t){this._element=t}n.prototype.dynamic=!1,n.prototype.destroy=function(){r(this)},n.prototype.element=function(){return this._element},n.prototype.width=function(){return this._element.width},n.prototype.height=function(){return this._element.height},n.prototype.timestamp=function(){return 0},t.exports=n},function(t,e,i){"use strict";var r=i(124),n=i(150),o=i(127),s=i(80),a=i(29),h=i(9).setAbsolute,l=i(9).setFullSize,u=i(9).setNullTransformOrigin,c=i(6),p={padSize:s.ios?0:3,reverseLevelDepth:s.ios,useNullTransform:s.ios,perspectiveNudge:s.webkit||s.gecko?.001:0};function f(t){this.constructor.super_.call(this,t),this._loader=new n(this),this._domElement=document.createElement("div"),h(this._domElement),l(this._domElement)}function d(t,e,i){var r=document.createElement("canvas");h(r),u(r),this._canvas=r,this._timestamp=null,this.refresh(e,i)}a(f,r),f.prototype.destroy=function(){this.constructor.super_.prototype.destroy.call(this)},f.supported=function(){return o()},f.prototype.domElement=function(){return this._domElement},f.prototype.setSizeForType=function(){},f.prototype.loadImage=function(t,e,i){return this._loader.loadImage(t,e,i)},f.prototype.validateLayer=function(t){},f.prototype.createRenderer=function(t){return new t(this._domElement,p)},f.prototype.destroyRenderer=function(t){t.destroy()},f.prototype.startFrame=function(){},f.prototype.endFrame=function(){},f.prototype.takeSnapshot=function(){throw new Error("CssStage: takeSnapshot not implemented")},f.type=f.prototype.type="css",d.prototype.refresh=function(t,e){var i=e.timestamp();if(i!==this._timestamp){this._timestamp=i;var r,n=this._canvas,o=n.getContext("2d"),s=e.element(),a=t.width(),h=t.height(),l=p.padSize,u=t.padTop()?l:0,c=t.padBottom()?l:0,f=t.padLeft()?l:0,d=t.padRight()?l:0;for(n.width=f+a+d,n.height=u+h+c,o.drawImage(s,f,u,a,h),r=0;r<u;r++)o.drawImage(n,f,u,a,1,f,r,a,1);for(r=0;r<f;r++)o.drawImage(n,f,u,1,h,r,u,1,h);for(r=0;r<c;r++)o.drawImage(n,f,u+h-1,a,1,f,u+h+r,a,1);for(r=0;r<d;r++)o.drawImage(n,f+a-1,u,1,h,f+a+r,u,1,h)}},d.prototype.destroy=function(){c(this)},f.TextureClass=f.prototype.TextureClass=d,t.exports=f},function(t,e,i){"use strict";var r=i(124),n=i(229),o=i(231),s=i(125),a=i(29),h=i(154),l=i(9).setAbsolute,u=i(9).setFullSize,c=i(9).setBlocking,p=i(6),f="transparent",d=function(){var t=document.currentScript;if(!t){var e=document.getElementsByTagName("script");t=e.length?e[e.length-1]:null}if(!t)return null;var i=t.src,r=i.lastIndexOf("/");return(i=r>=0?i.slice(0,r+1):"")+"marzipano.swf"}(),m="MarzipanoFlashCallbackMap";m in window||(window[m]={__next:0});var v=["imageLoaded"],_={padSize:3};function y(t){if(this.constructor.super_.call(this,t),this._wmode=t&&t.wmode||f,this._swfPath=t&&t.swfPath||d,!d)throw new Error("Missing SWF path");this._flashStageId=window[m].__next++,this._callbacksObj=window[m][this._flashStageId]={},this._stageCallbacksObjVarName=m+"["+this._flashStageId+"]",this._callbackListeners={};for(var e=0;e<v.length;e++)this._callbacksObj[v[e]]=this._callListeners(v[e]);this._loader=new n(this),this._loadImageQueue=new s,this._loadImageQueue.pause(),this._flashReady=!1,this._nextLayerId=0;var i=function(t,e,i){var r=document.createElement("div");l(r),u(r);var n="marzipano-flash-stage-"+e,o='<object id="'+n+'" name="'+n+'" type="application/x-shockwave-flash" data="'+t+'">',s="";s+='<param name="movie" value="'+t+'" />',s+='<param name="allowscriptaccess" value="always" />',s+='<param name="flashvars" value="callbacksObjName='+i+'" />',o+=s+='<param name="wmode" value="transparent" />',o+="</object>";var a=document.createElement("div");a.innerHTML=o;var h=a.firstChild;l(h),u(h),r.appendChild(h);var p=document.createElement("div");return l(p),u(p),c(p),r.appendChild(p),{root:r,flash:h,blocking:p}}(this._swfPath,this._flashStageId,this._stageCallbacksObjVarName);this._domElement=i.root,this._blockingElement=i.blocking,this._flashElement=i.flash,this._checkReadyTimer=setInterval(this._checkReady.bind(this),50)}function g(t,e,i){var r=i.element(),n=e.width(),o=e.height(),s=_.padSize,a=e.padTop()?s:0,h=e.padBottom()?s:0,l=e.padLeft()?s:0,u=e.padRight()?s:0,c=t._flashElement.createTexture(r,n,o,a,h,l,u);this._stage=t,this._textureId=c}a(y,r),y.prototype.destroy=function(){window[m][this._flashStageId]=null,null!=this._checkReadyTimer&&clearInterval(this._checkReadyTimer),this.constructor.super_.prototype.destroy.call(this)},y.supported=function(){return o()},y.prototype.domElement=function(){return this._domElement},y.prototype.flashElement=function(){return this._flashElement},y.prototype.setSizeForType=function(){},y.prototype.loadImage=function(t,e,i){var r=this._loader.loadImage.bind(this._loader,t,e);return this._loadImageQueue.push(r,i)},y.prototype.validateLayer=function(t){},y.prototype.addFlashCallbackListener=function(t,e){this._callbackListeners[t]=this._callbackListeners[t]||[],this._callbackListeners[t].push(e)},y.prototype.removeFlashCallbackListener=function(t,e){var i=this._callbackListeners[t]||[],r=i.indexOf(e);r>=0&&i.splice(r,1)},y.prototype._callListeners=function(t){var e=this;return function(){for(var i=e._callbackListeners[t]||[],r=0;r<i.length;r++){var n=i[r];h(n,arguments)}}},y.prototype._checkReady=function(){return!!(this._flashElement&&this._flashElement.isReady&&this._flashElement.isReady())&&(this._flashReady=!0,clearTimeout(this._checkReadyTimer),this._checkReadyTimer=null,this._loadImageQueue.resume(),this.emit("renderInvalid"),!0)},y.prototype.createRenderer=function(t){return new t(this._flashElement,++this._nextLayerId,_)},y.prototype.destroyRenderer=function(t){t.destroy()},y.prototype.startFrame=function(){},y.prototype.endFrame=function(){},y.prototype.takeSnapshot=function(t){"object"==typeof t&&null!=t||(t={});var e=t.quality;if(void 0===e&&(e=75),"number"!=typeof e||e<0||e>100)throw new Error("FlashStage: Snapshot quality needs to be a number between 0 and 100");return this._flashElement.takeSnapshot(e)},y.type=y.prototype.type="flash",g.prototype.refresh=function(t,e){},g.prototype.destroy=function(){this._stage._flashElement.destroyTexture(this._textureId),p(this)},y.TextureClass=y.prototype.TextureClass=g,t.exports=y},function(t,e,i){"use strict";t.exports=function(t,e){setTimeout(function(){e&&e.length>0?t.apply(null,e):t()},0)}},function(t,e,i){"use strict";var r=i(156);function n(){this.constructor.super_.apply(this,arguments)}i(29)(n,r),t.exports=n},function(t,e,i){"use strict";var r=i(59),n=i(82),o=i(6),s=i(157),a=s.createConstantBuffers,h=s.destroyConstantBuffers,l=s.createShaderProgram,u=s.destroyShaderProgram,c=s.enableAttributes,p=s.disableAttributes,f=s.setViewport,d=s.setupPixelEffectUniforms,m=s.setDepth,v=s.setTexture,_=i(232),y=i(233),g=[0,1,2,0,2,3],w=[-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0],x=[0,0,1,0,1,1,0,1],M=["aVertexPosition","aTextureCoord"],b=["uDepth","uOpacity","uSampler","uProjMatrix","uViewportMatrix","uColorOffset","uColorMatrix"];function S(t){this.gl=t,this.projMatrix=r.create(),this.viewportMatrix=r.create(),this.translateVector=n.create(),this.scaleVector=n.create(),this.constantBuffers=a(t,g,w,x),this.shaderProgram=l(t,_,y,M,b)}S.prototype.destroy=function(){h(this.gl,this.constantBuffers),u(this.gl,this.shaderProgram),o(this)},S.prototype.startLayer=function(t,e){var i=this.gl,r=this.shaderProgram,n=this.constantBuffers,o=this.viewportMatrix;i.useProgram(r),c(i,r);for(var s=i.getProgramParameter(r,i.ACTIVE_ATTRIBUTES),a=0;a<s;a++)i.enableVertexAttribArray(a);f(i,t,e,o),i.uniformMatrix4fv(r.uViewportMatrix,!1,o),i.bindBuffer(i.ARRAY_BUFFER,n.vertexPositions),i.vertexAttribPointer(r.aVertexPosition,3,i.FLOAT,i.FALSE,0,0),i.bindBuffer(i.ARRAY_BUFFER,n.textureCoords),i.vertexAttribPointer(r.aTextureCoord,2,i.FLOAT,i.FALSE,0,0),d(i,t.effects(),{opacity:r.uOpacity,colorOffset:r.uColorOffset,colorMatrix:r.uColorMatrix})},S.prototype.endLayer=function(t,e){var i=this.gl,r=this.shaderProgram;p(i,r)},S.prototype.renderTile=function(t,e,i,n){var o=this.gl,s=this.shaderProgram,a=this.constantBuffers,h=this.projMatrix,l=this.translateVector,u=this.scaleVector;l[0]=t.centerX(),l[1]=t.centerY(),l[2]=-.5,u[0]=t.scaleX(),u[1]=t.scaleY(),u[2]=1,r.copy(h,i.view().projection()),r.rotateX(h,h,t.rotX()),r.rotateY(h,h,t.rotY()),r.translate(h,h,l),r.scale(h,h,u),o.uniformMatrix4fv(s.uProjMatrix,!1,h),m(o,s,n,t.z),v(o,s,e),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,a.vertexIndices),o.drawElements(o.TRIANGLES,g.length,o.UNSIGNED_SHORT,0)},t.exports=S},function(t,e,i){"use strict";var r=256,n=256,o=i(83),s=i(84),a=i(82),h=i(59);function l(t,e,i){var r=t.createShader(e);if(t.shaderSource(r,i),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw t.getShaderInfoLog(r);return r}function u(t,e,i,r){var n=t.createBuffer();return t.bindBuffer(e,n),t.bufferData(e,r,i),n}var c=1,p=s.create(),f=h.create();h.identity(f);var d=a.create(),m=a.create();t.exports={createShaderProgram:function(t,e,i,r,n){var o=l(t,t.VERTEX_SHADER,e),s=l(t,t.FRAGMENT_SHADER,i),a=t.createProgram();if(t.attachShader(a,o),t.attachShader(a,s),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw t.getProgramInfoLog(a);for(var h=0;h<r.length;h++){var u=r[h];if(a[u]=t.getAttribLocation(a,u),-1===a[u])throw new Error("Shader program has no "+u+" attribute")}for(var c=0;c<n.length;c++){var p=n[c];if(a[p]=t.getUniformLocation(a,p),-1===a[p])throw new Error("Shader program has no "+p+" uniform")}return a},destroyShaderProgram:function(t,e){for(var i=t.getAttachedShaders(e),r=0;r<i.length;r++){var n=i[r];t.detachShader(e,n),t.deleteShader(n)}t.deleteProgram(e)},createConstantBuffers:function(t,e,i,r){return{vertexIndices:u(t,t.ELEMENT_ARRAY_BUFFER,t.STATIC_DRAW,new Uint16Array(e)),vertexPositions:u(t,t.ARRAY_BUFFER,t.STATIC_DRAW,new Float32Array(i)),textureCoords:u(t,t.ARRAY_BUFFER,t.STATIC_DRAW,new Float32Array(r))}},destroyConstantBuffers:function(t,e){t.deleteBuffer(e.vertexIndices),t.deleteBuffer(e.vertexPositions),t.deleteBuffer(e.textureCoords)},enableAttributes:function(t,e){for(var i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),r=0;r<i;r++)t.enableVertexAttribArray(r)},disableAttributes:function(t,e){for(var i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),r=0;r<i;r++)t.disableVertexAttribArray(r)},setTexture:function(t,e,i){t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,i._texture),t.uniform1i(e.uSampler,0)},setDepth:function(t,e,i,o){var s=((i+1)*n-o)/(n*r);t.uniform1f(e.uDepth,s)},setViewport:function(t,e,i,r){if(0===i.x&&1===i.width&&0===i.y&&1===i.height)return t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),void h.identity(r);var n=i.x,s=o(n,0,1),l=s-n,u=1-s,c=o(i.width-l,0,u),p=i.width-c,f=1-i.height-i.y,v=o(f,0,1),_=v-f,y=1-v,g=o(i.height-_,0,y),w=i.height-g;a.set(m,i.width/c,i.height/g,1),a.set(d,(p-l)/c,(w-_)/g,0),h.identity(r),h.translate(r,r,d),h.scale(r,r,m),t.viewport(t.drawingBufferWidth*s,t.drawingBufferHeight*v,t.drawingBufferWidth*c,t.drawingBufferHeight*g)},setupPixelEffectUniforms:function(t,e,i){var r=c;e&&null!=e.opacity&&(r=e.opacity),t.uniform1f(i.opacity,r);var n=p;e&&e.colorOffset&&(n=e.colorOffset),t.uniform4fv(i.colorOffset,n);var o=f;e&&e.colorMatrix&&(o=e.colorMatrix),t.uniformMatrix4fv(i.colorMatrix,!1,o)}}},function(t,e,i){"use strict";var r=i(156);function n(){this.constructor.super_.apply(this,arguments)}i(29)(n,r),t.exports=n},function(t,e,i){"use strict";var r=i(59),n=i(6),o=i(157),s=o.createConstantBuffers,a=o.destroyConstantBuffers,h=o.createShaderProgram,l=o.destroyShaderProgram,u=o.enableAttributes,c=o.disableAttributes,p=o.setViewport,f=o.setupPixelEffectUniforms,d=o.setDepth,m=o.setTexture,v=i(234),_=i(235),y=[0,1,2,0,2,3],g=[-1,-1,0,1,-1,0,1,1,0,-1,1,0],w=[0,0,1,0,1,1,0,1],x=["aVertexPosition"],M=["uDepth","uOpacity","uSampler","uInvProjMatrix","uViewportMatrix","uColorOffset","uColorMatrix","uTextureX","uTextureY","uTextureWidth","uTextureHeight"];function b(t){this.gl=t,this.invProjMatrix=r.create(),this.viewportMatrix=r.create(),this.constantBuffers=s(t,y,g,w),this.shaderProgram=h(t,v,_,x,M)}b.prototype.destroy=function(){a(this.gl,this.constantBuffers),l(this.gl,this.shaderProgram),n(this)},b.prototype.startLayer=function(t,e){var i=this.gl,n=this.shaderProgram,o=this.constantBuffers,s=this.invProjMatrix,a=this.viewportMatrix;i.useProgram(n),u(i,n),p(i,t,e,a),i.uniformMatrix4fv(n.uViewportMatrix,!1,a),i.bindBuffer(i.ARRAY_BUFFER,o.vertexPositions),i.vertexAttribPointer(n.aVertexPosition,3,i.FLOAT,i.FALSE,0,0),i.bindBuffer(i.ARRAY_BUFFER,o.textureCoords),r.copy(s,t.view().projection()),r.invert(s,s),i.uniformMatrix4fv(n.uInvProjMatrix,!1,s);var h=t.effects().textureCrop||{},l=null!=h.x?h.x:0,c=null!=h.y?h.y:0,d=null!=h.width?h.width:1,m=null!=h.height?h.height:1;i.uniform1f(n.uTextureX,l),i.uniform1f(n.uTextureY,c),i.uniform1f(n.uTextureWidth,d),i.uniform1f(n.uTextureHeight,m),f(i,t.effects(),{opacity:n.uOpacity,colorOffset:n.uColorOffset,colorMatrix:n.uColorMatrix})},b.prototype.endLayer=function(t,e){var i=this.gl,r=this.shaderProgram;c(i,r)},b.prototype.renderTile=function(t,e,i,r){var n=this.gl,o=this.shaderProgram,s=this.constantBuffers;d(n,o,r,t.z),m(n,o,e),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,s.vertexIndices),n.drawElements(n.TRIANGLES,y.length,n.UNSIGNED_SHORT,0)},t.exports=b},function(t,e,i){"use strict";var r=i(128).TileClass,n=i(165),o=i(86);function s(t,e){this.constructor.super_.call(this,t,e,r)}i(29)(s,n),s.prototype.calculateTransform=function(t,e,i){var r=this._browserQuirks.padSize,n=this._browserQuirks.reverseLevelDepth,s=this._browserQuirks.perspectiveNudge,a="",h=n?256-t.z:t.levelWidth(),l=i.size(),u=l.width,c=l.height;a+="translate3d("+o(u/2)+"px, "+o(c/2)+"px, 0px) ";var p=.5*c/Math.tan(i.fov()/2),f=p+s;a+="perspective("+o(p)+"px) translateZ("+o(f)+"px) ";var d=-i.roll(),m=-i.pitch(),v=i.yaw();a+="rotateZ("+o(d)+"rad) rotateX("+o(m)+"rad) rotateY("+o(v)+"rad) ";var _=-t.rotX(),y=t.rotY();a+="rotateX("+o(_)+"rad) rotateY("+o(y)+"rad) ";var g=t.centerX()-t.scaleX()/2,w=-(t.centerY()+t.scaleY()/2)*h,x=-h/2;if(a+="translate3d("+o(g*h)+"px, "+o(w)+"px, "+o(x)+"px) ",n){var M=h*t.scaleX()/t.width(),b=h*t.scaleY()/t.height();a+="scale("+o(M)+", "+o(b)+") "}var S=t.padLeft()?r:0,E=t.padTop()?r:0;return 0===S&&0===E||(a+="translate3d("+o(-S)+"px, "+o(-E)+"px, 0) "),a},t.exports=s},function(t,e,i){"use strict";var r=i(162);function n(t,e){this._equals=t,this._hash=e,this._queue=[],this._visited=new r(t,e),this._neighborsFun=null,this._exploreFun=null}n.prototype.start=function(t,e,i){if(this._neighborsFun||this._exploreFun)throw new Error("GraphFinder: search already in progress");this.reset(),this._neighborsFun=e,this._exploreFun=i,this._queue.push(t)},n.prototype.reset=function(){this._neighborsFun=null,this._exploreFun=null,this._queue.length=0,this._visited.clear()},n.prototype.next=function(){var t=this._queue,e=this._visited,i=this._neighborsFun,r=this._exploreFun;if(!i||!r)throw new Error("GraphFinder: no search in progress");for(;t.length>0;){var n=this._queue.shift();if(!e.has(n)&&r(n)){e.add(n);for(var o=i(n),s=0;s<o.length;s++)t.push(o[s]);return n}}return this.reset(),null},t.exports=n},function(t,e,i){"use strict";var r=32;function n(t,e,i){if("function"!=typeof t)throw new Error("Set: bad equals function");if(this._equals=t,"function"!=typeof e)throw new Error("Set: bad hash function");if(this._hash=e,null!=i){if("number"!=typeof i||isNaN(i)||i<1)throw new Error("Set: bad number of buckets");this._nbuckets=i}else this._nbuckets=r;this._buckets=[];for(var n=0;n<this._nbuckets;n++)this._buckets.push([])}n.prototype._hashmod=function(t){return this._hash(t)%this._nbuckets},n.prototype.add=function(t){for(var e=this._hashmod(t),i=this._buckets[e],r=0;r<i.length;r++){var n=i[r];if(this._equals(t,n))return i[r]=t,n}return i.push(t),null},n.prototype.remove=function(t){for(var e=this._hashmod(t),i=this._buckets[e],r=0;r<i.length;r++){var n=i[r];if(this._equals(t,n)){for(var o=r;o<i.length-1;o++)i[o]=i[o+1];return i.length=i.length-1,n}}return null},n.prototype.has=function(t){for(var e=this._hashmod(t),i=this._buckets[e],r=0;r<i.length;r++){var n=i[r];if(this._equals(t,n))return!0}return!1},n.prototype.size=function(){for(var t=0,e=0;e<this._nbuckets;e++){t+=this._buckets[e].length}return t},n.prototype.clear=function(){for(var t=0;t<this._nbuckets;t++){this._buckets[t].length=0}},n.prototype.each=function(t){for(var e=0,i=0;i<this._nbuckets;i++)for(var r=this._buckets[i],n=0;n<r.length;n++){t(r[n]),e+=1}return e},t.exports=n},function(t,e,i){"use strict";var r=i(85);function n(t,e,i){if("function"!=typeof t)throw new Error("LruMap: bad equals function");if(this._equals=t,"function"!=typeof e)throw new Error("LruMap: bad hash function");if(this._hash=e,"number"!=typeof i||isNaN(i)||i<0)throw new Error("LruMap: bad maximum size");this._maxsize=i,this._keys=[],this._values=[],this._pivot=0}n.prototype._modulus=function(){return this._maxsize>this._keys.length?this._keys.length+1:this._maxsize},n.prototype.get=function(t){for(var e=0;e<this._keys.length;e++){var i=this._keys[e];if(this._equals(t,i))return this._values[e]}return null},n.prototype.set=function(t,e){var i=null,n=!1;if(0===this._maxsize)return t;for(var o=0;o<this._keys.length;o++){var s=this._keys[o];if(this._equals(t,s)){for(var a=o,h=this._modulus();a!==this._pivot;){var l=r(a+1,h);this._keys[a]=this._keys[l],this._values[a]=this._values[l],a=l}n=!0;break}}return n||(i=this._pivot<this._keys.length?this._keys[this._pivot]:null),this._keys[this._pivot]=t,this._values[this._pivot]=e,this._pivot=r(this._pivot+1,this._modulus()),i},n.prototype.del=function(t){for(var e=0;e<this._keys.length;e++){var i=this._keys[e];if(this._equals(t,i)){for(var n=this._values[e],o=e;o<this._keys.length-1;o++)this._keys[o]=this._keys[o+1],this._values[o]=this._values[o+1];return this._keys.length=this._keys.length-1,this._values.length=this._values.length-1,e<this._pivot&&(this._pivot=r(this._pivot-1,this._modulus())),n}}return null},n.prototype.has=function(t){for(var e=0;e<this._keys.length;e++){var i=this._keys[e];if(this._equals(t,i))return!0}return!1},n.prototype.size=function(){return this._keys.length},n.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._pivot=0},n.prototype.each=function(t){for(var e=0,i=0;i<this._keys.length;i++){t(this._keys[i],this._values[i]),e+=1}return e},t.exports=n},function(t,e,i){"use strict";var r=i(82),n=i(59),o=n.identity(n.create()),s=n.create();t.exports=function(t,e,i,a,h){return n.copy(s,o),i&&n.rotateY(s,s,i),a&&n.rotateX(s,s,a),h&&n.rotateZ(s,s,h),r.transformMat4(t,e,s),t}},function(t,e,i){"use strict";var r=i(88),n=i(86),o=i(9).setOverflowHidden,s=i(9).setNoPointerEvents,a=i(9).setNullTransform,h=i(9).setTransform,l=i(6),u="undefined"!=typeof MARZIPANODEBUG&&MARZIPANODEBUG.css;function c(t,e){return t.cmp(e)}function p(t,e,i){this._root=t,this._browserQuirks=e;var n=document.createElement("div");t.appendChild(n),n.style.position="absolute",o(n),s(n),this._browserQuirks.useNullTransform&&a(n),this.domElement=n,this._oldTileList=[],this._newTileList=[],this._textureMap=new r(i.equals,i.hash)}p.prototype.destroy=function(){this._root.removeChild(this.domElement),l(this)},p.prototype.startLayer=function(t,e){var i=this.domElement,r=this._root.clientWidth,o=this._root.clientHeight;i.style.left=n(r*e.left)+"px",i.style.top=n(o*e.top)+"px",i.style.width=n(r*e.width)+"px",i.style.height=n(o*e.height)+"px";var s=1,a=t.effects();a&&null!=a.opacity&&(s=a.opacity),i.style.opacity=s,this._newTileList.length=0,this._textureMap.clear()},p.prototype.renderTile=function(t,e){this._newTileList.push(t),this._textureMap.set(t,e)},p.prototype.endLayer=function(t,e){var i,r,n,o,s,a,l,p,f=this.domElement,d=this._oldTileList,m=this._newTileList,v=this._textureMap,_=t.view();if(f.children.length!==d.length)throw new Error("DOM not in sync with tile list");for(m.sort(c),n=d[i=0],l=f.firstChild,r=0;r<m.length;r++){for(o=m[r];i<d.length&&!(n.cmp(o)>=0);)p=l.nextSibling,f.removeChild(l),l=p,n=d[++i];if(!(a=(s=v.get(o))?s._canvas:null))throw new Error("Rendering tile with missing texture");if(n&&0===n.cmp(o)){if(a!=l)throw new Error("DOM not in sync with tile list");l=l.nextSibling,n=d[++i]}else f.insertBefore(a,l);h(a,this.calculateTransform(o,s,_)),u&&a.setAttribute("data-tile",o.str())}for(;l;)p=l.nextSibling,f.removeChild(l),l=p;if(f.children.length!==m.length)throw new Error("DOM not in sync with tile list");var y=this._oldTileList;this._oldTileList=this._newTileList,this._newTileList=y},t.exports=p},function(t,e,i){"use strict";var r=i(130).TileClass,n=i(165),o=i(86);function s(t,e){this.constructor.super_.call(this,t,e,r)}i(29)(s,n),s.prototype.calculateTransform=function(t,e,i){var r=this._browserQuirks.padSize,n="",s=i.width(),a=i.height();n+="translateX("+o(s/2)+"px) translateY("+o(a/2)+"px) ";var h=s/i._zoomX(),l=a/i._zoomY(),u=t.centerX()-t.scaleX()/2+.5,c=(.5-t.centerY()-t.scaleY()/2)*l;n+="translateX("+o(u*h)+"px) translateY("+o(c)+"px) ";var p=-i.x()*h,f=-i.y()*l;n+="translateX("+o(p)+"px) translateY("+o(f)+"px) ";var d=t.padLeft()?r:0,m=t.padTop()?r:0;0===d&&0===m||(n+="translateX("+o(-d)+"px) translateY("+o(-m)+"px) ");var v=h/t.levelWidth(),_=l/t.levelHeight();return n+="scale("+o(v)+", "+o(_)+") "},t.exports=s},function(t,e,i){var r,n=i(54),o={};o.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},o.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},o.fromValues=function(t,e){var i=new n.ARRAY_TYPE(2);return i[0]=t,i[1]=e,i},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},o.set=function(t,e,i){return t[0]=e,t[1]=i,t},o.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},o.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t},o.sub=o.subtract,o.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},o.mul=o.multiply,o.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},o.div=o.divide,o.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},o.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},o.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t},o.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t},o.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},o.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},o.scaleAndAdd=function(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t},o.distance=function(t,e){var i=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(i*i+r*r)},o.dist=o.distance,o.squaredDistance=function(t,e){var i=e[0]-t[0],r=e[1]-t[1];return i*i+r*r},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],i=t[1];return Math.sqrt(e*e+i*i)},o.len=o.length,o.squaredLength=function(t){var e=t[0],i=t[1];return e*e+i*i},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},o.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},o.normalize=function(t,e){var i=e[0],r=e[1],n=i*i+r*r;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},o.cross=function(t,e,i){var r=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=r,t},o.lerp=function(t,e,i,r){var n=e[0],o=e[1];return t[0]=n+r*(i[0]-n),t[1]=o+r*(i[1]-o),t},o.random=function(t,e){e=e||1;var i=2*n.RANDOM()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t},o.transformMat2=function(t,e,i){var r=e[0],n=e[1];return t[0]=i[0]*r+i[2]*n,t[1]=i[1]*r+i[3]*n,t},o.transformMat2d=function(t,e,i){var r=e[0],n=e[1];return t[0]=i[0]*r+i[2]*n+i[4],t[1]=i[1]*r+i[3]*n+i[5],t},o.transformMat3=function(t,e,i){var r=e[0],n=e[1];return t[0]=i[0]*r+i[3]*n+i[6],t[1]=i[1]*r+i[4]*n+i[7],t},o.transformMat4=function(t,e,i){var r=e[0],n=e[1];return t[0]=i[0]*r+i[4]*n+i[12],t[1]=i[1]*r+i[5]*n+i[13],t},o.forEach=(r=o.create(),function(t,e,i,n,o,s){var a,h;for(e||(e=2),i||(i=0),h=n?Math.min(n*e+i,t.length):t.length,a=i;a<h;a+=e)r[0]=t[a],r[1]=t[a+1],o(r,r,s),t[a]=r[0],t[a+1]=r[1];return t}),o.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},o.equals=function(t,e){var i=t[0],r=t[1],o=e[0],s=e[1];return Math.abs(i-o)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-s)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))},t.exports=o},function(t,e,i){"use strict";var r=i(169),n=i(128).TileClass,o=i(29),s=i(170);function a(t,e,i){this.constructor.super_.call(this,t,e,i,n),this._flashTileList=[]}o(a,r),a.prototype._renderOnFlash=function(t,e){var i=this._flashElement,r=this._layerId,n=this._quirks.padSize,o=this._tileList,a=this._textureMap,h=this._flashTileList;h.length=0;for(var l=0;l<o.length;l++){var u=o[l],c=a.get(u);if(!c)throw new Error("Rendering tile with missing texture");var p=u.padTop()?n:0,f=u.padBottom()?n:0,d=u.padLeft()?n:0,m=u.padRight()?n:0;h.push({textureId:c._textureId,face:u.face,width:u.width(),height:u.height(),centerX:u.centerX(),centerY:u.centerY(),rotX:s(u.rotX()),rotY:s(u.rotY()),levelSize:u.levelWidth(),padTop:p,padBottom:f,padLeft:d,padRight:m})}var v=this._flashElement.clientWidth,_=this._flashElement.clientHeight,y=v*e.x,g=_*e.y,w=v*e.width,x=_*e.height,M=1,b=t.effects();b&&null!=b.opacity&&(M=b.opacity);var S=t.view(),E=S.yaw(),I=S.pitch(),T=S.roll(),D=S.fov();i.drawCubeTiles(r,w,x,y,g,M,E,I,T,D,h)},t.exports=a},function(t,e,i){"use strict";var r=i(88),n=i(6);function o(t,e){return t.cmp(e)}function s(t,e,i,n){this._flashElement=t,this._layerId=e,this._quirks=i,this._tileList=[],this._textureMap=new r(n.equals,n.hash),this._layerCreated=!1}s.prototype.destroy=function(){this._layerCreated&&this._flashElement.destroyLayer(this._layerId),n(this)},s.prototype.startLayer=function(t,e){this._flashElement.isReady&&this._flashElement.isReady()&&(this._layerCreated||(this._flashElement.createLayer(this._layerId),this._layerCreated=!0),this._tileList.length=0,this._textureMap.clear())},s.prototype.renderTile=function(t,e){this._tileList.push(t),this._textureMap.set(t,e)},s.prototype.endLayer=function(t,e){this._flashElement.isReady&&this._flashElement.isReady()&&(this._tileList.sort(o),this._renderOnFlash(t,e))},t.exports=s},function(t,e,i){"use strict";t.exports=function(t){return 180*t/Math.PI}},function(t,e,i){"use strict";var r=i(169),n=i(130).TileClass;function o(t,e,i){this.constructor.super_.call(this,t,e,i,n),this._flashTileList=[]}i(29)(o,r),o.prototype._renderOnFlash=function(t,e){var i=this._flashElement,r=this._layerId,n=this._quirks.padSize,o=this._tileList,s=this._textureMap,a=this._flashTileList;a.length=0;for(var h=0;h<o.length;h++){var l=o[h],u=s.get(l);if(!u)throw new Error("Rendering tile with missing texture");var c=l.padTop()?n:0,p=l.padBottom()?n:0,f=l.padLeft()?n:0,d=l.padRight()?n:0;a.push({textureId:u._textureId,width:l.width(),height:l.height(),centerX:l.centerX(),centerY:l.centerY(),scaleX:l.scaleX(),scaleY:l.scaleY(),levelWidth:l.levelWidth(),levelHeight:l.levelHeight(),padTop:c,padBottom:p,padLeft:f,padRight:d})}var m=this._flashElement.clientWidth,v=this._flashElement.clientHeight,_=m*e.x,y=v*e.y,g=m*e.width,w=v*e.height,x=1,M=t.effects();M&&null!=M.opacity&&(x=M.opacity);var b=t.view(),S=b.x(),E=b.y(),I=b._zoomX(),T=b._zoomY();i.drawFlatTiles(r,g,w,_,y,x,S,E,I,T,a)},t.exports=o},function(t,e,i){"use strict";var r=i(155),n=i(158),o=i(159),s=i(160),a=i(166),h=i(168),l=i(171);t.exports=function(t){switch(t.type){case"webgl":t.registerRenderer("flat","flat",n),t.registerRenderer("cube","rectilinear",r),t.registerRenderer("equirect","rectilinear",o);break;case"css":t.registerRenderer("flat","flat",a),t.registerRenderer("cube","rectilinear",s);break;case"flash":t.registerRenderer("flat","flat",l),t.registerRenderer("cube","rectilinear",h);break;default:throw new Error("Unknown stage type: "+t.type)}}},function(t,e,i){"use strict";function r(t,e,i){return 2*Math.atan(i*Math.tan(t/2)/e)}t.exports={convert:r,htov:function(t,e,i){return r(t,e,i)},htod:function(t,e,i){return r(t,e,Math.sqrt(e*e+i*i))},vtoh:function(t,e,i){return r(t,i,e)},vtod:function(t,e,i){return r(t,i,Math.sqrt(e*e+i*i))},dtoh:function(t,e,i){return r(t,Math.sqrt(e*e+i*i),e)},dtov:function(t,e,i){return r(t,Math.sqrt(e*e+i*i),i)}}},function(t,e,i){"use strict";t.exports=function(){var t=arguments;return function(e){for(var i=e,r=0;r<t.length;r++)i=t[r].call(null,i);return i}}},function(t,e,i){"use strict";t.exports=function(t,e){var i=null;return i=setTimeout(function(){null!=i&&(i=null,e(null))},t),function(){null!=i&&(clearTimeout(i),i=null,e.apply(null,arguments))}}},function(t,e,i){"use strict";var r=i(88),n=i(162),o=i(243),s=i(16),a=i(48),h=i(177),l=i(132),u=i(29),c=i(6),p="undefined"!=typeof MARZIPANODEBUG&&MARZIPANODEBUG.textureStore,f={IDLE:0,START:1,MARK:2,END:3},d={previouslyVisibleCacheSize:32},m=0;function v(){}function _(t,e){var i=this,r=m++;i._id=r,i._store=t,i._tile=e,i._asset=null,i._texture=null,i._changeHandler=function(){t.emit("textureInvalid",e)};var n=t.source(),o=t.stage(),s=n.loadAsset.bind(n),a=o.createTexture.bind(o),u=l(h(s),a);t.emit("textureStartLoad",e),p&&console.log("loading",r,e),i._cancel=u(o,e,function(n,o,s,a){if(i._cancel=null,n)return s&&s.destroy(),a&&a.destroy(),void(n instanceof v?(t.emit("textureCancel",e),p&&console.log("cancel",r,e)):(t.emit("textureError",e,n),p&&console.log("error",r,e)));i._texture=a,s.dynamic?(i._asset=s,s.addEventListener("change",i._changeHandler)):s.destroy(),t.emit("textureLoad",e),p&&console.log("load",r,e)})}function y(t,e,i,s){s=a(s||{},d);var h=t.TileClass;this._source=e,this._stage=i,this._state=f.IDLE,this._delimCount=0,this._itemMap=new r(h.equals,h.hash),this._visible=new n(h.equals,h.hash),this._previouslyVisible=new o(h.equals,h.hash,s.previouslyVisibleCacheSize),this._pinMap=new r(h.equals,h.hash),this._newVisible=new n(h.equals,h.hash),this._noLongerVisible=[],this._visibleAgain=[],this._evicted=[]}u(v,Error),_.prototype.asset=function(){return this._asset},_.prototype.texture=function(){return this._texture},_.prototype.destroy=function(){var t=this._id,e=this._store,i=this._tile,r=this._asset,n=this._texture,o=this._cancel;o?o(new v("Texture load cancelled")):(r&&(r.removeEventListener("change",this._changeHandler),r.destroy()),n&&n.destroy(),e.emit("textureUnload",i),p&&console.log("unload",t,i),c(this))},s(_),s(y),y.prototype.destroy=function(){this.clear(),c(this)},y.prototype.stage=function(){return this._stage},y.prototype.source=function(){return this._source},y.prototype.clear=function(){var t=this;t._evicted.length=0,t._itemMap.each(function(e){t._evicted.push(e)}),t._evicted.forEach(function(e){t._unloadTile(e)}),t._itemMap.clear(),t._visible.clear(),t._previouslyVisible.clear(),t._pinMap.clear(),t._newVisible.clear(),t._noLongerVisible.length=0,t._visibleAgain.length=0,t._evicted.length=0},y.prototype.clearNotPinned=function(){var t=this;t._evicted.length=0,t._itemMap.each(function(e){t._pinMap.has(e)||t._evicted.push(e)}),t._evicted.forEach(function(e){t._unloadTile(e)}),t._visible.clear(),t._previouslyVisible.clear(),t._evicted.length=0},y.prototype.startFrame=function(){if(this._state!==f.IDLE)throw new Error("TextureStore: startFrame called out of sequence");this._state=f.START,this._delimCount++},y.prototype.markTile=function(t){if(this._state!==f.START&&this._state!==f.MARK)throw new Error("TextureStore: markTile called out of sequence");this._state=f.MARK;var e=this._itemMap.get(t),i=e&&e.texture(),r=e&&e.asset();i&&r&&i.refresh(t,r),this._newVisible.add(t)},y.prototype.endFrame=function(){if(this._state!==f.START&&this._state!==f.MARK)throw new Error("TextureStore: endFrame called out of sequence");this._state=f.END,this._delimCount--,this._delimCount||(this._update(),this._state=f.IDLE)},y.prototype._update=function(){var t=this;t._noLongerVisible.length=0,t._visible.each(function(e){t._newVisible.has(e)||t._noLongerVisible.push(e)}),t._visibleAgain.length=0,t._newVisible.each(function(e){t._previouslyVisible.has(e)&&t._visibleAgain.push(e)}),t._visibleAgain.forEach(function(e){t._previouslyVisible.remove(e)}),t._evicted.length=0,t._noLongerVisible.forEach(function(e){var i=t._itemMap.get(e);if(i&&i.texture()){var r=t._previouslyVisible.add(e);null!=r&&t._evicted.push(r)}else i&&t._unloadTile(e)}),t._evicted.forEach(function(e){t._pinMap.has(e)||t._unloadTile(e)}),t._newVisible.each(function(e){t._itemMap.get(e)||t._loadTile(e)});var e=t._visible;t._visible=t._newVisible,t._newVisible=e,t._newVisible.clear(),t._noLongerVisible.length=0,t._visibleAgain.length=0,t._evicted.length=0},y.prototype._loadTile=function(t){if(this._itemMap.has(t))throw new Error("TextureStore: loading texture already in cache");var e=new _(this,t);this._itemMap.set(t,e)},y.prototype._unloadTile=function(t){var e=this._itemMap.del(t);if(!e)throw new Error("TextureStore: unloading texture not in cache");e.destroy()},y.prototype.asset=function(t){var e=this._itemMap.get(t);return e?e.asset():null},y.prototype.texture=function(t){var e=this._itemMap.get(t);return e?e.texture():null},y.prototype.pin=function(t){var e=(this._pinMap.get(t)||0)+1;return this._pinMap.set(t,e),this._itemMap.has(t)||this._loadTile(t),e},y.prototype.unpin=function(t){var e=this._pinMap.get(t);if(!e)throw new Error("TextureStore: unpin when not pinned");return--e>0?this._pinMap.set(t,e):(this._pinMap.del(t),this._visible.has(t)||this._previouslyVisible.has(t)||this._unloadTile(t)),e},y.prototype.query=function(t){var e=this._itemMap.get(t),i=this._pinMap.get(t)||0;return{visible:this._visible.has(t),previouslyVisible:this._previouslyVisible.has(t),hasAsset:null!=e&&null!=e.asset(),hasTexture:null!=e&&null!=e.texture(),pinned:0!==i,pinCount:i}},t.exports=y},function(t,e,i){"use strict";var r=i(92);t.exports=function(t){return function(){var e=arguments.length?Array.prototype.slice.call(arguments,0,arguments.length-1):[],i=arguments.length?arguments[arguments.length-1]:r,n=null,o=!1;function s(){!arguments[0]||o?i.apply(null,arguments):n=t.apply(null,e)}return e.push(s),s(!0),function(){o=!0,n.apply(null,arguments)}}}},function(t,e,i){"use strict";var r=i(16),n=i(179),o=i(6);function s(t,e,i,r,n){n=n||{};var o=this;this._source=t,this._geometry=e,this._view=i,this._textureStore=r,this._effects=n.effects||{},this._fixedLevelIndex=null,this._viewChangeHandler=function(){o.emit("viewChange",o.view())},this._view.addEventListener("change",this._viewChangeHandler),this._textureStoreChangeHandler=function(){o.emit("textureStoreChange",o.textureStore())},this._textureStore.addEventListener("textureLoad",this._textureStoreChangeHandler),this._textureStore.addEventListener("textureError",this._textureStoreChangeHandler),this._textureStore.addEventListener("textureInvalid",this._textureStoreChangeHandler)}r(s),s.prototype.destroy=function(){this._view.removeEventListener("change",this._viewChangeHandler),this._textureStore.removeEventListener("textureLoad",this._textureStoreChangeHandler),this._textureStore.removeEventListener("textureError",this._textureStoreChangeHandler),this._textureStore.removeEventListener("textureInvalid",this._textureStoreChangeHandler),o(this)},s.prototype.source=function(){return this._source},s.prototype.geometry=function(){return this._geometry},s.prototype.view=function(){return this._view},s.prototype.textureStore=function(){return this._textureStore},s.prototype.effects=function(){return this._effects},s.prototype.setEffects=function(t){this._effects=t,this.emit("effectsChange",this._effects)},s.prototype.mergeEffects=function(t){n(this._effects,t),this.emit("effectsChange",this._effects)},s.prototype.fixedLevel=function(){return this._fixedLevelIndex},s.prototype.setFixedLevel=function(t){if(t!==this._fixedLevelIndex){if(null!=t&&(t>=this._geometry.levelList.length||t<0))throw new Error("Level index out of range: "+t);this._fixedLevelIndex=t,this.emit("fixedLevelChange",this._fixedLevelIndex)}},s.prototype._selectLevel=function(){return null!=this._fixedLevelIndex?this._geometry.levelList[this._fixedLevelIndex]:this._view.selectLevel(this._geometry.selectableLevelList)},s.prototype.visibleTiles=function(t){var e=this._selectLevel();return this._geometry.visibleTiles(this._view,e,t)},s.prototype.pinLevel=function(t){for(var e=this._geometry.levelList[t],i=this._geometry.levelTiles(e),r=0;r<i.length;r++)this._textureStore.pin(i[r])},s.prototype.unpinLevel=function(t){for(var e=this._geometry.levelList[t],i=this._geometry.levelTiles(e),r=0;r<i.length;r++)this._textureStore.unpin(i[r])},s.prototype.pinFirstLevel=function(){return this.pinLevel(0)},s.prototype.unpinFirstLevel=function(){return this.unpinLevel(0)},t.exports=s},function(t,e,i){"use strict";t.exports=function(t,e){for(var i in e)t[i]=e[i];return t}},function(t,e,i){"use strict";var r=i(16),n=i(6);function o(t){var e=this;this._stage=t,this._running=!1,this._rendering=!1,this._requestHandle=null,this._boundLoop=this._loop.bind(this),this._renderInvalidHandler=function(){e._rendering||e.renderOnNextFrame()},this._stage.addEventListener("renderInvalid",this._renderInvalidHandler)}r(o),o.prototype.destroy=function(){this.stop(),this._stage.removeEventListener("renderInvalid",this._renderInvalidHandler),n(this)},o.prototype.stage=function(){return this._stage},o.prototype.start=function(){this._running=!0,this.renderOnNextFrame()},o.prototype.stop=function(){this._requestHandle&&(window.cancelAnimationFrame(this._requestHandle),this._requestHandle=null),this._running=!1},o.prototype.renderOnNextFrame=function(){this._running&&!this._requestHandle&&(this._requestHandle=window.requestAnimationFrame(this._boundLoop))},o.prototype._loop=function(){if(!this._running)throw new Error("Render loop running while in stopped state");this._requestHandle=null,this._rendering=!0,this.emit("beforeRender"),this._rendering=!1,this._stage.render(),this.emit("afterRender")},t.exports=o},function(t,e,i){"use strict";var r=i(16),n=i(55),o=i(6);function s(t,e,i,r,o){if(!t)throw new Error("KeyControlMethod: keyCode must be defined");if(!e)throw new Error("KeyControlMethod: parameter must be defined");if(!i)throw new Error("KeyControlMethod: velocity must be defined");if(!r)throw new Error("KeyControlMethod: friction must be defined");o=o||document,this._keyCode=t,this._parameter=e,this._velocity=i,this._friction=r,this._element=o,this._keydownHandler=this._handlePress.bind(this),this._keyupHandler=this._handleRelease.bind(this),this._blurHandler=this._handleBlur.bind(this),this._element.addEventListener("keydown",this._keydownHandler),this._element.addEventListener("keyup",this._keyupHandler),window.addEventListener("blur",this._blurHandler),this._dynamics=new n,this._pressing=!1}r(s),s.prototype.destroy=function(){this._element.removeEventListener("keydown",this._keydownHandler),this._element.removeEventListener("keyup",this._keyupHandler),window.removeEventListener("blur",this._blurHandler),o(this)},s.prototype._handlePress=function(t){t.keyCode===this._keyCode&&(this._pressing=!0,this._dynamics.velocity=this._velocity,this._dynamics.friction=0,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("active"))},s.prototype._handleRelease=function(t){t.keyCode===this._keyCode&&(this._pressing&&(this._dynamics.friction=this._friction,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("inactive")),this._pressing=!1)},s.prototype._handleBlur=function(){this._dynamics.velocity=0,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("inactive"),this._pressing=!1},t.exports=s},function(t,e,i){"use strict";var r=i(16),n=i(55),o=i(101),s=i(48),a=i(184).maxFriction,h=i(6),l={friction:6,maxFrictionTime:.3},u="undefined"!=typeof MARZIPANODEBUG&&MARZIPANODEBUG.controls;function c(t,e,i){this._element=t,this._opts=s(i||{},l),this._startEvent=null,this._lastEvent=null,this._active=!1,this._dynamics={x:new n,y:new n},this._hammer=o.get(t,e),this._hammer.on("hammer.input",this._handleHammerEvent.bind(this)),this._hammer.on("panstart",this._handleStart.bind(this)),this._hammer.on("panmove",this._handleMove.bind(this)),this._hammer.on("panend",this._handleEnd.bind(this)),this._hammer.on("pancancel",this._handleEnd.bind(this))}r(c),c.prototype.destroy=function(){this._hammer.release(),h(this)},c.prototype._handleHammerEvent=function(t){if(t.isFirst){if(u&&this._active)throw new Error("DragControlMethod active detected when already active");this._active=!0,this.emit("active")}if(t.isFinal){if(u&&!this._active)throw new Error("DragControlMethod inactive detected when already inactive");this._active=!1,this.emit("inactive")}},c.prototype._handleStart=function(t){t.preventDefault(),this._startEvent=t},c.prototype._handleMove=function(t){t.preventDefault(),this._startEvent&&(this._updateDynamicsMove(t),this.emit("parameterDynamics","axisScaledX",this._dynamics.x),this.emit("parameterDynamics","axisScaledY",this._dynamics.y))},c.prototype._handleEnd=function(t){t.preventDefault(),this._startEvent&&(this._updateDynamicsRelease(t),this.emit("parameterDynamics","axisScaledX",this._dynamics.x),this.emit("parameterDynamics","axisScaledY",this._dynamics.y)),this._startEvent=!1,this._lastEvent=!1},c.prototype._updateDynamicsMove=function(t){var e=t.deltaX,i=t.deltaY,r=this._lastEvent||this._startEvent;r&&(e-=r.deltaX,i-=r.deltaY);var n=this._element.getBoundingClientRect();e/=n.right-n.left,i/=n.bottom-n.top,this._dynamics.x.reset(),this._dynamics.y.reset(),this._dynamics.x.offset=-e,this._dynamics.y.offset=-i,this._lastEvent=t};var p=[null,null];c.prototype._updateDynamicsRelease=function(t){var e=this._element.getBoundingClientRect(),i=e.right-e.left,r=e.bottom-e.top,n=1e3*t.velocityX/i,o=1e3*t.velocityY/r;this._dynamics.x.reset(),this._dynamics.y.reset(),this._dynamics.x.velocity=n,this._dynamics.y.velocity=o,a(this._opts.friction,this._dynamics.x.velocity,this._dynamics.y.velocity,this._opts.maxFrictionTime,p),this._dynamics.x.friction=p[0],this._dynamics.y.friction=p[1]},t.exports=c},function(t,e,i){var r;
/*! Hammer.JS - v2.0.4 - 2015-01-30
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2015 Jorik Tangelder;
 * Licensed under the MIT license */
/*! Hammer.JS - v2.0.4 - 2015-01-30
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2015 Jorik Tangelder;
 * Licensed under the MIT license */
!function(n,o,s,a){"use strict";var h=["","webkit","moz","MS","ms","o"],l=o.createElement("div"),u="function",c=Math.round,p=Math.abs,f=Date.now;function d(t,e,i){return setTimeout(w(t,i),e)}function m(t,e,i){return!!Array.isArray(t)&&(v(t,i[e],i),!0)}function v(t,e,i){var r;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==a)for(r=0;r<t.length;)e.call(i,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(i,t[r],r,t)}function _(t,e,i){for(var r=Object.keys(e),n=0;n<r.length;)(!i||i&&t[r[n]]===a)&&(t[r[n]]=e[r[n]]),n++;return t}function y(t,e){return _(t,e,!0)}function g(t,e,i){var r,n=e.prototype;(r=t.prototype=function(t){if(Object.create)return Object.create(t);var e=function(){};e.prototype=t;var i=new e;return e.prototype=null,i}(n)).constructor=t,r._super=n,i&&_(r,i)}function w(t,e){return function(){return t.apply(e,arguments)}}function x(t,e){return typeof t==u?t.apply(e&&e[0]||a,e):t}function M(t,e){return t===a?e:t}function b(t,e,i){v(T(e),function(e){t.addEventListener(e,i,!1)})}function S(t,e,i){v(T(e),function(e){t.removeEventListener(e,i,!1)})}function E(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function I(t,e){return t.indexOf(e)>-1}function T(t){return t.trim().split(/\s+/g)}function D(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var r=0;r<t.length;){if(i&&t[r][i]==e||!i&&t[r]===e)return r;r++}return-1}function L(t){return Array.prototype.slice.call(t,0)}function C(t,e,i){for(var r=[],n=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];D(n,s)<0&&r.push(t[o]),n[o]=s,o++}return i&&(r=e?r.sort(function(t,i){return t[e]>i[e]}):r.sort()),r}function F(t,e){for(var i,r,n=e[0].toUpperCase()+e.slice(1),o=0;o<h.length;){if((r=(i=h[o])?i+n:e)in t)return r;o++}return a}var A=1;function z(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||n}var P="ontouchstart"in n,k=F(n,"PointerEvent")!==a,R=P&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),O=25,N=1,H=2,q=4,Y=8,V=1,B=2,X=4,U=8,j=16,$=B|X,W=U|j,G=$|W,Z=["x","y"],K=["clientX","clientY"];function Q(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){x(t.options.enable,[t])&&i.handler(e)},this.init()}function J(t,e,i){var r=i.pointers.length,n=i.changedPointers.length,o=e&N&&r-n==0,s=e&(q|Y)&&r-n==0;i.isFirst=!!o,i.isFinal=!!s,o&&(t.session={}),i.eventType=e,function(t,e){var i=t.session,r=e.pointers,n=r.length;i.firstInput||(i.firstInput=tt(e));n>1&&!i.firstMultiple?i.firstMultiple=tt(e):1===n&&(i.firstMultiple=!1);var o=i.firstInput,s=i.firstMultiple,h=s?s.center:o.center,l=e.center=et(r);e.timeStamp=f(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=nt(h,l),e.distance=rt(h,l),function(t,e){var i=e.center,r=t.offsetDelta||{},n=t.prevDelta||{},o=t.prevInput||{};e.eventType!==N&&o.eventType!==q||(n=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:i.x,y:i.y});e.deltaX=n.x+(i.x-r.x),e.deltaY=n.y+(i.y-r.y)}(i,e),e.offsetDirection=it(e.deltaX,e.deltaY),e.scale=s?(u=s.pointers,c=r,rt(c[0],c[1],K)/rt(u[0],u[1],K)):1,e.rotation=s?function(t,e){return nt(e[1],e[0],K)-nt(t[1],t[0],K)}(s.pointers,r):0,function(t,e){var i,r,n,o,s=t.lastInterval||e,h=e.timeStamp-s.timeStamp;if(e.eventType!=Y&&(h>O||s.velocity===a)){var l=s.deltaX-e.deltaX,u=s.deltaY-e.deltaY,c=function(t,e,i){return{x:e/t||0,y:i/t||0}}(h,l,u);r=c.x,n=c.y,i=p(c.x)>p(c.y)?c.x:c.y,o=it(l,u),t.lastInterval=e}else i=s.velocity,r=s.velocityX,n=s.velocityY,o=s.direction;e.velocity=i,e.velocityX=r,e.velocityY=n,e.direction=o}(i,e);var u,c;var d=t.element;E(e.srcEvent.target,d)&&(d=e.srcEvent.target);e.target=d}(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function tt(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:c(t.pointers[i].clientX),clientY:c(t.pointers[i].clientY)},i++;return{timeStamp:f(),pointers:e,center:et(e),deltaX:t.deltaX,deltaY:t.deltaY}}function et(t){var e=t.length;if(1===e)return{x:c(t[0].clientX),y:c(t[0].clientY)};for(var i=0,r=0,n=0;n<e;)i+=t[n].clientX,r+=t[n].clientY,n++;return{x:c(i/e),y:c(r/e)}}function it(t,e){return t===e?V:p(t)>=p(e)?t>0?B:X:e>0?U:j}function rt(t,e,i){i||(i=Z);var r=e[i[0]]-t[i[0]],n=e[i[1]]-t[i[1]];return Math.sqrt(r*r+n*n)}function nt(t,e,i){i||(i=Z);var r=e[i[0]]-t[i[0]],n=e[i[1]]-t[i[1]];return 180*Math.atan2(n,r)/Math.PI}Q.prototype={handler:function(){},init:function(){this.evEl&&b(this.element,this.evEl,this.domHandler),this.evTarget&&b(this.target,this.evTarget,this.domHandler),this.evWin&&b(z(this.element),this.evWin,this.domHandler),this.evDoc&&b(o,this.evDoc,this.domHandler),this.evBody&&b(o.body,this.evBody,this.domHandler)},destroy:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(z(this.element),this.evWin,this.domHandler),this.evDoc&&S(o,this.evDoc,this.domHandler),this.evBody&&S(o.body,this.evBody,this.domHandler)}};var ot={mousedown:N,mousemove:H,mouseup:q},st="mousedown",at="mousemove mouseup",ht=n.navigator.userAgent.indexOf("MSIE 8")>0;function lt(){this.evEl=st,ht?this.evDoc=at:this.evWin=at,this.allow=!0,this.pressed=!1,Q.apply(this,arguments)}g(lt,Q,{handler:function(t){var e=ot[t.type],i=0;ht&&(i=1),e&N&&t.button===i&&(this.pressed=!0),e&H&&t.button!==i&&(e=q),this.pressed&&this.allow&&(e&q&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var ut={pointerdown:N,pointermove:H,pointerup:q,pointercancel:Y,pointerout:Y},ct={2:"touch",3:"pen",4:"mouse",5:"kinect"},pt="pointerdown",ft="pointermove pointerup pointercancel";function dt(){this.evEl=pt,this.evWin=ft,Q.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}n.MSPointerEvent&&(pt="MSPointerDown",ft="MSPointerMove MSPointerUp MSPointerCancel"),g(dt,Q,{handler:function(t){var e=this.store,i=!1,r=t.type.toLowerCase().replace("ms",""),n=ut[r],o=ct[t.pointerType]||t.pointerType,s="touch"==o,a=D(e,t.pointerId,"pointerId");n&N&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):n&(q|Y)&&(i=!0),a<0||(e[a]=t,this.callback(this.manager,n,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),i&&e.splice(a,1))}});var mt={touchstart:N,touchmove:H,touchend:q,touchcancel:Y},vt="touchstart",_t="touchstart touchmove touchend touchcancel";function yt(){this.evTarget=vt,this.evWin=_t,this.started=!1,Q.apply(this,arguments)}g(yt,Q,{handler:function(t){var e=mt[t.type];if(e===N&&(this.started=!0),this.started){var i=function(t,e){var i=L(t.touches),r=L(t.changedTouches);e&(q|Y)&&(i=C(i.concat(r),"identifier",!0));return[i,r]}.call(this,t,e);e&(q|Y)&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:t})}}});var gt={touchstart:N,touchmove:H,touchend:q,touchcancel:Y},wt="touchstart touchmove touchend touchcancel";function xt(){this.evTarget=wt,this.targetIds={},Q.apply(this,arguments)}function Mt(){Q.apply(this,arguments);var t=w(this.handler,this);this.touch=new xt(this.manager,t),this.mouse=new lt(this.manager,t)}g(xt,Q,{handler:function(t){var e=gt[t.type],i=function(t,e){var i=L(t.touches),r=this.targetIds;if(e&(N|H)&&1===i.length)return r[i[0].identifier]=!0,[i,i];var n,o,s=L(t.changedTouches),a=[],h=this.target;if(o=i.filter(function(t){return E(t.target,h)}),e===N)for(n=0;n<o.length;)r[o[n].identifier]=!0,n++;n=0;for(;n<s.length;)r[s[n].identifier]&&a.push(s[n]),e&(q|Y)&&delete r[s[n].identifier],n++;if(!a.length)return;return[C(o.concat(a),"identifier",!0),a]}.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:t})}}),g(Mt,Q,{handler:function(t,e,i){var r="touch"==i.pointerType,n="mouse"==i.pointerType;if(r)this.mouse.allow=!1;else if(n&&!this.mouse.allow)return;e&(q|Y)&&(this.mouse.allow=!0),this.callback(t,e,i)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var bt=F(l.style,"touchAction"),St=bt!==a,Et="auto",It="manipulation",Tt="none",Dt="pan-x",Lt="pan-y";function Ct(t,e){this.manager=t,this.set(e)}Ct.prototype={set:function(t){"compute"==t&&(t=this.compute()),St&&this.manager.element.style&&(this.manager.element.style[bt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return v(this.manager.recognizers,function(e){x(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(I(t,Tt))return Tt;var e=I(t,Dt),i=I(t,Lt);if(e&&i)return Dt+" "+Lt;if(e||i)return e?Dt:Lt;if(I(t,It))return It;return Et}(t.join(" "))},preventDefaults:function(t){if(!St){var e=t.srcEvent,i=t.offsetDirection;if(!this.manager.session.prevented){var r=this.actions,n=I(r,Tt),o=I(r,Lt),s=I(r,Dt);return n||o&&i&$||s&&i&W?this.preventSrc(e):void 0}e.preventDefault()}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Ft=1,At=2,zt=4,Pt=8,kt=Pt,Rt=16;function Ot(t){this.id=A++,this.manager=null,this.options=y(t||{},this.defaults),this.options.enable=M(this.options.enable,!0),this.state=Ft,this.simultaneous={},this.requireFail=[]}function Nt(t){return t==j?"down":t==U?"up":t==B?"left":t==X?"right":""}function Ht(t,e){var i=e.manager;return i?i.get(t):t}function qt(){Ot.apply(this,arguments)}function Yt(){qt.apply(this,arguments),this.pX=null,this.pY=null}function Vt(){qt.apply(this,arguments)}function Bt(){Ot.apply(this,arguments),this._timer=null,this._input=null}function Xt(){qt.apply(this,arguments)}function Ut(){qt.apply(this,arguments)}function jt(){Ot.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function $t(t,e){return(e=e||{}).recognizers=M(e.recognizers,$t.defaults.preset),new Wt(t,e)}Ot.prototype={defaults:{},set:function(t){return _(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(m(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Ht(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return m(t,"dropRecognizeWith",this)?this:(t=Ht(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(m(t,"requireFailure",this))return this;var e=this.requireFail;return-1===D(e,t=Ht(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(m(t,"dropRequireFailure",this))return this;t=Ht(t,this);var e=D(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,i=this.state;function r(r){e.manager.emit(e.options.event+(r?function(t){if(t&Rt)return"cancel";if(t&Pt)return"end";if(t&zt)return"move";if(t&At)return"start";return""}(i):""),t)}i<Pt&&r(!0),r(),i>=Pt&&r(!0)},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|Ft)))return!1;t++}return!0},recognize:function(t){var e=_({},t);if(!x(this.options.enable,[this,e]))return this.reset(),void(this.state=32);this.state&(kt|Rt|32)&&(this.state=Ft),this.state=this.process(e),this.state&(At|zt|Pt|Rt)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},g(qt,Ot,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,r=e&(At|zt),n=this.attrTest(t);return r&&(i&Y||!n)?e|Rt:r||n?i&q?e|Pt:e&At?e|zt:At:32}}),g(Yt,qt,{defaults:{event:"pan",threshold:10,pointers:1,direction:G},getTouchAction:function(){var t=this.options.direction,e=[];return t&$&&e.push(Lt),t&W&&e.push(Dt),e},directionTest:function(t){var e=this.options,i=!0,r=t.distance,n=t.direction,o=t.deltaX,s=t.deltaY;return n&e.direction||(e.direction&$?(n=0===o?V:o<0?B:X,i=o!=this.pX,r=Math.abs(t.deltaX)):(n=0===s?V:s<0?U:j,i=s!=this.pY,r=Math.abs(t.deltaY))),t.direction=n,i&&r>e.threshold&&n&e.direction},attrTest:function(t){return qt.prototype.attrTest.call(this,t)&&(this.state&At||!(this.state&At)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Nt(t.direction);e&&this.manager.emit(this.options.event+e,t),this._super.emit.call(this,t)}}),g(Vt,qt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Tt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&At)},emit:function(t){if(this._super.emit.call(this,t),1!==t.scale){var e=t.scale<1?"in":"out";this.manager.emit(this.options.event+e,t)}}}),g(Bt,Ot,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[Et]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,r=t.distance<e.threshold,n=t.deltaTime>e.time;if(this._input=t,!r||!i||t.eventType&(q|Y)&&!n)this.reset();else if(t.eventType&N)this.reset(),this._timer=d(function(){this.state=kt,this.tryEmit()},e.time,this);else if(t.eventType&q)return kt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===kt&&(t&&t.eventType&q?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),g(Xt,qt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Tt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&At)}}),g(Ut,qt,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:$|W,pointers:1},getTouchAction:function(){return Yt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return i&($|W)?e=t.velocity:i&$?e=t.velocityX:i&W&&(e=t.velocityY),this._super.attrTest.call(this,t)&&i&t.direction&&t.distance>this.options.threshold&&p(e)>this.options.velocity&&t.eventType&q},emit:function(t){var e=Nt(t.direction);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),g(jt,Ot,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[It]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,r=t.distance<e.threshold,n=t.deltaTime<e.time;if(this.reset(),t.eventType&N&&0===this.count)return this.failTimeout();if(r&&n&&i){if(t.eventType!=q)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||rt(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=d(function(){this.state=kt,this.tryEmit()},e.interval,this),At):kt}return 32},failTimeout:function(){return this._timer=d(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==kt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),$t.VERSION="2.0.4",$t.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Xt,{enable:!1}],[Vt,{enable:!1},["rotate"]],[Ut,{direction:$}],[Yt,{direction:$},["swipe"]],[jt],[jt,{event:"doubletap",taps:2},["tap"]],[Bt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Wt(t,e){var i;e=e||{},this.options=y(e,$t.defaults),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=new((i=this).options.inputClass||(k?dt:R?xt:P?Mt:lt))(i,J),this.touchAction=new Ct(this,this.options.touchAction),Gt(this,!0),v(e.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function Gt(t,e){var i=t.element;i.style&&v(t.options.cssProps,function(t,r){i.style[F(i.style,r)]=e?t:""})}Wt.prototype={set:function(t){return _(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var r=this.recognizers,n=e.curRecognizer;(!n||n&&n.state&kt)&&(n=e.curRecognizer=null);for(var o=0;o<r.length;)i=r[o],2===e.stopped||n&&i!=n&&!i.canRecognizeWith(n)?i.reset():i.recognize(t),!n&&i.state&(At|zt|Pt)&&(n=e.curRecognizer=i),o++}},get:function(t){if(t instanceof Ot)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(m(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(m(t,"remove",this))return this;var e=this.recognizers;return t=this.get(t),e.splice(D(e,t),1),this.touchAction.update(),this},on:function(t,e){var i=this.handlers;return v(T(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this},off:function(t,e){var i=this.handlers;return v(T(t),function(t){e?i[t].splice(D(i[t],e),1):delete i[t]}),this},emit:function(t,e){this.options.domEvents&&function(t,e){var i=o.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<i.length;)i[r](e),r++}},destroy:function(){this.element&&Gt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},_($t,{INPUT_START:N,INPUT_MOVE:H,INPUT_END:q,INPUT_CANCEL:Y,STATE_POSSIBLE:Ft,STATE_BEGAN:At,STATE_CHANGED:zt,STATE_ENDED:Pt,STATE_RECOGNIZED:kt,STATE_CANCELLED:Rt,STATE_FAILED:32,DIRECTION_NONE:V,DIRECTION_LEFT:B,DIRECTION_RIGHT:X,DIRECTION_UP:U,DIRECTION_DOWN:j,DIRECTION_HORIZONTAL:$,DIRECTION_VERTICAL:W,DIRECTION_ALL:G,Manager:Wt,Input:Q,TouchAction:Ct,TouchInput:xt,MouseInput:lt,PointerEventInput:dt,TouchMouseInput:Mt,SingleTouchInput:yt,Recognizer:Ot,AttrRecognizer:qt,Tap:jt,Pan:Yt,Swipe:Ut,Pinch:Vt,Rotate:Xt,Press:Bt,on:b,off:S,each:v,merge:y,extend:_,inherit:g,bindFn:w,prefixed:F}),"function"==u&&i(123)?(r=function(){return $t}.call(e,i,e,t))===a||(t.exports=r):t.exports?t.exports=$t:n.Hammer=$t}(window,document)},function(t,e,i){"use strict";function r(t,e,i,r){var n=Math.atan(e/t);r[0]=i*Math.cos(n),r[1]=i*Math.sin(n)}t.exports={maxFriction:function(t,e,i,n,o){var s=Math.sqrt(Math.pow(e,2)+Math.pow(i,2));r(e,i,t=Math.max(t,s/n),o),o[0]=Math.abs(o[0]),o[1]=Math.abs(o[1])},changeVectorNorm:r}},function(t,e,i){"use strict";var r=i(16),n=i(55),o=i(101),s=i(48),a=i(184).maxFriction,h=i(6),l={speed:8,friction:6,maxFrictionTime:.3};function u(t,e,i){this._element=t,this._opts=s(i||{},l),this._active=!1,this._hammer=o.get(t,e),this._dynamics={x:new n,y:new n},this._hammer.on("panstart",this._handleStart.bind(this)),this._hammer.on("panmove",this._handleMove.bind(this)),this._hammer.on("panend",this._handleRelease.bind(this)),this._hammer.on("pancancel",this._handleRelease.bind(this))}r(u),u.prototype.destroy=function(){this._hammer.release(),h(this)},u.prototype._handleStart=function(t){t.preventDefault(),this._active||(this._active=!0,this.emit("active"))},u.prototype._handleMove=function(t){t.preventDefault(),this._updateDynamics(t,!1)},u.prototype._handleRelease=function(t){t.preventDefault(),this._updateDynamics(t,!0),this._active&&(this._active=!1,this.emit("inactive"))};var c=[null,null];u.prototype._updateDynamics=function(t,e){var i=this._element.getBoundingClientRect(),r=i.right-i.left,n=i.bottom-i.top,o=Math.max(r,n),s=t.deltaX/o*this._opts.speed,h=t.deltaY/o*this._opts.speed;this._dynamics.x.reset(),this._dynamics.y.reset(),this._dynamics.x.velocity=s,this._dynamics.y.velocity=h,e&&(a(this._opts.friction,this._dynamics.x.velocity,this._dynamics.y.velocity,this._opts.maxFrictionTime,c),this._dynamics.x.friction=c[0],this._dynamics.y.friction=c[1]),this.emit("parameterDynamics","x",this._dynamics.x),this.emit("parameterDynamics","y",this._dynamics.y)},t.exports=u},function(t,e,i){"use strict";var r=i(16),n=i(55),o=i(244),s=i(48),a=i(6),h={frictionTime:.2,zoomDelta:.001};function l(t,e){this._opts=s(e||{},h),this._dynamics=new n,this._eventList=[];var i=this._opts.frictionTime?this.withSmoothing:this.withoutSmoothing;this._wheelListener=new o(t,i.bind(this))}function u(t){var e=1==t.deltaMode?20:1;return t.deltaY*e}r(l),l.prototype.destroy=function(){this._wheelListener.destroy(),a(this)},l.prototype.withoutSmoothing=function(t){this._dynamics.offset=u(t)*this._opts.zoomDelta,this.emit("parameterDynamics","zoom",this._dynamics),t.preventDefault(),this.emit("active"),this.emit("inactive")},l.prototype.withSmoothing=function(t){var e=t.timeStamp;for(this._eventList.push(t);this._eventList[0].timeStamp<e-1e3*this._opts.frictionTime;)this._eventList.shift(0);for(var i=0,r=0;r<this._eventList.length;r++){i+=u(this._eventList[r])*this._opts.zoomDelta/this._opts.frictionTime}this._dynamics.velocity=i,this._dynamics.friction=Math.abs(i)/this._opts.frictionTime,this.emit("parameterDynamics","zoom",this._dynamics),t.preventDefault(),this.emit("active"),this.emit("inactive")},t.exports=l},function(t,e,i){"use strict";var r=i(16),n=i(55),o=i(101),s=i(6);function a(t,e,i){this._hammer=o.get(t,e),this._lastEvent=null,this._active=!1,this._dynamics=new n,this._hammer.on("pinchstart",this._handleStart.bind(this)),this._hammer.on("pinch",this._handleEvent.bind(this)),this._hammer.on("pinchend",this._handleEnd.bind(this)),this._hammer.on("pinchcancel",this._handleEnd.bind(this))}r(a),a.prototype.destroy=function(){this._hammer.release(),s(this)},a.prototype._handleStart=function(){this._active||(this._active=!0,this.emit("active"))},a.prototype._handleEnd=function(){this._lastEvent=null,this._active&&(this._active=!1,this.emit("inactive"))},a.prototype._handleEvent=function(t){var e=t.scale;this._lastEvent&&(e/=this._lastEvent.scale),this._dynamics.offset=-1*(e-1),this.emit("parameterDynamics","zoom",this._dynamics),this._lastEvent=t},t.exports=a},function(t,e,i){"use strict";var r=i(16),n=i(247),o=i(6),s="undefined"!=typeof MARZIPANODEBUG&&MARZIPANODEBUG.controls;function a(t){t=t||{},this._methods={},this._methodGroups={},this._composer=new n,this._enabled=!t||!t.enabled||!!t.enabled,this._activeCount=0,this.updatedViews_=[],this._attachedRenderLoop=null}r(a),a.prototype.destroy=function(){this.detach(),this._composer.destroy(),o(this)},a.prototype.methods=function(){var t={};for(var e in this._methods)t[e]=this._methods[e];return t},a.prototype.method=function(t){return this._methods[t]},a.prototype.registerMethod=function(t,e,i){if(this._methods[t])throw new Error("Control method already registered with id "+t);this._methods[t]={instance:e,enabled:!1,active:!1,activeHandler:this._handleActive.bind(this,t),inactiveHandler:this._handleInactive.bind(this,t)},i&&this.enableMethod(t,e)},a.prototype.unregisterMethod=function(t){var e=this._methods[t];if(!e)throw new Error("No control method registered with id "+t);e.enabled&&this.disableMethod(t),delete this._methods[t]},a.prototype.enableMethod=function(t){var e=this._methods[t];if(!e)throw new Error("No control method registered with id "+t);e.enabled||(e.enabled=!0,e.active&&this._incrementActiveCount(),this._listen(t),this._updateComposer(),this.emit("methodEnabled",t))},a.prototype.disableMethod=function(t){var e=this._methods[t];if(!e)throw new Error("No control method registered with id "+t);e.enabled&&(e.enabled=!1,e.active&&this._decrementActiveCount(),this._unlisten(t),this._updateComposer(),this.emit("methodDisabled",t))},a.prototype.addMethodGroup=function(t,e){this._methodGroups[t]=e},a.prototype.removeMethodGroup=function(t){delete this._methodGroups[t]},a.prototype.methodGroups=function(){var t={};for(var e in this._methodGroups)t[e]=this._methodGroups[e];return t},a.prototype.enableMethodGroup=function(t){var e=this;e._methodGroups[t].forEach(function(t){e.enableMethod(t)})},a.prototype.disableMethodGroup=function(t){var e=this;e._methodGroups[t].forEach(function(t){e.disableMethod(t)})},a.prototype.enabled=function(){return this._enabled},a.prototype.enable=function(){this._enabled=!0,this._activeCount>0&&this.emit("active"),this.emit("enabled"),this._updateComposer()},a.prototype.disable=function(){this._enabled=!1,this._activeCount>0&&this.emit("inactive"),this.emit("disabled"),this._updateComposer()},a.prototype.attach=function(t){this._attachedRenderLoop&&this.detach(),this._attachedRenderLoop=t,this._beforeRenderHandler=this._updateViewsWithControls.bind(this),this._changeHandler=t.renderOnNextFrame.bind(t),this._attachedRenderLoop.addEventListener("beforeRender",this._beforeRenderHandler),this._composer.addEventListener("change",this._changeHandler)},a.prototype.detach=function(){this._attachedRenderLoop&&(this._attachedRenderLoop.removeEventListener("beforeRender",this._beforeRenderHandler),this._composer.removeEventListener("change",this._changeHandler),this._beforeRenderHandler=null,this._changeHandler=null,this._attachedRenderLoop=null)},a.prototype.attached=function(){return null!=this._attachedRenderLoop},a.prototype._listen=function(t){var e=this._methods[t];if(!e)throw new Error("Bad method id");e.instance.addEventListener("active",e.activeHandler),e.instance.addEventListener("inactive",e.inactiveHandler)},a.prototype._unlisten=function(t){var e=this._methods[t];if(!e)throw new Error("Bad method id");e.instance.removeEventListener("active",e.activeHandler),e.instance.removeEventListener("inactive",e.inactiveHandler)},a.prototype._handleActive=function(t){var e=this._methods[t];if(!e)throw new Error("Bad method id");if(!e.enabled)throw new Error("Should not receive event from disabled control method");e.active||(e.active=!0,this._incrementActiveCount())},a.prototype._handleInactive=function(t){var e=this._methods[t];if(!e)throw new Error("Bad method id");if(!e.enabled)throw new Error("Should not receive event from disabled control method");e.active&&(e.active=!1,this._decrementActiveCount())},a.prototype._incrementActiveCount=function(){this._activeCount++,s&&this._checkActiveCount(),this._enabled&&1===this._activeCount&&this.emit("active")},a.prototype._decrementActiveCount=function(){this._activeCount--,s&&this._checkActiveCount(),this._enabled&&0===this._activeCount&&this.emit("inactive")},a.prototype._checkActiveCount=function(){var t=0;for(var e in this._methods){var i=this._methods[e];i.enabled&&i.active&&t++}if(t!=this._activeCount)throw new Error("Bad control state")},a.prototype._updateComposer=function(){var t=this._composer;for(var e in this._methods){var i=this._methods[e],r=this._enabled&&i.enabled;r&&!t.has(i.instance)&&t.add(i.instance),!r&&t.has(i.instance)&&t.remove(i.instance)}},a.prototype._updateViewsWithControls=function(){var t=this._composer.offsets();t.changing&&this._attachedRenderLoop.renderOnNextFrame(),this.updatedViews_.length=0;for(var e=this._attachedRenderLoop.stage().listLayers(),i=0;i<e.length;i++){var r=e[i].view();this.updatedViews_.indexOf(r)<0&&(e[i].view().updateWithControlParameters(t.offsets),this.updatedViews_.push(r))}},t.exports=a},function(t,e,i){"use strict";var r=i(178),n=i(176),o=i(190),s=i(16),a=i(69),h=i(92),l=i(91),u=i(48),c=i(6);function p(t,e){this._viewer=t,this._view=e,this._layers=[],this._hotspotContainer=new o(t._controlContainer,t.stage(),this._view,t.renderLoop()),this._movement=null,this._movementStartTime=null,this._movementStep=null,this._movementParams=null,this._movementCallback=null,this._updateMovementHandler=this._updateMovement.bind(this),this._updateHotspotContainerHandler=this._updateHotspotContainer.bind(this),this._viewer.addEventListener("sceneChange",this._updateHotspotContainerHandler),this._viewChangeHandler=this.emit.bind(this,"viewChange"),this._view.addEventListener("change",this._viewChangeHandler),this._updateHotspotContainer()}s(p),p.prototype.destroy=function(){this._view.removeEventListener("change",this._viewChangeHandler),this._viewer.removeEventListener("sceneChange",this._updateHotspotContainerHandler),this._movement&&this.stopMovement(),this._hotspotContainer.destroy(),this.destroyAllLayers(),c(this)},p.prototype.hotspotContainer=function(){return this._hotspotContainer},p.prototype.layer=function(){return this._layers[0]},p.prototype.listLayers=function(){return[].concat(this._layers)},p.prototype.view=function(){return this._view},p.prototype.viewer=function(){return this._viewer},p.prototype.visible=function(){return this._viewer.scene()===this},p.prototype.createLayer=function(t){var e=(t=t||{}).textureStoreOpts||{},i=t.layerOpts||{},o=t.source,s=t.geometry,a=this._view,h=this._viewer.stage(),l=new n(s,o,h,e),u=new r(o,s,a,l,i);return this._layers.push(u),t.pinFirstLevel&&u.pinFirstLevel(),this.emit("layerChange"),u},p.prototype.destroyLayer=function(t){var e=this._layers.indexOf(t);if(e<0)throw new Error("No such layer in scene");this._layers.splice(e,1),this.emit("layerChange"),t.textureStore().destroy(),t.destroy()},p.prototype.destroyAllLayers=function(){for(;this._layers.length>0;)this.destroyLayer(this._layers[0])},p.prototype.switchTo=function(t,e){return this._viewer.switchScene(this,t,e)},p.prototype.lookTo=function(t,e,i){if(e=e||{},i=i||h,"object"!==l(t))throw new Error("Target view parameters must be an object");var r=null!=e.transitionDuration?e.transitionDuration:1e3,n=null==e.shortest||e.shortest,o=this._view,s=o.parameters(),a={};u(a,t),u(a,s),n&&o.normalizeToClosest&&o.normalizeToClosest(a,a);var c=this._viewer.controls().enabled();this._viewer.controls().disable(),this.startMovement(function(){var t=!1;return function(e,i){if(i>=r&&t)return null;var n,o=Math.min(i/r,1);for(var h in e){var l=s[h],u=a[h];e[h]=l+(n=o,((n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1))*(u-l))}return t=i>=r,e}},function(){c&&this._viewer.controls().enable(),i()})},p.prototype.startMovement=function(t,e){var i=this._viewer.renderLoop();this._movement&&this.stopMovement();var r=t();if("function"!=typeof r)throw new Error("Bad movement");this._movement=t,this._movementStep=r,this._movementStartTime=a(),this._movementParams={},this._movementCallback=e,i.addEventListener("beforeRender",this._updateMovementHandler),i.renderOnNextFrame()},p.prototype.stopMovement=function(){var t=this._viewer.renderLoop();this._movementCallback&&this._movementCallback(),t.removeEventListener("beforeRender",this._updateMovementHandler),this._movement=null,this._movementStep=null,this._movementStartTime=null,this._movementParams=null,this._movementCallback=null},p.prototype.movement=function(){return this._movement},p.prototype._updateMovement=function(){if(!this._movement)throw new Error("Should not call update");var t=this._viewer.renderLoop(),e=this._view,i=a()-this._movementStartTime,r=this._movementStep,n=this._movementParams;null==(n=r(n=e.parameters(n),i))?this.stopMovement():(e.setParameters(n),t.renderOnNextFrame())},p.prototype._updateHotspotContainer=function(){this.visible()?this._hotspotContainer.show():this._hotspotContainer.hide()},t.exports=p},function(t,e,i){"use strict";var r=i(16),n=i(191),o=i(147),s=i(249),a=i(192),h=i(9).setAbsolute,l=i(9).setOverflowHidden,u=i(9).setOverflowVisible,c=i(9).setNullSize,p=i(9).setPixelSize,f=i(9).setWithVendorPrefix("pointer-events"),d=i(6);function m(t,e,i,r,n){n=n||{},this._parentDomElement=t,this._stage=e,this._view=i,this._renderLoop=r,this._hotspots=[],this._visible=!0,this._rect=n.rect,this._visibilityOrRectChanged=!0,this._stageWidth=null,this._stageHeight=null,this._tmpRect={},this._hotspotContainerWrapper=document.createElement("div"),h(this._hotspotContainerWrapper),f(this._hotspotContainerWrapper,"none"),this._parentDomElement.appendChild(this._hotspotContainerWrapper),this._hotspotContainer=document.createElement("div"),h(this._hotspotContainer),f(this._hotspotContainer,"all"),this._hotspotContainerWrapper.appendChild(this._hotspotContainer),this._updateHandler=this._update.bind(this),this._renderLoop.addEventListener("afterRender",this._updateHandler)}r(m),m.prototype.destroy=function(){for(;this._hotspots.length;)this.destroyHotspot(this._hotspots[0]);this._parentDomElement.removeChild(this._hotspotContainerWrapper),this._renderLoop.removeEventListener("afterRender",this._updateHandler),d(this)},m.prototype.domElement=function(){return this._hotspotContainer},m.prototype.setRect=function(t){t&&!s()&&"undefined"!=typeof console&&console.warn("Using a rect effect is not fully supported on this browser. Hotspots may not be shown."),this._rect=t,this._visibilityOrRectChanged=!0},m.prototype.rect=function(){return this._rect},m.prototype.createHotspot=function(t,e,i){e=e||{};var r=new n(t,this._hotspotContainer,this._view,e,i);return this._hotspots.push(r),r._update(),this.emit("hotspotsChange"),r},m.prototype.hasHotspot=function(t){return this._hotspots.indexOf(t)>=0},m.prototype.listHotspots=function(){return[].concat(this._hotspots)},m.prototype.destroyHotspot=function(t){var e=this._hotspots.indexOf(t);if(e<0)throw new Error("No such hotspot");this._hotspots.splice(e,1),t.destroy(),this.emit("hotspotsChange")},m.prototype.hide=function(){this._visible&&(this._visible=!1,this._visibilityOrRectChanged=!0,this._update())},m.prototype.show=function(){this._visible||(this._visible=!0,this._visibilityOrRectChanged=!0,this._update())},m.prototype._update=function(){var t=this._hotspotContainerWrapper,e=this._stage.width(),i=this._stage.height(),r=this._tmpRect;if(this._visibilityOrRectChanged||this._rect&&(e!==this._stageWidth||i!==this._stageHeight)){var n=this._visible&&!(this._rect&&!s());t.style.display=n?"block":"none",n&&(this._rect?(o(e,i,this._rect,r),a(t,e*r.x,i*r.y),p(t,e*r.width,i*r.height),l(t)):(a(t,0,0),c(t),u(t))),this._stageWidth=e,this._stageHeight=i,this._visibilityOrRectChanged=!1}for(var h=0;h<this._hotspots.length;h++)this._hotspots[h]._update()},t.exports=m},function(t,e,i){"use strict";var r=i(16),n=i(127),o=i(192),s=i(9).setTransform,a=i(6);function h(t,e,i,r,o){if((o=o||{}).perspective=o.perspective||{},o.perspective.extraRotations=null!=o.perspective.extraRotations?o.perspective.extraRotations:"",o.perspective.radius&&!n())throw new Error("Embedded hotspots are not supported on this browser");this._domElement=t,this._parentDomElement=e,this._view=i,this._params={},this._perspective={},this.setPosition(r),this._parentDomElement.appendChild(this._domElement),this.setPerspective(o.perspective),this._visible=!0,this._position={x:0,y:0}}r(h),h.prototype.destroy=function(){this._parentDomElement.removeChild(this._domElement),a(this)},h.prototype.domElement=function(){return this._domElement},h.prototype.position=function(){return this._params},h.prototype.setPosition=function(t){for(var e in t)this._params[e]=t[e];this._update()},h.prototype.perspective=function(){return this._perspective},h.prototype.setPerspective=function(t){for(var e in t)this._perspective[e]=t[e];this._update()},h.prototype.show=function(){this._visible||(this._visible=!0,this._update())},h.prototype.hide=function(){this._visible&&(this._visible=!1,this._update())},h.prototype._update=function(){var t,e,i=this._domElement,r=this._params,n=this._position,o=!1;if(this._visible){var s=this._view;this._perspective.radius?(o=!0,this._setEmbeddedPosition(s,r)):(s.coordinatesToScreen(r,n),t=n.x,e=n.y,null!=t&&null!=e&&(o=!0,this._setPosition(t,e)))}o?(i.style.display="block",i.style.position="absolute"):(i.style.display="none",i.style.position="")},h.prototype._setEmbeddedPosition=function(t,e){var i=t.coordinatesToPerspectiveTransform(e,this._perspective.radius,this._perspective.extraRotations);s(this._domElement,i)},h.prototype._setPosition=function(t,e){o(this._domElement,t,e)},t.exports=h},function(t,e,i){"use strict";var r=i(127),n=i(9).setTransform,o=i(9).setPixelPosition,s=i(86);t.exports=function(t,e,i){if(r()){var a="translateX("+s(e)+"px) translateY("+s(i)+"px) translateZ(0)";n(t,a)}else o(t,e,i)}},function(t,e,i){"use strict";var r=i(48),n=i(182),o=i(185),s=i(186),a=i(187),h=i(181),l={mouseViewMode:"drag"};t.exports=function(t,e,i){i=r(i||{},l);var u={mouseViewDrag:new n(e,"mouse"),mouseViewQtvr:new o(e,"mouse"),touchView:new n(e,"touch"),pinch:new a(e,"touch"),leftArrowKey:new h(37,"x",-.7,3),rightArrowKey:new h(39,"x",.7,3),upArrowKey:new h(38,"y",-.7,3),downArrowKey:new h(40,"y",.7,3),plusKey:new h(107,"zoom",-.7,3),minusKey:new h(109,"zoom",.7,3),wKey:new h(87,"y",-.7,3),aKey:new h(65,"x",-.7,3),sKey:new h(83,"y",.7,3),dKey:new h(68,"x",.7,3),qKey:new h(81,"roll",.7,3),eKey:new h(69,"roll",-.7,3)};!1!==i.scrollZoom&&(u.scrollZoom=new s(e));var c={arrowKeys:["leftArrowKey","rightArrowKey","upArrowKey","downArrowKey"],plusMinusKeys:["plusKey","minusKey"],wasdKeys:["wKey","aKey","sKey","dKey"],qeKeys:["qKey","eKey"]},p=["scrollZoom","touchView","pinch"];switch(i.mouseViewMode){case"drag":p.push("mouseViewDrag");break;case"qtvr":p.push("mouseViewQtvr");break;default:throw new Error("Unknown mouse view mode: "+i.mouseViewMode)}for(var f in u){var d=u[f];t.registerMethod(f,d),p.indexOf(f)>=0&&t.enableMethod(f)}for(var m in c){var v=c[m];t.addMethodGroup(m,v)}return u}},function(t,e,i){"use strict";var r=i(69);t.exports=function(t,e,i){var n=!1,o=r();return e(0),requestAnimationFrame(function s(){if(!n){var a=(r()-o)/t;a<1?(e(a),requestAnimationFrame(s)):(e(1),i())}}),function(){n=!0,i.apply(null,arguments)}}},function(t,e,i){var r=i(54),n={create:function(){var t=new r.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat4:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},clone:function(t){var e=new r.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},fromValues:function(t,e,i,n,o,s,a,h,l){var u=new r.ARRAY_TYPE(9);return u[0]=t,u[1]=e,u[2]=i,u[3]=n,u[4]=o,u[5]=s,u[6]=a,u[7]=h,u[8]=l,u},set:function(t,e,i,r,n,o,s,a,h,l){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t[4]=o,t[5]=s,t[6]=a,t[7]=h,t[8]=l,t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},transpose:function(t,e){if(t===e){var i=e[1],r=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=r,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},invert:function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],s=e[4],a=e[5],h=e[6],l=e[7],u=e[8],c=u*s-a*l,p=-u*o+a*h,f=l*o-s*h,d=i*c+r*p+n*f;return d?(d=1/d,t[0]=c*d,t[1]=(-u*r+n*l)*d,t[2]=(a*r-n*s)*d,t[3]=p*d,t[4]=(u*i-n*h)*d,t[5]=(-a*i+n*o)*d,t[6]=f*d,t[7]=(-l*i+r*h)*d,t[8]=(s*i-r*o)*d,t):null},adjoint:function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],s=e[4],a=e[5],h=e[6],l=e[7],u=e[8];return t[0]=s*u-a*l,t[1]=n*l-r*u,t[2]=r*a-n*s,t[3]=a*h-o*u,t[4]=i*u-n*h,t[5]=n*o-i*a,t[6]=o*l-s*h,t[7]=r*h-i*l,t[8]=i*s-r*o,t},determinant:function(t){var e=t[0],i=t[1],r=t[2],n=t[3],o=t[4],s=t[5],a=t[6],h=t[7],l=t[8];return e*(l*o-s*h)+i*(-l*n+s*a)+r*(h*n-o*a)},multiply:function(t,e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=e[4],h=e[5],l=e[6],u=e[7],c=e[8],p=i[0],f=i[1],d=i[2],m=i[3],v=i[4],_=i[5],y=i[6],g=i[7],w=i[8];return t[0]=p*r+f*s+d*l,t[1]=p*n+f*a+d*u,t[2]=p*o+f*h+d*c,t[3]=m*r+v*s+_*l,t[4]=m*n+v*a+_*u,t[5]=m*o+v*h+_*c,t[6]=y*r+g*s+w*l,t[7]=y*n+g*a+w*u,t[8]=y*o+g*h+w*c,t}};n.mul=n.multiply,n.translate=function(t,e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=e[4],h=e[5],l=e[6],u=e[7],c=e[8],p=i[0],f=i[1];return t[0]=r,t[1]=n,t[2]=o,t[3]=s,t[4]=a,t[5]=h,t[6]=p*r+f*s+l,t[7]=p*n+f*a+u,t[8]=p*o+f*h+c,t},n.rotate=function(t,e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=e[4],h=e[5],l=e[6],u=e[7],c=e[8],p=Math.sin(i),f=Math.cos(i);return t[0]=f*r+p*s,t[1]=f*n+p*a,t[2]=f*o+p*h,t[3]=f*s-p*r,t[4]=f*a-p*n,t[5]=f*h-p*o,t[6]=l,t[7]=u,t[8]=c,t},n.scale=function(t,e,i){var r=i[0],n=i[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},n.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},n.fromRotation=function(t,e){var i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=0,t[3]=-i,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},n.fromQuat=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],s=i+i,a=r+r,h=n+n,l=i*s,u=r*s,c=r*a,p=n*s,f=n*a,d=n*h,m=o*s,v=o*a,_=o*h;return t[0]=1-c-d,t[3]=u-_,t[6]=p+v,t[1]=u+_,t[4]=1-l-d,t[7]=f-m,t[2]=p-v,t[5]=f+m,t[8]=1-l-c,t},n.normalFromMat4=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],s=e[4],a=e[5],h=e[6],l=e[7],u=e[8],c=e[9],p=e[10],f=e[11],d=e[12],m=e[13],v=e[14],_=e[15],y=i*a-r*s,g=i*h-n*s,w=i*l-o*s,x=r*h-n*a,M=r*l-o*a,b=n*l-o*h,S=u*m-c*d,E=u*v-p*d,I=u*_-f*d,T=c*v-p*m,D=c*_-f*m,L=p*_-f*v,C=y*L-g*D+w*T+x*I-M*E+b*S;return C?(C=1/C,t[0]=(a*L-h*D+l*T)*C,t[1]=(h*I-s*L-l*E)*C,t[2]=(s*D-a*I+l*S)*C,t[3]=(n*D-r*L-o*T)*C,t[4]=(i*L-n*I+o*E)*C,t[5]=(r*I-i*D-o*S)*C,t[6]=(m*b-v*M+_*x)*C,t[7]=(v*w-d*b-_*g)*C,t[8]=(d*M-m*w+_*y)*C,t):null},n.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},n.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t},n.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t},n.sub=n.subtract,n.multiplyScalar=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t},n.multiplyScalarAndAdd=function(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t[6]=e[6]+i[6]*r,t[7]=e[7]+i[7]*r,t[8]=e[8]+i[8]*r,t},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},n.equals=function(t,e){var i=t[0],n=t[1],o=t[2],s=t[3],a=t[4],h=t[5],l=t[6],u=t[7],c=t[8],p=e[0],f=e[1],d=e[2],m=e[3],v=e[4],_=e[5],y=e[6],g=e[7],w=e[8];return Math.abs(i-p)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(n-f)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(o-d)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(s-m)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(a-v)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(h-_)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(_))&&Math.abs(l-y)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(u-g)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(c-w)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(w))},t.exports=n},,function(t,e,i){var r,n,o;/*! nouislider - 13.1.4 - 3/20/2019 */n=[],void 0===(o="function"==typeof(r=function(){"use strict";var t="13.1.4";function e(t){t.parentElement.removeChild(t)}function i(t){return null!=t}function r(t){t.preventDefault()}function n(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)}function o(t,e,i){i>0&&(l(t,e),setTimeout(function(){u(t,e)},i))}function s(t){return Math.max(Math.min(t,100),0)}function a(t){return Array.isArray(t)?t:[t]}function h(t){var e=(t=String(t)).split(".");return e.length>1?e[1].length:0}function l(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function u(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function c(t){var e=void 0!==window.pageXOffset,i="CSS1Compat"===(t.compatMode||""),r=e?window.pageXOffset:i?t.documentElement.scrollLeft:t.body.scrollLeft,n=e?window.pageYOffset:i?t.documentElement.scrollTop:t.body.scrollTop;return{x:r,y:n}}function p(t,e){return 100/(e-t)}function f(t,e){return 100*e/(t[1]-t[0])}function d(t,e){for(var i=1;t>=e[i];)i+=1;return i}function m(t,e,i){if(i>=t.slice(-1)[0])return 100;var r=d(i,t),n=t[r-1],o=t[r],s=e[r-1],a=e[r];return s+function(t,e){return f(t,t[0]<0?e+Math.abs(t[0]):e-t[0])}([n,o],i)/p(s,a)}function v(t,e,i,r){if(100===r)return r;var n=d(r,t),o=t[n-1],s=t[n];return i?r-o>(s-o)/2?s:o:e[n-1]?t[n-1]+function(t,e){return Math.round(t/e)*e}(r-t[n-1],e[n-1]):r}function _(e,i,r){var o;if("number"==typeof i&&(i=[i]),!Array.isArray(i))throw new Error("noUiSlider ("+t+"): 'range' contains invalid value.");if(!n(o="min"===e?0:"max"===e?100:parseFloat(e))||!n(i[0]))throw new Error("noUiSlider ("+t+"): 'range' value isn't numeric.");r.xPct.push(o),r.xVal.push(i[0]),o?r.xSteps.push(!isNaN(i[1])&&i[1]):isNaN(i[1])||(r.xSteps[0]=i[1]),r.xHighestCompleteStep.push(0)}function y(t,e,i){if(e)if(i.xVal[t]!==i.xVal[t+1]){i.xSteps[t]=f([i.xVal[t],i.xVal[t+1]],e)/p(i.xPct[t],i.xPct[t+1]);var r=(i.xVal[t+1]-i.xVal[t])/i.xNumSteps[t],n=Math.ceil(Number(r.toFixed(3))-1),o=i.xVal[t]+i.xNumSteps[t]*n;i.xHighestCompleteStep[t]=o}else i.xSteps[t]=i.xHighestCompleteStep[t]=i.xVal[t]}function g(t,e,i){var r;this.xPct=[],this.xVal=[],this.xSteps=[i||!1],this.xNumSteps=[!1],this.xHighestCompleteStep=[],this.snap=e;var n=[];for(r in t)t.hasOwnProperty(r)&&n.push([t[r],r]);for(n.length&&"object"==typeof n[0][0]?n.sort(function(t,e){return t[0][0]-e[0][0]}):n.sort(function(t,e){return t[0]-e[0]}),r=0;r<n.length;r++)_(n[r][1],n[r][0],this);for(this.xNumSteps=this.xSteps.slice(0),r=0;r<this.xNumSteps.length;r++)y(r,this.xNumSteps[r],this)}g.prototype.getMargin=function(e){var i=this.xNumSteps[0];if(i&&e/i%1!=0)throw new Error("noUiSlider ("+t+"): 'limit', 'margin' and 'padding' must be divisible by step.");return 2===this.xPct.length&&f(this.xVal,e)},g.prototype.toStepping=function(t){return t=m(this.xVal,this.xPct,t)},g.prototype.fromStepping=function(t){return function(t,e,i){if(i>=100)return t.slice(-1)[0];var r=d(i,e),n=t[r-1],o=t[r],s=e[r-1],a=e[r];return function(t,e){return e*(t[1]-t[0])/100+t[0]}([n,o],(i-s)*p(s,a))}(this.xVal,this.xPct,t)},g.prototype.getStep=function(t){return t=v(this.xPct,this.xSteps,this.snap,t)},g.prototype.getDefaultStep=function(t,e,i){var r=d(t,this.xPct);return(100===t||e&&t===this.xPct[r-1])&&(r=Math.max(r-1,1)),(this.xVal[r]-this.xVal[r-1])/i},g.prototype.getNearbySteps=function(t){var e=d(t,this.xPct);return{stepBefore:{startValue:this.xVal[e-2],step:this.xNumSteps[e-2],highestStep:this.xHighestCompleteStep[e-2]},thisStep:{startValue:this.xVal[e-1],step:this.xNumSteps[e-1],highestStep:this.xHighestCompleteStep[e-1]},stepAfter:{startValue:this.xVal[e],step:this.xNumSteps[e],highestStep:this.xHighestCompleteStep[e]}}},g.prototype.countStepDecimals=function(){var t=this.xNumSteps.map(h);return Math.max.apply(null,t)},g.prototype.convert=function(t){return this.getStep(this.toStepping(t))};var w={to:function(t){return void 0!==t&&t.toFixed(2)},from:Number};function x(e){if(function(t){return"object"==typeof t&&"function"==typeof t.to&&"function"==typeof t.from}(e))return!0;throw new Error("noUiSlider ("+t+"): 'format' requires 'to' and 'from' methods.")}function M(e,i){if(!n(i))throw new Error("noUiSlider ("+t+"): 'step' is not numeric.");e.singleStep=i}function b(e,i){if("object"!=typeof i||Array.isArray(i))throw new Error("noUiSlider ("+t+"): 'range' is not an object.");if(void 0===i.min||void 0===i.max)throw new Error("noUiSlider ("+t+"): Missing 'min' or 'max' in 'range'.");if(i.min===i.max)throw new Error("noUiSlider ("+t+"): 'range' 'min' and 'max' cannot be equal.");e.spectrum=new g(i,e.snap,e.singleStep)}function S(e,i){if(i=a(i),!Array.isArray(i)||!i.length)throw new Error("noUiSlider ("+t+"): 'start' option is incorrect.");e.handles=i.length,e.start=i}function E(e,i){if(e.snap=i,"boolean"!=typeof i)throw new Error("noUiSlider ("+t+"): 'snap' option must be a boolean.")}function I(e,i){if(e.animate=i,"boolean"!=typeof i)throw new Error("noUiSlider ("+t+"): 'animate' option must be a boolean.")}function T(e,i){if(e.animationDuration=i,"number"!=typeof i)throw new Error("noUiSlider ("+t+"): 'animationDuration' option must be a number.")}function D(e,i){var r,n=[!1];if("lower"===i?i=[!0,!1]:"upper"===i&&(i=[!1,!0]),!0===i||!1===i){for(r=1;r<e.handles;r++)n.push(i);n.push(!1)}else{if(!Array.isArray(i)||!i.length||i.length!==e.handles+1)throw new Error("noUiSlider ("+t+"): 'connect' option doesn't match handle count.");n=i}e.connect=n}function L(e,i){switch(i){case"horizontal":e.ort=0;break;case"vertical":e.ort=1;break;default:throw new Error("noUiSlider ("+t+"): 'orientation' option is invalid.")}}function C(e,i){if(!n(i))throw new Error("noUiSlider ("+t+"): 'margin' option must be numeric.");if(0!==i&&(e.margin=e.spectrum.getMargin(i),!e.margin))throw new Error("noUiSlider ("+t+"): 'margin' option is only supported on linear sliders.")}function F(e,i){if(!n(i))throw new Error("noUiSlider ("+t+"): 'limit' option must be numeric.");if(e.limit=e.spectrum.getMargin(i),!e.limit||e.handles<2)throw new Error("noUiSlider ("+t+"): 'limit' option is only supported on linear sliders with 2 or more handles.")}function A(e,i){if(!n(i)&&!Array.isArray(i))throw new Error("noUiSlider ("+t+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(i)&&2!==i.length&&!n(i[0])&&!n(i[1]))throw new Error("noUiSlider ("+t+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(0!==i){if(Array.isArray(i)||(i=[i,i]),e.padding=[e.spectrum.getMargin(i[0]),e.spectrum.getMargin(i[1])],!1===e.padding[0]||!1===e.padding[1])throw new Error("noUiSlider ("+t+"): 'padding' option is only supported on linear sliders.");if(e.padding[0]<0||e.padding[1]<0)throw new Error("noUiSlider ("+t+"): 'padding' option must be a positive number(s).");if(e.padding[0]+e.padding[1]>=100)throw new Error("noUiSlider ("+t+"): 'padding' option must not exceed 100% of the range.")}}function z(e,i){switch(i){case"ltr":e.dir=0;break;case"rtl":e.dir=1;break;default:throw new Error("noUiSlider ("+t+"): 'direction' option was not recognized.")}}function P(e,i){if("string"!=typeof i)throw new Error("noUiSlider ("+t+"): 'behaviour' must be a string containing options.");var r=i.indexOf("tap")>=0,n=i.indexOf("drag")>=0,o=i.indexOf("fixed")>=0,s=i.indexOf("snap")>=0,a=i.indexOf("hover")>=0,h=i.indexOf("unconstrained")>=0;if(o){if(2!==e.handles)throw new Error("noUiSlider ("+t+"): 'fixed' behaviour must be used with 2 handles");C(e,e.start[1]-e.start[0])}if(h&&(e.margin||e.limit))throw new Error("noUiSlider ("+t+"): 'unconstrained' behaviour cannot be used with margin or limit");e.events={tap:r||s,drag:n,fixed:o,snap:s,hover:a,unconstrained:h}}function k(e,i){if(!1!==i)if(!0===i){e.tooltips=[];for(var r=0;r<e.handles;r++)e.tooltips.push(!0)}else{if(e.tooltips=a(i),e.tooltips.length!==e.handles)throw new Error("noUiSlider ("+t+"): must pass a formatter for all handles.");e.tooltips.forEach(function(e){if("boolean"!=typeof e&&("object"!=typeof e||"function"!=typeof e.to))throw new Error("noUiSlider ("+t+"): 'tooltips' must be passed a formatter or 'false'.")})}}function R(t,e){t.ariaFormat=e,x(e)}function O(t,e){t.format=e,x(e)}function N(e,i){if(e.keyboardSupport=i,"boolean"!=typeof i)throw new Error("noUiSlider ("+t+"): 'keyboardSupport' option must be a boolean.")}function H(t,e){t.documentElement=e}function q(e,i){if("string"!=typeof i&&!1!==i)throw new Error("noUiSlider ("+t+"): 'cssPrefix' must be a string or `false`.");e.cssPrefix=i}function Y(e,i){if("object"!=typeof i)throw new Error("noUiSlider ("+t+"): 'cssClasses' must be an object.");if("string"==typeof e.cssPrefix)for(var r in e.cssClasses={},i)i.hasOwnProperty(r)&&(e.cssClasses[r]=e.cssPrefix+i[r]);else e.cssClasses=i}function V(e){var r={margin:0,limit:0,padding:0,animate:!0,animationDuration:300,ariaFormat:w,format:w},n={step:{r:!1,t:M},start:{r:!0,t:S},connect:{r:!0,t:D},direction:{r:!0,t:z},snap:{r:!1,t:E},animate:{r:!1,t:I},animationDuration:{r:!1,t:T},range:{r:!0,t:b},orientation:{r:!1,t:L},margin:{r:!1,t:C},limit:{r:!1,t:F},padding:{r:!1,t:A},behaviour:{r:!0,t:P},ariaFormat:{r:!1,t:R},format:{r:!1,t:O},tooltips:{r:!1,t:k},keyboardSupport:{r:!0,t:N},documentElement:{r:!1,t:H},cssPrefix:{r:!0,t:q},cssClasses:{r:!0,t:Y}},o={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:{target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"}};e.format&&!e.ariaFormat&&(e.ariaFormat=e.format),Object.keys(n).forEach(function(s){if(!i(e[s])&&void 0===o[s]){if(n[s].r)throw new Error("noUiSlider ("+t+"): '"+s+"' is required.");return!0}n[s].t(r,i(e[s])?e[s]:o[s])}),r.pips=e.pips;var s=document.createElement("div"),a=void 0!==s.style.msTransform,h=void 0!==s.style.transform;return r.transformRule=h?"transform":a?"msTransform":"webkitTransform",r.style=[["left","top"],["right","bottom"]][r.dir][r.ort],r}function B(i,n,h){var p,f,d,m,v,_,y,g,w=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},x=window.CSS&&CSS.supports&&CSS.supports("touch-action","none"),M=x&&function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){}return t}(),b=i,S=n.spectrum,E=[],I=[],T=[],D=0,L={},C=i.ownerDocument,F=n.documentElement||C.documentElement,A=C.body,z=-1,P=0,k=1,R=2,O="rtl"===C.dir||1===n.ort?0:100;function N(t,e){var i=C.createElement("div");return e&&l(i,e),t.appendChild(i),i}function H(t,e){var i=N(t,n.cssClasses.origin),r=N(i,n.cssClasses.handle);return N(r,n.cssClasses.touchArea),r.setAttribute("data-handle",e),n.keyboardSupport&&(r.setAttribute("tabindex","0"),r.addEventListener("keydown",function(t){return function(t,e){if(B()||X(e))return!1;var i=["Left","Right"],r=["Down","Up"];n.dir&&!n.ort?i.reverse():n.ort&&!n.dir&&r.reverse();var o=t.key.replace("Arrow",""),s=o===r[0]||o===i[0],a=o===r[1]||o===i[1];if(!s&&!a)return!0;t.preventDefault();var h=s?0:1,l=gt(e)[h];return null!==l&&(!1===l&&(l=S.getDefaultStep(I[e],s,10)),l=Math.max(l,1e-7),l*=s?-1:1,_t(e,E[e]+l,!0),!1)}(t,e)})),r.setAttribute("role","slider"),r.setAttribute("aria-orientation",n.ort?"vertical":"horizontal"),0===e?l(r,n.cssClasses.handleLower):e===n.handles-1&&l(r,n.cssClasses.handleUpper),i}function q(t,e){return!!e&&N(t,n.cssClasses.connect)}function Y(t,e){return!!n.tooltips[e]&&N(t.firstChild,n.cssClasses.tooltip)}function B(){return b.hasAttribute("disabled")}function X(t){var e=f[t];return e.hasAttribute("disabled")}function U(){v&&(st("update.tooltips"),v.forEach(function(t){t&&e(t)}),v=null)}function j(){U(),v=f.map(Y),ot("update.tooltips",function(t,e,i){if(v[e]){var r=t[e];!0!==n.tooltips[e]&&(r=n.tooltips[e].to(i[e])),v[e].innerHTML=r}})}function $(t,e,i){var r=C.createElement("div"),o=[];o[P]=n.cssClasses.valueNormal,o[k]=n.cssClasses.valueLarge,o[R]=n.cssClasses.valueSub;var s=[];s[P]=n.cssClasses.markerNormal,s[k]=n.cssClasses.markerLarge,s[R]=n.cssClasses.markerSub;var a=[n.cssClasses.valueHorizontal,n.cssClasses.valueVertical],h=[n.cssClasses.markerHorizontal,n.cssClasses.markerVertical];function u(t,e){var i=e===n.cssClasses.value,r=i?a:h,l=i?o:s;return e+" "+r[n.ort]+" "+l[t]}return l(r,n.cssClasses.pips),l(r,0===n.ort?n.cssClasses.pipsHorizontal:n.cssClasses.pipsVertical),Object.keys(t).forEach(function(o){!function(t,o,s){if((s=e?e(o,s):s)!==z){var a=N(r,!1);a.className=u(s,n.cssClasses.marker),a.style[n.style]=t+"%",s>P&&((a=N(r,!1)).className=u(s,n.cssClasses.value),a.setAttribute("data-value",o),a.style[n.style]=t+"%",a.innerHTML=i.to(o))}}(o,t[o][0],t[o][1])}),r}function W(){m&&(e(m),m=null)}function G(e){W();var i=e.mode,r=e.density||1,n=e.filter||!1,o=e.values||!1,s=e.stepped||!1,a=function(e,i,r){if("range"===e||"steps"===e)return S.xVal;if("count"===e){if(i<2)throw new Error("noUiSlider ("+t+"): 'values' (>= 2) required for mode 'count'.");var n=i-1,o=100/n;for(i=[];n--;)i[n]=n*o;i.push(100),e="positions"}return"positions"===e?i.map(function(t){return S.fromStepping(r?S.getStep(t):t)}):"values"===e?r?i.map(function(t){return S.fromStepping(S.getStep(S.toStepping(t)))}):i:void 0}(i,o,s),h=function(t,e,i){var r,n={},o=S.xVal[0],s=S.xVal[S.xVal.length-1],a=!1,h=!1,l=0;return(r=i.slice().sort(function(t,e){return t-e}),i=r.filter(function(t){return!this[t]&&(this[t]=!0)},{}))[0]!==o&&(i.unshift(o),a=!0),i[i.length-1]!==s&&(i.push(s),h=!0),i.forEach(function(r,o){var s,u,c,p,f,d,m,v,_,y,g=r,w=i[o+1],x="steps"===e;if(x&&(s=S.xNumSteps[o]),s||(s=w-g),!1!==g&&void 0!==w)for(s=Math.max(s,1e-7),u=g;u<=w;u=(u+s).toFixed(7)/1){for(v=(f=(p=S.toStepping(u))-l)/t,y=f/(_=Math.round(v)),c=1;c<=_;c+=1)n[(d=l+c*y).toFixed(5)]=[S.fromStepping(d),0];m=i.indexOf(u)>-1?k:x?R:P,!o&&a&&(m=0),u===w&&h||(n[p.toFixed(5)]=[u,m]),l=p}}),n}(r,i,a),l=e.format||{to:Math.round};return m=b.appendChild($(h,n,l))}function Z(){var t=p.getBoundingClientRect(),e="offset"+["Width","Height"][n.ort];return 0===n.ort?t.width||p[e]:t.height||p[e]}function K(t,e,i,r){var o=function(o){return!!(o=function(t,e,i){var r,n,o=0===t.type.indexOf("touch"),s=0===t.type.indexOf("mouse"),a=0===t.type.indexOf("pointer");if(0===t.type.indexOf("MSPointer")&&(a=!0),o){var h=function(t){return t.target===i||i.contains(t.target)};if("touchstart"===t.type){var l=Array.prototype.filter.call(t.touches,h);if(l.length>1)return!1;r=l[0].pageX,n=l[0].pageY}else{var u=Array.prototype.find.call(t.changedTouches,h);if(!u)return!1;r=u.pageX,n=u.pageY}}return e=e||c(C),(s||a)&&(r=t.clientX+e.x,n=t.clientY+e.y),t.pageOffset=e,t.points=[r,n],t.cursor=s||a,t}(o,r.pageOffset,r.target||e))&&!(B()&&!r.doNotReject)&&(s=b,a=n.cssClasses.tap,!((s.classList?s.classList.contains(a):new RegExp("\\b"+a+"\\b").test(s.className))&&!r.doNotReject)&&!(t===w.start&&void 0!==o.buttons&&o.buttons>1)&&(!r.hover||!o.buttons)&&(M||o.preventDefault(),o.calcPoint=o.points[n.ort],void i(o,r)));var s,a},s=[];return t.split(" ").forEach(function(t){e.addEventListener(t,o,!!M&&{passive:!0}),s.push([t,o])}),s}function Q(t){var e,i,r,o,a,h,l=t-(e=p,i=n.ort,r=e.getBoundingClientRect(),o=e.ownerDocument,a=o.documentElement,h=c(o),/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(h.x=0),i?r.top+h.y-a.clientTop:r.left+h.x-a.clientLeft),u=100*l/Z();return u=s(u),n.dir?100-u:u}function J(t,e){"mouseout"===t.type&&"HTML"===t.target.nodeName&&null===t.relatedTarget&&et(t,e)}function tt(t,e){if(-1===navigator.appVersion.indexOf("MSIE 9")&&0===t.buttons&&0!==e.buttonsProperty)return et(t,e);var i=(n.dir?-1:1)*(t.calcPoint-e.startCalcPoint),r=100*i/e.baseSize;ut(i>0,r,e.locations,e.handleNumbers)}function et(t,e){e.handle&&(u(e.handle,n.cssClasses.active),D-=1),e.listeners.forEach(function(t){F.removeEventListener(t[0],t[1])}),0===D&&(u(b,n.cssClasses.drag),pt(),t.cursor&&(A.style.cursor="",A.removeEventListener("selectstart",r))),e.handleNumbers.forEach(function(t){at("change",t),at("set",t),at("end",t)})}function it(t,e){if(e.handleNumbers.some(X))return!1;var i;if(1===e.handleNumbers.length){var o=f[e.handleNumbers[0]];i=o.children[0],D+=1,l(i,n.cssClasses.active)}t.stopPropagation();var s=[],a=K(w.move,F,tt,{target:t.target,handle:i,listeners:s,startCalcPoint:t.calcPoint,baseSize:Z(),pageOffset:t.pageOffset,handleNumbers:e.handleNumbers,buttonsProperty:t.buttons,locations:I.slice()}),h=K(w.end,F,et,{target:t.target,handle:i,listeners:s,doNotReject:!0,handleNumbers:e.handleNumbers}),u=K("mouseout",F,J,{target:t.target,handle:i,listeners:s,doNotReject:!0,handleNumbers:e.handleNumbers});s.push.apply(s,a.concat(h,u)),t.cursor&&(A.style.cursor=getComputedStyle(t.target).cursor,f.length>1&&l(b,n.cssClasses.drag),A.addEventListener("selectstart",r,!1)),e.handleNumbers.forEach(function(t){at("start",t)})}function rt(t){t.stopPropagation();var e=Q(t.calcPoint),i=function(t){var e=100,i=!1;return f.forEach(function(r,n){if(!X(n)){var o=Math.abs(I[n]-t);(o<e||100===o&&100===e)&&(i=n,e=o)}}),i}(e);if(!1===i)return!1;n.events.snap||o(b,n.cssClasses.tap,n.animationDuration),ft(i,e,!0,!0),pt(),at("slide",i,!0),at("update",i,!0),at("change",i,!0),at("set",i,!0),n.events.snap&&it(t,{handleNumbers:[i]})}function nt(t){var e=Q(t.calcPoint),i=S.getStep(e),r=S.fromStepping(i);Object.keys(L).forEach(function(t){"hover"===t.split(".")[0]&&L[t].forEach(function(t){t.call(_,r)})})}function ot(t,e){L[t]=L[t]||[],L[t].push(e),"update"===t.split(".")[0]&&f.forEach(function(t,e){at("update",e)})}function st(t){var e=t&&t.split(".")[0],i=e&&t.substring(e.length);Object.keys(L).forEach(function(t){var r=t.split(".")[0],n=t.substring(r.length);e&&e!==r||i&&i!==n||delete L[t]})}function at(t,e,i){Object.keys(L).forEach(function(r){var o=r.split(".")[0];t===o&&L[r].forEach(function(t){t.call(_,E.map(n.format.to),e,E.slice(),i||!1,I.slice())})})}function ht(t,e,i,r,o,a){return f.length>1&&!n.events.unconstrained&&(r&&e>0&&(i=Math.max(i,t[e-1]+n.margin)),o&&e<f.length-1&&(i=Math.min(i,t[e+1]-n.margin))),f.length>1&&n.limit&&(r&&e>0&&(i=Math.min(i,t[e-1]+n.limit)),o&&e<f.length-1&&(i=Math.max(i,t[e+1]-n.limit))),n.padding&&(0===e&&(i=Math.max(i,n.padding[0])),e===f.length-1&&(i=Math.min(i,100-n.padding[1]))),!((i=s(i=S.getStep(i)))===t[e]&&!a)&&i}function lt(t,e){var i=n.ort;return(i?e:t)+", "+(i?t:e)}function ut(t,e,i,r){var n=i.slice(),o=[!t,t],s=[t,!t];r=r.slice(),t&&r.reverse(),r.length>1?r.forEach(function(t,i){var r=ht(n,t,n[t]+e,o[i],s[i],!1);!1===r?e=0:(e=r-n[t],n[t]=r)}):o=s=[!0];var a=!1;r.forEach(function(t,r){a=ft(t,i[t]+e,o[r],s[r])||a}),a&&r.forEach(function(t){at("update",t),at("slide",t)})}function ct(t,e){return n.dir?100-t-e:t}function pt(){T.forEach(function(t){var e=I[t]>50?-1:1,i=3+(f.length+e*t);f[t].style.zIndex=i})}function ft(t,e,i,r){return!1!==(e=ht(I,t,e,i,r,!1))&&(function(t,e){I[t]=e,E[t]=S.fromStepping(e);var i="translate("+lt(ct(e,0)-O+"%","0")+")";f[t].style[n.transformRule]=i,dt(t),dt(t+1)}(t,e),!0)}function dt(t){if(d[t]){var e=0,i=100;0!==t&&(e=I[t-1]),t!==d.length-1&&(i=I[t]);var r=i-e,o="translate("+lt(ct(e,r)+"%","0")+")",s="scale("+lt(r/100,"1")+")";d[t].style[n.transformRule]=o+" "+s}}function mt(t,e){return null===t||!1===t||void 0===t?I[e]:("number"==typeof t&&(t=String(t)),t=n.format.from(t),!1===(t=S.toStepping(t))||isNaN(t)?I[e]:t)}function vt(t,e){var i=a(t),r=void 0===I[0];e=void 0===e||!!e,n.animate&&!r&&o(b,n.cssClasses.tap,n.animationDuration),T.forEach(function(t){ft(t,mt(i[t],t),!0,!1)}),T.forEach(function(t){ft(t,I[t],!0,!0)}),pt(),T.forEach(function(t){at("update",t),null!==i[t]&&e&&at("set",t)})}function _t(e,i,r){if(!((e=Number(e))>=0&&e<T.length))throw new Error("noUiSlider ("+t+"): invalid handle number, got: "+e);ft(e,mt(i,e),!0,!0),at("update",e),r&&at("set",e)}function yt(){var t=E.map(n.format.to);return 1===t.length?t[0]:t}function gt(t){var e=I[t],i=S.getNearbySteps(e),r=E[t],o=i.thisStep.step,s=null;if(n.snap)return[r-i.stepBefore.startValue||null,i.stepAfter.startValue-r||null];!1!==o&&r+o>i.stepAfter.startValue&&(o=i.stepAfter.startValue-r),s=r>i.thisStep.startValue?i.thisStep.step:!1!==i.stepBefore.step&&r-i.stepBefore.highestStep,100===e?o=null:0===e&&(s=null);var a=S.countStepDecimals();return null!==o&&!1!==o&&(o=Number(o.toFixed(a))),null!==s&&!1!==s&&(s=Number(s.toFixed(a))),[s,o]}return l(g=b,n.cssClasses.target),0===n.dir?l(g,n.cssClasses.ltr):l(g,n.cssClasses.rtl),0===n.ort?l(g,n.cssClasses.horizontal):l(g,n.cssClasses.vertical),p=N(g,n.cssClasses.base),function(t,e){var i=N(e,n.cssClasses.connects);f=[],(d=[]).push(q(i,t[0]));for(var r=0;r<n.handles;r++)f.push(H(e,r)),T[r]=r,d.push(q(i,t[r+1]))}(n.connect,p),(y=n.events).fixed||f.forEach(function(t,e){K(w.start,t.children[0],it,{handleNumbers:[e]})}),y.tap&&K(w.start,p,rt,{}),y.hover&&K(w.move,p,nt,{hover:!0}),y.drag&&d.forEach(function(t,e){if(!1!==t&&0!==e&&e!==d.length-1){var i=f[e-1],r=f[e],o=[t];l(t,n.cssClasses.draggable),y.fixed&&(o.push(i.children[0]),o.push(r.children[0])),o.forEach(function(t){K(w.start,t,it,{handles:[i,r],handleNumbers:[e-1,e]})})}}),vt(n.start),n.pips&&G(n.pips),n.tooltips&&j(),ot("update",function(t,e,i,r,o){T.forEach(function(t){var e=f[t],r=ht(I,t,0,!0,!0,!0),s=ht(I,t,100,!0,!0,!0),a=o[t],h=n.ariaFormat.to(i[t]);r=S.fromStepping(r).toFixed(1),s=S.fromStepping(s).toFixed(1),a=S.fromStepping(a).toFixed(1),e.children[0].setAttribute("aria-valuemin",r),e.children[0].setAttribute("aria-valuemax",s),e.children[0].setAttribute("aria-valuenow",a),e.children[0].setAttribute("aria-valuetext",h)})}),_={destroy:function(){for(var t in n.cssClasses)n.cssClasses.hasOwnProperty(t)&&u(b,n.cssClasses[t]);for(;b.firstChild;)b.removeChild(b.firstChild);delete b.noUiSlider},steps:function(){return T.map(gt)},on:ot,off:st,get:yt,set:vt,setHandle:_t,reset:function(t){vt(n.start,t)},__moveHandles:function(t,e,i){ut(t,e,I,i)},options:h,updateOptions:function(t,e){var i=yt(),r=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips"];r.forEach(function(e){void 0!==t[e]&&(h[e]=t[e])});var o=V(h);r.forEach(function(e){void 0!==t[e]&&(n[e]=o[e])}),S=o.spectrum,n.margin=o.margin,n.limit=o.limit,n.padding=o.padding,n.pips?G(n.pips):W(),n.tooltips?j():U(),I=[],vt(t.start||i,e)},target:b,removePips:W,removeTooltips:U,pips:G}}return{__spectrum:g,version:t,create:function(e,i){if(!e||!e.nodeName)throw new Error("noUiSlider ("+t+"): create requires a single element, got: "+e);if(e.noUiSlider)throw new Error("noUiSlider ("+t+"): Slider was already initialized.");var r=V(i),n=B(e,r,i);return e.noUiSlider=n,n}}})?r.apply(e,n):r)||(t.exports=o)},,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){var r,n,o,s,a,h;
/**
          @@@@@@@@@@@@@@
      @@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@          @@@@@@@@
  @@@@@@@                @@@@@@@
 @@@@@@@                  @@@@@@@
 @@@@@@@                  @@@@@@@
 @@@@@@@@     @          @@@@@@@@
  @@@@@@@@@  @@@       @@@@@@@@@
   @@@@@@@@@@@@@@   @@@@@@@@@@@
     @@@@@@@@@@@@@    @@@@@@@
       @@@@@@@@@@@@     @@@
          @@@@@@
         @@@@
        @@
 *
 * jQuery Reel
 * ===========
 * The 360° plugin for jQuery
 *
 * @license Copyright (c) 2009-2013 Petr Vostrel (http://petr.vostrel.cz/)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * jQuery Reel
 * http://reel360.org
 * Version: 1.3.0
 * Updated: 2013-11-04
 *
 * Requires jQuery 1.6.2 or higher
 */
/**
          @@@@@@@@@@@@@@
      @@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@          @@@@@@@@
  @@@@@@@                @@@@@@@
 @@@@@@@                  @@@@@@@
 @@@@@@@                  @@@@@@@
 @@@@@@@@     @          @@@@@@@@
  @@@@@@@@@  @@@       @@@@@@@@@
   @@@@@@@@@@@@@@   @@@@@@@@@@@
     @@@@@@@@@@@@@    @@@@@@@
       @@@@@@@@@@@@     @@@
          @@@@@@
         @@@@
        @@
 *
 * jQuery Reel
 * ===========
 * The 360° plugin for jQuery
 *
 * @license Copyright (c) 2009-2013 Petr Vostrel (http://petr.vostrel.cz/)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * jQuery Reel
 * http://reel360.org
 * Version: 1.3.0
 * Updated: 2013-11-04
 *
 * Requires jQuery 1.6.2 or higher
 */
s=function(){return jQuery.reel||function(t,e,i,r){if(t){var n=t&&t().jquery.split(/\./);if(!n||+(Ye(n[0])+Ye(n[1])+Ye(n[2]||""))<10602)return Ue("Too old jQuery library. Please upgrade your jQuery to version 1.6.2 or higher");var o,s=t.reel={version:"1.3.0",def:{frame:1,frames:36,loops:!0,clickfree:!1,draggable:!0,scrollable:!0,steppable:!0,throwable:!0,wheelable:!0,orientable:!1,cw:!1,revolution:r,stitched:0,directional:!1,row:1,rows:0,rowlock:!1,framelock:!1,orbital:0,vertical:!1,inversed:!1,footage:6,spacing:0,horizontal:!0,suffix:"-reel",image:r,images:"",path:"",preload:"fidelity",shy:!1,speed:0,delay:0,timeout:2,duration:r,rebound:.5,entry:r,opening:0,brake:.23,velocity:0,tempo:36,laziness:6,cursor:r,hint:"",indicator:0,klass:"",preloader:2,area:r,attr:{},annotations:r,responsive:!1,graph:r,monitor:r},scan:function(){return t(Ce(d)+":not("+Ce(m)+" > "+Ce(d)+")").each(function(e,i){var r=t(i),n=r.data(),o=(n.images=Be(n.images),{});t(Ce(w)+"[data-for="+r.attr(de)+"]").each(function(e,i){var r=t(i),n=r.data(),s=(n.x=Xe(Be(n.x)),n.y=Xe(Be(n.y)),r.attr(de));n.node=r.removeData();o[s]=n}),n.annotations=o,r.removeData().reel(n)})},fn:{reel:function(){var i=arguments,n=t(this),h=n.data(),l=i[0]||{},u=i[1];if("object"!=typeof l)return":"==l.slice(0,1)?n.trigger(l.slice(1),u):1==i.length?h[l]:(u!==r&&(s.normal[l]&&(u=s.normal[l](u,h)),h[l]===r?h[l]=u:h[l]!==u&&n.trigger(l+"Change",[r,h[l]=u])),n);var c=t.extend({},s.def,l),p=n.filter(me).unreel().filter(function(){var e=t(this),i=c.attr,r=i.src||e.attr(Dt),n=i.width||e.attr(nt)||e.width(),o=i.height||e.attr(Yt)||e.height();return r?!(!n||!o)||Ue("Dimension(s) of the target image unknown"):Ue("`src` attribute missing on target image")}),le=[];return p.each(function(){var i,n,o,h=t(this),l=function(t,e){return h.reel(t,e)&&u(t)},u=function(t){return h.data(t)},p={setup:function(e){if(!h.hasClass(d)||!h.parent().hasClass(m)){l(ft,c);var i={src:h.attr(Dt),width:h.attr(Yt)||null,height:h.attr(nt)||null,style:h.attr(Pt)||null,class:h.attr(B)||null},r=h.attr(c.attr).attr(Dt),n=l(de,h.attr(de)||h.attr(de,d+"-"+ +new Date).attr(de)),o=t.extend({},h.data()),_=l(ht,c.images||[]),y=l(Ct,c.stitched),g=!_.length||y,w=l(gt,c.responsive&&(!!f||!g)),x=l(Nt,{}),M=c.loops,S=c.orbital,E=c.revolution,I=c.rows,L=l(J,D(c.footage,c.frames)),C=(l(It,c.spacing),l(Yt,+h.attr(Yt)||h.width())),F=l(nt,+h.attr(nt)||h.height()),A=l(Et,c.shy),k=l(rt,S&&L||I<=1&&_.length||c.frames),X=I>1||S,dt=(l(wt,ze("x",E)||y/2||2*C),l(xt,X?ze("y",E)||(I>3?F:F/(5-I)):0),I=y?1:T(k/L),l(At,y-(M?0:C)),l(Ft,0),He(n+c.suffix)),zt=h.attr(B),Vt=zt?zt+oe:ne,Bt=t(Le(ue),{id:dt.substr(1),class:Vt+oe+m+oe+b+"0"}),Xt=h.wrap(Bt.addClass(c.klass)).addClass(d);le.push(function(t){return s.instances.push(t[0])&&t}(Xt)[0]),Bt=Xt.parent().bind(p.instance);l(at,_.length?ne:c.image||r.replace(s.re.image,"$1"+c.suffix+".$2")),l(q,t(Le(ue),{class:v}).appendTo("body")),l(P,t()),l(Y,[]),l(et,null),l(tt,null),l(Mt,c.row),l(Ot,0),l(St,I),l(bt,c.rowlock),l(it,c.framelock),l(Z,l(K,l(Q,0))),l(N,1/k),l(Lt,dt),l(O,l(Tt,c.speed)<0),l(ut,!1),l(Ht,0),l(qt,c.vertical),l(mt,0),l(G,ke(1,!c.cw&&!y)),l(j,{}),l(U,!1),l($,l(W,0)),l(lt,l(ot,0)),l(_t,!1),l(yt,!1),l(ct,!1),l(H,c.brake),l(V,!!S),l(kt,c.tempo/(s.lazy?c.laziness:1)),l(pt,-1),l(Rt,-1),l(z,c.annotations||Bt.unbind(Ce(z))&&{}),l(vt,1),l(R,{attr:i,data:o}),c.steppable||Bt.unbind("up.steppable"),c.indicator||Bt.unbind(".indicator"),Ge(ne,{overflow:st,position:"relative"}),w||Ge(ne,{width:C,height:F}),w&&t.each(we,function(t,e){x[e]=u(e)}),Ge(se+oe+Ce(d),{display:he}),Ge(Ce(v),{position:"fixed",left:Ne(-100),top:Ne(-100)},!0),Ge(Ce(v)+oe+me,{position:ae,width:10,height:10},!0),a.bind(p.pool),h.trigger(A?"prepare":"setup")}},instance:{teardown:function(i){var r,l=h.data(R);h.parent().unbind(p.instance),u(Et)?h.parent().unbind(X,Te):u(Pt).remove()&&u(P).unbind(Vt),u(q).empty(),clearTimeout(n),clearTimeout(o),t(e).unbind(re,ri),t(e).unbind(Vt),a.unbind(p.pool),hi.unbind(Bt),h.siblings().unbind(Vt).remove(),ti(),h.removeAttr("onloaded"),r=h.unbind(Vt).removeData().unwrap().attr(l.attr).data(l.data),s.instances=s.instances.not(He(r.attr(de))),h.attr(Pt)==ne&&h.removeAttr(Pt)},setup:function(i){var n=h.parent().append($e()),o=l(P,t(c.area||n)),s=c.rows>1,a=c.cursor,p=a==ce?Se:a||be,f=a==ce?Ee+oe+"!important":r;function m(t){return h.trigger("down",[Re(t).clientX,Re(t).clientY,t])&&t.give}Ge(oe+Ce(d),{MozUserSelect:_e,WebkitUserSelect:_e,MozTransform:"translateZ(0)"}),h.unbind(X,Te),o.bind(ee,m).bind(c.clickfree?$t:jt,m).bind(c.wheelable?Kt:null,function(t,e){return!e||h.trigger("wheel",[e,t])&&t.give}).bind(Ut,function(){return!1}),Ge(ne,{cursor:Fe(p)}),Ge(Ce(M),{cursor:"wait"}),Ge(Ce(x)+se+Ce(x)+" *",{cursor:Fe(f||p)},!0),u(gt)&&(Ge(oe+Ce(d),{width:"100%",height:k}),t(e).bind(re,ri)),c.hint&&o.attr("title",c.hint),c.indicator&&n.append(We("x")),s&&c.indicator&&n.append(We("y")),c.monitor&&n.append(je=t(Le(ue),{class:g}))&&Ge(oe+Ce(g),{position:ae,left:0,top:0})},preload:function(e){var i=h.parent(),r=u(ht),n=!r.length,o=s.preload[c.preload]||s.preload[s.def.preload],a=n?[u(at)]:o(r.slice(0),c,u),p=(a.length,l(mt,n?.5:0),0),f=u(q).empty(),d=[];for(i.addClass(M),l(Pt,u(Pt)||t("<"+Pt+' type="text/css">'+Ge.rules.join("\n")+"</"+Pt+">").prependTo(pe)),l(ut,!0),h.trigger("stop"),c.responsive&&ni(),h.trigger("resize",!0);a.length;){var m=s.substitute(c.path+a.shift(),u);t(Le(me)).data(Dt,m).appendTo(f).bind("load error abort",function(t){return"load"!=t.type&&h.trigger(t.type),!!i.parents(fe).length&&h.trigger("preloaded")&&v()&&!1}),d.push(m)}function v(){var t=f.children(":not([src]):first");return t.attr(Dt,t.data(Dt))}setTimeout(function(){for(;++p<s.concurrent_requests;)v()},0),l(Y,d),l(Et,!1)},preloaded:function(t){var e=u(ht).length||1,i=l(mt,D(u(mt)+1,e));if(1===i)h.trigger("frameChange",[r,u(et)]);i===e&&(h.parent().removeClass(M),h.trigger("loaded"))},loaded:function(t){u(ht).length>1||h.css({backgroundImage:Ae(s.substitute(c.path+u(at),u))}).attr({src:Fe(Me)}),u(Ct)&&h.attr({src:Fe(Me)}),u(yt)||l(Ht,c.velocity||0),l(ut,!1),ve=!0},prepare:function(t){h.css("display",he).parent().one(X,Te)},opening:function(t){if(!c.opening)return h.trigger("openingDone");l(ct,!0),l(zt,!u(Tt));var e=c.entry||c.speed,i=u(tt),r=c.opening;l(tt,i-e*r),l(pt,T(r*De(kt)))},openingDone:function(i){l(dt,!1),l(ct,!1);var r=Qt+Ce(ct);a.unbind(r,p.pool[r]),c.orientable&&t(e).bind(Xt,function(t){return h.trigger("orient",[Oe(t).alpha,Oe(t).beta,Oe(t).gamma,t])&&t.give}),c.delay>0?n=setTimeout(function(){h.trigger("play")},1e3*c.delay):h.trigger("play")},play:function(t,e){e=e?l(Tt,e):u(Tt)*ke(1,u(O));var i=c.duration,r=(i&&l(Rt,T(i*De(kt))),l(O,e<0),l(dt,!!e));l(zt,!r);qe()},reach:function(t,e,i){if(e!=u(et)){var r=u(rt),n=(l(Mt,T(e/r)),l(Z,u(et))),o=(e=l(K,e),l(Q,s.math.distance(n,e,r)));i=C(i||u(Tt))*ke(1,o<0);h.trigger("play",i)}},pause:function(t){Ye()},stop:function(t){var e=l(zt,!0);l(dt,!e)},down:function(e,i,n,o){if((c.clickfree||!o||o.button===r||o.button==Ie)&&c.draggable){l(U,u(et));var s=c.clickfree,a=(l(Ht,0),s?u(P):hi);Qe=oi(u(wt),i,n);Ye(),ti(),Be=0,t(fe,hi).addClass(x),a.bind(ie+oe+Gt,function(t){return h.trigger("pan",[Re(t).clientX,Re(t).clientY,t])&&t.give}).bind(te+oe+Jt,p).bind(s?Wt:Zt,p)}function p(t){return h.trigger("up",[t])&&t.give}},up:function(e,i){l(U,!1),l(_t,!1);var r=c.throwable,n=C(ei[0]+ei[1])/60,o=l(Ht,r?!0===r?n:D(r,n):0);Pe=o?1:0;Ye(),ti(),t(fe,hi).removeClass(x),(c.clickfree?u(P):hi).unbind(Bt)},pan:function(t,e,i,r){if(c.draggable&&si){si=!1,Ye();var n=c.rows,o=c.orbital,a=!u(_t)&&n<=1&&!o&&c.scrollable,h={x:e-Qe.x,y:i-Qe.y},p={x:C(h.x),y:C(h.y)};if(r&&a&&p.x<p.y)return r.give=!0;if(p.x>0||p.y>0){r&&(r.give=!1),Be=L(p.x,p.y),Qe={x:e,y:i};var f=u(wt),d=u(j),m=u(qt);if(!u(it)){var v=l(tt,ii(m?i-d.y:e-d.x,u($),f,u(lt),u(ot),u(G),m?i-d.y:e-d.x)),_=(l(_t,u(_t)||u(et)!=u(U)),Je(m?h.y:h.x||0));_&&l(O,_<0)}if(o&&u(V))m=l(qt,C(i-d.y)>C(e-d.x)),d=oi(f,e,i);if(n>1&&!u(bt)){var y=u(xt),g=u(W),w=-g*y;l(Ot,s.math.envelope(i-d.y,g,y,w,w+y,-1))}if(!(v%1||c.loops))d=oi(f,e,i)}}},wheel:function(t,e,i){if(e){Xe=!0;var r=ke(r=T(S.sqrt(C(e))/2),e>0),n=.0833*u(wt);oi(n),r&&l(O,r<0),l(Ht,0),l(tt,ii(r,u($),n,u(lt),u(ot),u(G)));i&&i.preventDefault(),i&&(i.give=!1),Ye(),h.trigger("up",[i])}},orient:function(t,e,r,n,o){if(si&&!i){Ue=!0;var s=e/360;fraction=l(tt,+(c.stitched||c.cw?1-s:s).toFixed(2)),si=!1}},fractionChange:function(t,e,i){if(e===r){var n=1+I(i/u(N)),o=c.rows>1,s=c.orbital;l(V,!!s&&(n<=s||n>=u(J)-s+2));if(o)n=n+(u(Mt)-1)*u(rt);n=l(et,n)}},tierChange:function(t,e,i){if(e===r){var n=l(Mt,E(A(i,1,c.rows))),o=u(rt),s=u(et)%o||o;s=l(et,s+n*o-o)}},rowChange:function(t,e,i){if(e===r)ai(Ot,r,i,c.rows)},frameChange:function(t,e,i){if(e===r){this.className=this.className.replace(s.re.frame_klass,b+i);var n=u(rt),o=c.rows,a=c.path,p=i%n||n,f=((i-p)/n+1-1)/(o-1),d=u(Mt),m=(o?ai(Ot,f,d,o):u(Ot),ai(tt,r,p,n)),v=u(J);if(c.orbital&&u(qt))i=(i=c.inversed?v+1-i:i)+v;var _=u(Ct),y=u(ht);if(!y.length||_){var g=u(It),w=u(Yt),x=u(nt);if(_){var M=o<=1?0:(x+g)*(o-d),S=(z=[Ne(-l(Ft,E(A(m,0,u(At)))%_)),Ne(-M)],y.length>1&&y[d-1]),T=s.substitute(a+S,u);S&&h.css("backgroundImage").search(T)<0&&h.css({backgroundImage:Ae(T)})}else var D=c.horizontal,L=(L=i%v-1)<0?v-1:L,C=(I((i-.1)/v)+(o>1?0:u(O)?0:c.directional?u(St):0))*((D?x:w)+g),F=L*((D?w:x)+g),z=y.length?[0,0]:D?[Ne(-F),Ne(-C)]:[Ne(-C),Ne(-F)];h.css({backgroundPosition:z.join(oe)})}else u(gt)&&ni(),u(mt)&&h.attr({src:Ve(s.substitute(a+y[i-1],u))})}},"frameChange.reach":function(t,e,i){if(u(K)&&e===r){var n=s.math.distance(u(Z),i,u(rt));C(n)>=C(u(Q))&&(l(et,l(K)),l(K,l(Q,l(Z,0))),h.trigger("stop"))}},"imageChange imagesChange":function(t,e,i){h.trigger("preload")},"fractionChange.indicator":function(t,e,i){if(c.indicator&&e===r){var n=c.indicator,o=c.orbital,s=o&&u(qt)?u(nt):u(Yt),a=o?u(J):c.images.length||u(rt),h=T(s/a),l=E(A(i,0,s=s-h));l=!c.cw||u(Ct)?l:s-l,We.$x.css(u(qt)?{left:0,top:Ne(l),bottom:k,width:n,height:h}:{bottom:0,left:Ne(l),top:k,width:h,height:n})}},"tierChange.indicator":function(t,e,i){if(c.rows>1&&c.indicator&&e===r){var n=u(nt),o=c.indicator,s=T(n/c.rows),a=E(i*(n=n-s));We.$y.css({left:0,top:a,width:o,height:s})}},"setup.annotations":function(e){var i=h.parent();t.each(u(z),function(e,r){var n=(n=(n=typeof r.node==ge?t(r.node):r.node||{}).jquery?n:t(Le(ue),n)).attr({id:e}).addClass(w),o=r.image?t(Le(me),r.image):t(),s=r.link?t(Le("a"),r.link).click(function(){h.trigger("up.annotations",{target:s})}):t();Ge(He(e),{display:_e,position:ae},!0),r.image||r.link&&n.append(s),r.link||r.image&&n.append(o),r.link&&r.image&&n.append(s.append(o)),n.appendTo(i)})},"prepare.annotations":function(e){t.each(u(z),function(e,i){t(He(e)).hide()})},"frameChange.annotations":function(e,i,n){if(u(mt)&&i===r){var o=u(Yt),s=u(Ct),a=u(Ft);t.each(u(z),function(e,i){var n=t(He(e)),h=i.start||1,l=i.end,c=c||u(et),p=c-1,f=!!i.at&&"+"==i.at[p],d=(p=i.at?p:p-h+1,typeof i.x!=ye?i.x:i.x[p]),m=typeof i.y!=ye?i.y:i.y[p],v=d!==r&&m!==r&&(i.at?f:p>=0&&(!l||p<=l-h));if(s){var _=d>s-o&&a>=0&&a<o;d=d<o&&a>s-o?d+s:d,d=(d=_?d-s:d)-a}if(u(gt)){var y=u(vt);d=d&&d*y,m=m&&m*y}var g={display:v?he:_e,left:Ne(d),top:Ne(m)};n.css(g)})}},"up.annotations":function(e,i){if(!(Be>10||Xe)){var r=t(i.target);(r.is("a")?r:r.parents("a")).attr("href")&&(Be=10)}},"up.steppable":function(t,e){Be||Xe||h.trigger(u(j).x-h.offset().left>.5*u(Yt)?"stepRight":"stepLeft")},"stepLeft stepRight":function(t){Ye()},stepLeft:function(t){l(O,!1),l(tt,u(tt)-u(N)*u(G))},stepRight:function(t){l(O,!0),l(tt,u(tt)+u(N)*u(G))},stepUp:function(t){l(Mt,u(Mt)-1)},stepDown:function(t){l(Mt,u(Mt)+1)},resize:function(t,e){if(!u(ut)||e){var i=u(Ct),n=u(It),o=u(nt),s=!u(ht).length||i,a=c.rows||1,l=u(ht).length?i?Ne(i)+oe+Ne(o):r:i&&Ne(i)+oe+Ne((o+n)*a-n)||Ne((u(Yt)+n)*u(J)-n)+oe+Ne((o+n)*u(St)*a*(c.directional?2:1)-n);h.css({height:s?Ne(o):null,backgroundSize:l||null}),e||h.trigger("imagesChange")}},"setup.fu":function(t){l(et,c.frame+(u(Mt)-1)*u(rt));h.trigger("preload")},"wheel.fu":function(){Xe=!1},"clean.fu":function(){h.trigger("teardown")},"loaded.fu":function(){h.trigger("opening")}},pool:{"tick.reel.preload":function(t){if((ve||u(ut))&&!u(Et)){var e=u(Yt),i=F($e.$.css(Yt)),r=u(ht).length||1,n=E(1/r*u(mt)*e);$e.$.css({width:i+(n-i)/3+1}),u(mt)===r&&i>e-1&&(ve=!1,$e.$.fadeOut(300,function(){$e.$.css({opacity:1,width:0})}))}},"tick.reel":function(t){if(!u(Et)){var e=u(Ht),r=De(kt),n=c.monitor;if(s.intense||!Ze()){if(Pe){var o=e-u(H)/r*Pe;e=l(Ht,o>.1?o:Pe=i=0)}if(n&&je.text(u(n)),e&&Pe++,i&&i++,Je(0),si=!0,i&&!e)return xe(t);if(u(U))return xe(t,Ye());if(!(u(pt)>0)){if(!c.loops&&c.rebound)i||u(tt)%1?Ke=0:Ke++,Ke>=1e3*c.rebound/r&&l(O,!u(O));var a=u(G)*ke(1,u(O)),p=u(Rt),f=(u(dt)&&!Ue&&p?C(u(Tt))+e:e)/De(kt);l(tt,u(tt)-f*a);!(p=c.duration?p>0&&l(Rt,p-1):p)&&u(dt)&&h.trigger("stop")}}}},"tick.reel.opening":function(t){if(u(ct)){var e=(c.entry||c.speed)/De(kt)*(c.cw?-1:1),i=l(pt,u(pt)-1);l(tt,u(tt)+e);i||h.trigger("openingDone")}}}},ve=!1,xe=function(t,e){return t.stopImmediatePropagation()||e},Te=function(){h.trigger("setup")},Pe=0,qe=function(){return i=0},Ye=function(){return clearTimeout(n),a.unbind(Qt+Ce(ct),p.pool[Qt+Ce(ct)]),l(pt,0),l(yt,!0),i=-c.timeout*De(kt)},Be=0,Xe=!1,Ue=!1,je=t(),$e=function(){return Ge(oe+Ce(y),{position:ae,left:0,bottom:0,height:c.preloader,overflow:st,backgroundColor:"#000"}),$e.$=t(Le(ue),{class:y})},We=function(e){return Ge(oe+Ce(_)+Ce(e),{position:ae,width:0,height:0,overflow:st,backgroundColor:"#000"}),We["$"+e]=t(Le(ue),{class:_+oe+e})},Ge=function(e,i,r){var n,o,s=r?ne:u(Lt);e=e.replace(/^/,s).replace(se,se+s);return Ge.rules.push(e+(n=i,o=[],t.each(n,function(t,e){o.push(t.replace(/([A-Z])/g,"-$1").toLowerCase()+":"+Ne(e)+";")}),"{"+o.join(ne)+"}"))&&i},Ze=function(){var i=u(nt),r=u(Yt),n=h[0].getBoundingClientRect();return n.top<-i||n.left<-r||n.right>r+t(e).width()||n.bottom>i+t(e).height()},Ke=0,Qe={x:0,y:0},Je=function(t){return ei.push(t)&&ei.shift()&&t},ti=function(){return ei=[0,0]},ei=ti(),ii=c.graph||s.math[c.loops?"hatch":"envelope"],ri=(s.normal,function(){clearTimeout(o),o=setTimeout(ni,s.resize_gauge)}),ni=function(){if(h.width()!=u(Yt)){var e=u(Nt),i=l(vt,h.width()/e.width);t.each(e,function(t,e){l(t,E(e*i))}),h.trigger("resize")}},oi=function(t,e,i){var n=l($,u(tt)),o=(l(W,u(Ot)),c.loops);l(lt,o?0:-n*t),l(ot,o?t:t-n*t);return e!==r&&l(j,{x:e,y:i})||r},si=!0,ai=function(t,e,i,n){if(n){var o=u(t)||0,s=e!==r?e:(i-1)/(n-1);s=t!=tt?s:D(s,.9999);return e=+C(o-s).toFixed(8)>=+(1/(n-1)).toFixed(8)?l(t,s):e||o}},hi=a;try{a[0]!=top.document&&(hi=a.add(top.document))}catch(t){}var li;top===self?t():t("iframe",hi.last()).each(function(){try{if(t(this).contents().find(pe).html()==t(pe).html())return(li=t(this))&&!1}catch(t){}});Ge.rules=[],p.setup()}),o=o||function t(){var e=+new Date,i=De(kt);return i?(a.trigger(Qt),s.cost=(+new Date+s.cost-e)/2,o=setTimeout(t,L(4,1e3/i-s.cost))):o=null}(),t(le)},unreel:function(){return this.trigger("teardown")}},re:{image:/^(.*)\.(jpg|jpeg|png|gif)\??.*$/i,ua:[/(msie|opera|firefox|chrome|safari)[ \/:]([\d.]+)/i,/(webkit)\/([\d.]+)/i,/(mozilla)\/([\d.]+)/i],array:/ *, */,lazy_agent:/\(iphone|ipod|android|fennec|blackberry/i,frame_klass:/frame-\d+/,substitution:/(@([A-Z]))/g,no_match:/^(undefined|)$/,sequence:/(^[^#|]*([#]+)[^#|]*)($|[|]([0-9]+)\.\.([0-9]+))($|[|]([0-9]+)$)/},cdn:"http://code.vostrel.net/",math:{envelope:function(t,e,i,r,n,o,s){return e+Pe(r,n,-t*o)/i},hatch:function(t,e,i,r,n,o,s){var a=e+-(t=(t<r?n:0)+t%n)*o/i;return a-I(a)},interpolate:function(t,e,i){return e+t*(i-e)},distance:function(t,e,i){var r=i/2,n=e-t;return n<-r?n+i:n>r?n-i:n}},preload:{fidelity:function(t,e,i){var r=e.orbital,n=r?2:e.rows||1,o=i(r?J:rt),s=(e.row-1)*o,a=(new Array).concat(t),h=new Array(t.length+1);return l(n<2?[]:a.slice(s,s+o),1,s).concat(l(a,n,0));function l(t,i,r){if(!t.length)return[];for(var n=[],o=4*i,s=e.frame,a=t.length,l=!0,u=a/o,c=0;c<o;c++)f(s+E(c*u));for(;u>1;){c=0;var p=n.length;for(u=u/2,l=!l;c<p;c++)f(n[c]+(l?1:-1)*E(u))}for(c=0;c<=a;c++)f(c);for(c=0;c<n.length;c++)n[c]=t[n[c]-1];return n;function f(t){for(;!(t>=1&&t<=a);)t+=t<1?+a:-a;return h[r+t]||(h[r+t]=!!n.push(t))}}},linear:function(t,e,i){return t}},substitute:function(t,e){return t.replace(s.re.substitution,function(t,i,r){return"function"==typeof s.substitutes[r]?s.substitutes[r](e):xe[r]?e(xe[r]):i})},substitutes:{T:function(t){return+new Date}},normal:{fraction:function(t,e){return null===t?t:e[ft].loops?t-I(t):Pe(0,1,t)},tier:function(t,e){return null===t?t:Pe(0,1,t)},row:function(t,e){return null===t?t:E(Pe(1,e[ft].rows,t))},frame:function(t,e){if(null===t)return t;var i=e[ft],r=e[rt]*(i.orbital?2:i.rows||1),n=E(i.loops?t%r||r:Pe(1,r,t));return n<0?n+r:n},images:function(t,e){var i=s.re.sequence.exec(t);return i?s.sequence(i,e[ft]):t}},sequence:function(t,e){if(t.length<=1)return e.images;for(var i=[],r=e.orbital,n=t[1],o=t[2],a=t[4],h=(a=s.re.no_match.test(a+ne)?1:+a,r?2:e.rows||1),l=r?e.footage:e.stitched?1:e.frames,u=+(t[5]||h*l)-a,c=+t[7]||1,p=0;p<=u;)i.push(n.replace(o,qe(a+p+ne,o.length,"0"))),p+=c;return i},instances:t(),leader:De,resize_gauge:300,concurrent_requests:4,cost:0},a=t(i),h=navigator.userAgent,l=s.re.ua[0].exec(h)||s.re.ua[1].exec(h)||s.re.ua[2].exec(h),u=+l[2].split(".").slice(0,2).join("."),c="MSIE"==l[1],p=!(c&&u<8),f=!(c&&u<9),d="reel",m=d+"-overlay",v=d+"-cache",_=d+"-indicator",y=d+"-preloader",g=d+"-monitor",w=d+"-annotation",x=d+"-panning",M=d+"-loading",b="frame-",S=Math,E=S.round,I=S.floor,T=S.ceil,D=S.min,L=S.max,C=S.abs,F=parseInt,A=s.math.interpolate,z="annotations",P="area",k="auto",R="backup",O="backwards",N="bit",H="brake",q="cache",Y=q+"d",V="center",B="class",X="click",U=X+"ed",j=U+"_location",$=U+"_on",W=U+"_tier",G="cwish",Z="departure",K="destination",Q="distance",J="footage",tt="fraction",et="frame",it="framelock",rt="frames",nt="height",ot="hi",st="hidden",at="image",ht="images",lt="lo",ut="loading",ct="opening",pt=ct+"_ticks",ft="options",dt="playing",mt="preloaded",vt="ratio",_t="reeling",yt="reeled",gt="responsive",wt="revolution",xt="revolution_y",Mt="row",bt="rowlock",St="rows",Et="shy",It="spacing",Tt="speed",Dt="src",Lt="stage",Ct="stitched",Ft=Ct+"_shift",At=Ct+"_travel",zt="stopped",Pt="style",kt="tempo",Rt="ticks",Ot="tier",Nt="truescale",Ht="velocity",qt="vertical",Yt="width",Vt=Ce(d),Bt=Ce("pan")+Vt,Xt="deviceorientation"+Vt,Ut="dragstart"+Vt,jt="mousedown"+Vt,$t="mouseenter"+Vt,Wt="mouseleave"+Bt,Gt="mousemove"+Bt,Zt="mouseup"+Bt,Kt="mousewheel"+Vt,Qt="tick"+Vt,Jt="touchcancel"+Bt,te="touchend"+Bt,ee="touchstart"+Vt,ie="touchmove"+Bt,re="resize"+Vt,ne="",oe=" ",se=",",ae="absolute",he="block",le="@CDN@",ue="div",ce="hand",pe="head",fe="html",de="id",me="img",ve="jquery."+d,_e="none",ye="object",ge="string",we=[Yt,nt,It,wt,xt,Ct,Ft,At],xe={W:Yt,H:nt},Me=p?"data:image/gif;base64,R0lGODlh"+"CAAIAIAAAAAAAAAAACH5BAEAAAAALAAAAAAIAAgAAAIHhI+py+1dAAA7":le+"blank.gif",be=Ae(le+ve+".cur")+se+"move",Se=Ae(le+ve+"-drag.cur")+se+"move",Ee=Ae(le+ve+"-drag-down.cur")+se+"move",Ie=(s.lazy=s.re.lazy_agent.test(h),c&&u<9?1:0),Te=t.cleanData;t.cleanData=function(e){return t(e).each(function(){t(this).triggerHandler("clean")}),Te.apply(this,arguments)};return t.extend(t.fn,s.fn)&&t(s.scan),s}function De(t){return s.instances.first().data(t)}function Le(t){return"<"+t+"/>"}function Ce(t){return"."+(t||"")}function Fe(t){return t.replace(le,s.cdn)}function Ae(t){return"url('"+Ve(t)+"')"}function ze(t,e){return typeof e==ye?e[t]:e}function Pe(t,e,i){return L(t,D(e,i))}function ke(t,e){return C(t)*(e?-1:1)}function Re(t){return t.touch||t.originalEvent.touches&&t.originalEvent.touches[0]||t}function Oe(t){return t.originalEvent}function Ne(t){return t===r?0:typeof t==ge?t:t+"px"}function He(t){return"#"+t}function qe(t,e,i){for(;t.length<e;)t=i+t;return t}function Ye(t){return qe(t,2,"0")}function Ve(t){return encodeURI(decodeURI(t))}function Be(t){return s.re.array.exec(t)?t.split(s.re.array):t}function Xe(e){return typeof e==ge?e:t.each(e,function(t,i){e[t]=i?+i:r})}function Ue(t){try{console.error("[ Reel ] "+t)}catch(t){}}}(jQuery,window,document)},n=[i(113)],void 0!==(o="function"==typeof(r=s)?r.apply(e,n):r)&&(t.exports=o),h=!(a=!0)&&"object"==typeof t&&"object"==typeof t.exports&&(t.exports=s),!a&&!h&&s()},function(t,e,i){"use strict";function r(){this._renderers={}}r.prototype.set=function(t,e,i){this._renderers[t]||(this._renderers[t]={}),this._renderers[t][e]=i},r.prototype.get=function(t,e){return this._renderers[t]&&this._renderers[t][e]||null},t.exports=r},function(t,e,i){"use strict";var r=i(6);function n(t){this._element=t}n.prototype.dynamic=!1,n.prototype.destroy=function(){r(this)},n.prototype.element=function(){return this._element},n.prototype.width=function(){return this._element.naturalWidth},n.prototype.height=function(){return this._element.naturalHeight},n.prototype.timestamp=function(){return 0},t.exports=n},function(t,e,i){"use strict";var r;t.exports=function(){return void 0!==r?r:(t=document.createElement("canvas"),r=!(!t.getContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl")));var t}},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,i){"use strict";t.exports=function(t){return 0==(t&t-1)}},function(t,e,i){"use strict";var r=i(230),n=i(126),o=i(99);function s(t){if("flash"!==t.type)throw new Error("Stage type incompatible with loader");this._stage=t}s.prototype.loadImage=function(t,e,i){var s=this._stage,a=s.flashElement(),h=e&&e.x||0,l=e&&e.y||0,u=e&&e.width||1,c=e&&e.height||1,p=a.loadImage(t,u,c,h,l);function f(e,o){o===p&&(s.removeFlashCallbackListener("imageLoaded",f),e?i(new n("Network error: "+t)):i(null,new r(a,p)))}return i=o(i),s.addFlashCallbackListener("imageLoaded",f),function(){a.cancelImage(p),s.removeFlashCallbackListener("imageLoaded",f),i.apply(null,arguments)}},t.exports=s},function(t,e,i){"use strict";var r=i(6);function n(t,e){this._flashElement=t,this._imageId=e}n.prototype.dynamic=!1,n.prototype.destroy=function(){this._flashElement.unloadImage(this._imageId),r(this)},n.prototype.element=function(){return this._imageId},n.prototype.width=function(){return 0},n.prototype.height=function(){return 0},n.prototype.timestamp=function(){return 0},t.exports=n},function(t,e,i){"use strict";function r(){var t=function(){var t=null,e=navigator.plugins,i=navigator.mimeTypes,r=null;if(e&&e["Shockwave Flash"]&&i&&i["application/x-shockwave-flash"]&&i["application/x-shockwave-flash"].enabledPlugin)r=(r=e["Shockwave Flash"].description).replace(/^.*\s+(\S+\s+\S+$)/,"$1"),(t=[0,0,0])[0]=parseInt(r.replace(/^(.*)\..*$/,"$1"),10),t[1]=parseInt(r.replace(/^.*\.(.*)\s.*$/,"$1"),10),t[2]=/[a-zA-Z]/.test(r)?parseInt(r.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0;else if(window.ActiveXObject)try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");n&&(r=n.GetVariable("$version"))&&(r=r.split(" ")[1].split(","),t=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)])}catch(t){}return t}();return t&&(t[0]>=11||10===t[0]&&t[1]>=1)}var n;t.exports=function(){return void 0!==n?n:n=r()}},function(t,e,i){"use strict";t.exports=["attribute vec3 aVertexPosition;","attribute vec2 aTextureCoord;","uniform float uDepth;","uniform mat4 uViewportMatrix;","uniform mat4 uProjMatrix;","varying vec2 vTextureCoord;","void main(void) {","  gl_Position = uViewportMatrix * uProjMatrix * vec4(aVertexPosition.xy, 0.0, 1.0);","  gl_Position.z = uDepth * gl_Position.w;","  vTextureCoord = aTextureCoord;","}"].join("\n")},function(t,e,i){"use strict";t.exports=["#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uSampler;","uniform float uOpacity;","uniform vec4 uColorOffset;","uniform mat4 uColorMatrix;","varying vec2 vTextureCoord;","void main(void) {","  vec4 color = texture2D(uSampler, vTextureCoord) * uColorMatrix + uColorOffset;","  gl_FragColor = vec4(color.rgba * uOpacity);","}"].join("\n")},function(t,e,i){"use strict";t.exports=["attribute vec3 aVertexPosition;","uniform float uDepth;","uniform mat4 uViewportMatrix;","uniform mat4 uInvProjMatrix;","varying vec4 vRay;","void main(void) {","  vRay = uInvProjMatrix * vec4(aVertexPosition.xy, 1.0, 1.0);","  gl_Position = uViewportMatrix * vec4(aVertexPosition.xy, uDepth, 1.0);","}"].join("\n")},function(t,e,i){"use strict";t.exports=["#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float","#endif","uniform sampler2D uSampler;","uniform float uOpacity;","uniform float uTextureX;","uniform float uTextureY;","uniform float uTextureWidth;","uniform float uTextureHeight;","uniform vec4 uColorOffset;","uniform mat4 uColorMatrix;","varying vec4 vRay;","const float PI = 3.14159265358979323846264;","void main(void) {","  float r = inversesqrt(vRay.x * vRay.x + vRay.y * vRay.y + vRay.z * vRay.z);","  float phi  = acos(vRay.y * r);","  float theta = atan(vRay.x, -1.0*vRay.z);","  float s = 0.5 + 0.5 * theta / PI;","  float t = 1.0 - phi / PI;","  s = s * uTextureWidth + uTextureX;","  t = t * uTextureHeight + uTextureY;","  vec4 color = texture2D(uSampler, vec2(s, t)) * uColorMatrix + uColorOffset;","  gl_FragColor = vec4(color.rgba * uOpacity);","}"].join("\n")},function(t,e,i){"use strict";var r=i(29),n=i(81),o=i(90),s=i(89),a=i(129),h=i(91);function l(t,e){this.z=t,this._geometry=e,this._level=e.levelList[t]}function u(t){this.constructor.super_.call(this,t),this._width=t.width}function c(t){if("array"!==h(t))throw new Error("Level list must be an array");this.levelList=s.makeLevelList(t,u),this.selectableLevelList=s.makeSelectableLevelList(this.levelList)}l.prototype.rotX=function(){return 0},l.prototype.rotY=function(){return 0},l.prototype.centerX=function(){return.5},l.prototype.centerY=function(){return.5},l.prototype.scaleX=function(){return 1},l.prototype.scaleY=function(){return 1},l.prototype.width=function(){return this._level.tileWidth()},l.prototype.height=function(){return this._level.tileHeight()},l.prototype.levelWidth=function(){return this._level.width()},l.prototype.levelHeight=function(){return this._level.height()},l.prototype.atTopLevel=function(){return 0===this.z},l.prototype.atBottomLevel=function(){return this.z===this._geometry.levelList.length-1},l.prototype.atTopEdge=function(){return!0},l.prototype.atBottomEdge=function(){return!0},l.prototype.atLeftEdge=function(){return!0},l.prototype.atRightEdge=function(){return!0},l.prototype.padTop=function(){return!1},l.prototype.padBottom=function(){return!1},l.prototype.padLeft=function(){return!1},l.prototype.padRight=function(){return!1},l.prototype.parent=function(){return this.atTopLevel()?null:new l(this.z-1,this._geometry)},l.prototype.children=function(t){return this.atBottomLevel()?null:((t=t||[]).push(new l(this.z+1,this._geometry)),t)},l.prototype.neighbors=function(){return[]},l.prototype.hash=function(){return l.hash(this)},l.prototype.equals=function(t){return l.equals(this,t)},l.prototype.cmp=function(t){return l.cmp(this,t)},l.prototype.str=function(){return l.str(this)},l.hash=function(t){return n(t.z)},l.equals=function(t,e){return t.z===e.z},l.cmp=function(t,e){return o(t.z,e.z)},l.str=function(t){return"EquirectTile("+t.z+")"},r(u,a),u.prototype.width=function(){return this._width},u.prototype.height=function(){return this._width/2},u.prototype.tileWidth=function(){return this._width},u.prototype.tileHeight=function(){return this._width/2},c.prototype.maxTileSize=function(){for(var t=0,e=0;e<this.levelList.length;e++){var i=this.levelList[e];t=Math.max(t,i.tileWidth,i.tileHeight)}return t},c.prototype.levelTiles=function(t,e){var i=this.levelList.indexOf(t);return(e=e||[]).push(new l(i,this)),e},c.prototype.visibleTiles=function(t,e,i){var r=new l(this.levelList.indexOf(e),this);(i=i||[]).length=0,i.push(r)},c.TileClass=c.prototype.TileClass=l,c.type=c.prototype.type="equirect",l.type=l.prototype.type="equirect",t.exports=c},function(t,e,i){"use strict";var r=i(16),n=i(59),o=i(84),s=i(100),a=i(173),h=i(164),l=i(85),u=i(131),c=i(83),p=i(86),f=i(174),d=i(6),m=0,v=0,_=0,y=0,g=0,w=Math.PI/4,x=0,M=0;function b(t,e){this._yaw=t&&null!=t.yaw?t.yaw:_,this._pitch=t&&null!=t.pitch?t.pitch:y,this._roll=t&&null!=t.roll?t.roll:g,this._fov=t&&null!=t.fov?t.fov:w,this._width=t&&null!=t.width?t.width:m,this._height=t&&null!=t.height?t.height:v,this._projectionCenterX=t&&null!=t.projectionCenterX?t.projectionCenterX:x,this._projectionCenterY=t&&null!=t.projectionCenterY?t.projectionCenterY:M,this._limiter=e||null,this._projectionMatrix=n.create(),this._projectionChanged=!0,this._viewFrustum=[o.create(),o.create(),o.create(),o.create(),o.create()],this._params={},this._fovs={},this._vertex=o.create(),this._invProj=n.create(),this._update()}r(b),b.prototype.destroy=function(){d(this)},b.prototype.yaw=function(){return this._yaw},b.prototype.pitch=function(){return this._pitch},b.prototype.roll=function(){return this._roll},b.prototype.projectionCenterX=function(){return this._projectionCenterX},b.prototype.projectionCenterY=function(){return this._projectionCenterY},b.prototype.fov=function(){return this._fov},b.prototype.width=function(){return this._width},b.prototype.height=function(){return this._height},b.prototype.size=function(t){return t||(t={}),t.width=this._width,t.height=this._height,t},b.prototype.parameters=function(t){return t||(t={}),t.yaw=this._yaw,t.pitch=this._pitch,t.roll=this._roll,t.fov=this._fov,t},b.prototype.limiter=function(){return this._limiter},b.prototype.setYaw=function(t){this._resetParams(),this._params.yaw=t,this._update(this._params)},b.prototype.setPitch=function(t){this._resetParams(),this._params.pitch=t,this._update(this._params)},b.prototype.setRoll=function(t){this._resetParams(),this._params.roll=t,this._update(this._params)},b.prototype.setFov=function(t){this._resetParams(),this._params.fov=t,this._update(this._params)},b.prototype.setProjectionCenterX=function(t){this._resetParams(),this._params.projectionCenterX=t,this._update(this._params)},b.prototype.setProjectionCenterY=function(t){this._resetParams(),this._params.projectionCenterY=t,this._update(this._params)},b.prototype.offsetYaw=function(t){this.setYaw(this._yaw+t)},b.prototype.offsetPitch=function(t){this.setPitch(this._pitch+t)},b.prototype.offsetRoll=function(t){this.setRoll(this._roll+t)},b.prototype.offsetFov=function(t){this.setFov(this._fov+t)},b.prototype.setSize=function(t){this._resetParams(),this._params.width=t.width,this._params.height=t.height,this._update(this._params)},b.prototype.setParameters=function(t){this._resetParams();var e=this._params;e.yaw=t.yaw,e.pitch=t.pitch,e.roll=t.roll,e.fov=t.fov,e.projectionCenterX=t.projectionCenterX,e.projectionCenterY=t.projectionCenterY,this._update(e)},b.prototype.setLimiter=function(t){this._limiter=t||null,this._update()},b.prototype._resetParams=function(){var t=this._params;t.yaw=null,t.pitch=null,t.roll=null,t.fov=null,t.width=null,t.height=null},b.prototype._update=function(t){null==t&&(this._resetParams(),t=this._params);var e=this._yaw,i=this._pitch,r=this._roll,n=this._fov,o=this._projectionCenterX,s=this._projectionCenterY,a=this._width,h=this._height;if(t.yaw=null!=t.yaw?t.yaw:e,t.pitch=null!=t.pitch?t.pitch:i,t.roll=null!=t.roll?t.roll:r,t.fov=null!=t.fov?t.fov:n,t.width=null!=t.width?t.width:a,t.height=null!=t.height?t.height:h,t.projectionCenterX=null!=t.projectionCenterX?t.projectionCenterX:o,t.projectionCenterY=null!=t.projectionCenterY?t.projectionCenterY:s,this._limiter&&!(t=this._limiter(t)))throw new Error("Bad view limiter");var l=(t=this._normalize(t)).yaw,c=t.pitch,p=t.roll,f=t.fov,d=t.width,m=t.height,v=t.projectionCenterX,_=t.projectionCenterY;if(!(u(l)&&u(c)&&u(p)&&u(f)&&u(d)&&u(m)&&u(v)&&u(_)))throw new Error("Bad view - suspect a broken limiter");this._yaw=l,this._pitch=c,this._roll=p,this._fov=f,this._width=d,this._height=m,this._projectionCenterX=v,this._projectionCenterY=_,l===e&&c===i&&p===r&&f===n&&d===a&&m===h&&v===o&&_===s||(this._projectionChanged=!0,this.emit("change")),d===a&&m===h||this.emit("resize")},b.prototype._normalize=function(t){this._normalizeCoordinates(t);var e=a.htov(Math.PI,t.width,t.height),i=isNaN(e)?Math.PI:Math.min(Math.PI,e);return t.fov=c(t.fov,1e-6,i-1e-6),t},b.prototype._normalizeCoordinates=function(t){return"yaw"in t&&(t.yaw=l(t.yaw-Math.PI,-2*Math.PI)+Math.PI),"pitch"in t&&(t.pitch=l(t.pitch-Math.PI,-2*Math.PI)+Math.PI),"roll"in t&&(t.roll=l(t.roll-Math.PI,-2*Math.PI)+Math.PI),t},b.prototype.normalizeToClosest=function(t,e){var i=this._yaw,r=this._pitch,n=t.yaw,o=t.pitch,s=n-2*Math.PI,a=n+2*Math.PI;Math.abs(s-i)<Math.abs(n-i)?n=s:Math.abs(a-i)<Math.abs(n-i)&&(n=a);var h=o-2*Math.PI,l=o+2*Math.PI;return Math.abs(h-r)<Math.abs(o-r)?o=h:Math.abs(h-r)<Math.abs(o-r)&&(o=l),(e=e||{}).yaw=n,e.pitch=o,e},b.prototype.updateWithControlParameters=function(t){var e=this._fov,i=a.vtoh(e,this._width,this._height);isNaN(i)&&(i=e),this.offsetYaw(t.axisScaledX*i+2*t.x*i+t.yaw),this.offsetPitch(t.axisScaledY*e+2*t.y*i+t.pitch),this.offsetRoll(-t.roll),this.offsetFov(t.zoom*e)},b.prototype.projection=function(){var t=this._projectionMatrix,e=this._viewFrustum;if(this._projectionChanged){var i=this._width,r=this._height,s=this._fov,h=a.vtoh(s,i,r),l=i/r,u=this._projectionCenterX,c=this._projectionCenterY;if(0!==u||0!==c){var p=Math.atan(2*u*Math.tan(h/2)),f=Math.atan(2*c*Math.tan(s/2)),d=this._fovs;d.leftDegrees=180*(h/2+p)/Math.PI,d.rightDegrees=180*(h/2-p)/Math.PI,d.upDegrees=180*(s/2+f)/Math.PI,d.downDegrees=180*(s/2-f)/Math.PI,n.perspectiveFromFieldOfView(t,d,-1,1)}else n.perspective(t,s,l,-1,1);n.rotateZ(t,t,this._roll),n.rotateX(t,t,this._pitch),n.rotateY(t,t,this._yaw),o.set(e[0],t[3]+t[0],t[7]+t[4],t[11]+t[8],0),o.set(e[1],t[3]-t[0],t[7]-t[4],t[11]-t[8],0),o.set(e[2],t[3]+t[1],t[7]+t[5],t[11]+t[9],0),o.set(e[3],t[3]-t[1],t[7]-t[5],t[11]-t[9],0),o.set(e[4],t[3]+t[2],t[7]+t[6],t[11]+t[10],0),this._projectionChanged=!1}return t},b.prototype.intersects=function(t){var e=this._viewFrustum,i=this._vertex;this.projection();for(var r=0;r<e.length;r++){for(var n=e[r],s=!1,a=0;a<t.length;a++){var h=t[a];o.set(i,h[0],h[1],h[2],0),o.dot(n,i)>=0&&(s=!0)}if(!s)return!1}return!0},b.prototype.selectLevel=function(t){for(var e=s()*this._height,i=Math.tan(.5*this._fov),r=0;r<t.length;r++){var n=t[r];if(i*n.height()>=e)return n}return t[t.length-1]},b.prototype.coordinatesToScreen=function(t,e){var i=this._vertex;e||(e={});var r=this._width,n=this._height;if(r<=0||n<=0)return e.x=null,e.y=null,null;var s=t&&null!=t.yaw?t.yaw:_,a=t&&null!=t.pitch?t.pitch:y,l=t&&null!=t.roll?t.roll:g;return o.set(i,0,0,-1,1),h(i,i,-s,-a,-l),o.transformMat4(i,i,this.projection()),i[3]>=0?(e.x=r*(i[0]/i[3]+1)/2,e.y=n*(1-i[1]/i[3])/2,e):(e.x=null,e.y=null,null)},b.prototype.screenToCoordinates=function(t,e){var i=this._vertex,r=this._invProj;e||(e={});var s=this._width,a=this._height;n.invert(r,this.projection());var h=2*t.x/s-1,l=1-2*t.y/a;o.set(i,h,l,1,1),o.transformMat4(i,i,r);var u=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]);return e.yaw=Math.atan2(i[0],-i[2]),e.pitch=Math.acos(i[1]/u)-Math.PI/2,this._normalizeCoordinates(e),e},b.prototype.coordinatesToPerspectiveTransform=function(t,e,i){i=i||"";var r=this._height,n=this._width,o=this._fov,s=.5*r/Math.tan(o/2),a="";return a+="translateX("+p(n/2)+"px) translateY("+p(r/2)+"px) ",a+="translateX(-50%) translateY(-50%) ",a+="perspective("+p(s)+"px) ",a+="translateZ("+p(s)+"px) ",a+="rotateZ("+p(-this._roll)+"rad) ",a+="rotateX("+p(-this._pitch)+"rad) ",a+="rotateY("+p(this._yaw)+"rad) ",a+="rotateY("+p(-t.yaw)+"rad) ",a+="rotateX("+p(t.pitch)+"rad) ",a+="translateZ("+p(-e)+"px) ",a+=i+" "},b.limit={yaw:function(t,e){return function(i){return i.yaw=c(i.yaw,t,e),i}},pitch:function(t,e){return function(i){return i.pitch=c(i.pitch,t,e),i}},roll:function(t,e){return function(i){return i.roll=c(i.roll,t,e),i}},hfov:function(t,e){return function(i){var r=i.width,n=i.height;if(r>0&&n>0){var o=a.htov(t,r,n),s=a.htov(e,r,n);i.fov=c(i.fov,o,s)}return i}},vfov:function(t,e){return function(i){return i.fov=c(i.fov,t,e),i}},resolution:function(t){return function(e){var i=e.height;if(i){var r=s()*i,n=2*Math.atan(r/t);e.fov=c(e.fov,n,1/0)}return e}},traditional:function(t,e,i){return i=null!=i?i:e,f(b.limit.resolution(t),b.limit.vfov(0,e),b.limit.hfov(0,i),b.limit.pitch(-Math.PI/2,Math.PI/2))}},b.type=b.prototype.type="rectilinear",t.exports=b},function(t,e,i){"use strict";var r=i(16),n=i(59),o=i(84),s=i(100),a=i(131),h=i(83),l=i(6),u=0,c=0,p=.5,f=.5,d=1,m=[1,0,1,0],v=[-1,-1,1,1];function _(t,e){if(!t||null==t.mediaAspectRatio)throw new Error("mediaAspectRatio must be defined");this._x=t&&null!=t.x?t.x:p,this._y=t&&null!=t.y?t.y:f,this._zoom=t&&null!=t.zoom?t.zoom:d,this._mediaAspectRatio=t.mediaAspectRatio,this._width=t&&null!=t.width?t.width:u,this._height=t&&null!=t.height?t.height:c,this._limiter=e||null,this._viewFrustum=[0,0,0,0],this._projectionMatrix=n.create(),this._projectionChanged=!0,this._params={},this._vertex=o.create(),this._invProj=n.create(),this._update()}r(_),_.prototype.destroy=function(){l(this)},_.prototype.x=function(){return this._x},_.prototype.y=function(){return this._y},_.prototype.zoom=function(){return this._zoom},_.prototype.mediaAspectRatio=function(){return this._mediaAspectRatio},_.prototype.width=function(){return this._width},_.prototype.height=function(){return this._height},_.prototype.size=function(t){return(t=t||{}).width=this._width,t.height=this._height,t},_.prototype.parameters=function(t){return(t=t||{}).x=this._x,t.y=this._y,t.zoom=this._zoom,t.mediaAspectRatio=this._mediaAspectRatio,t},_.prototype.limiter=function(){return this._limiter},_.prototype.setX=function(t){this._resetParams(),this._params.x=t,this._update(this._params)},_.prototype.setY=function(t){this._resetParams(),this._params.y=t,this._update(this._params)},_.prototype.setZoom=function(t){this._resetParams(),this._params.zoom=t,this._update(this._params)},_.prototype.offsetX=function(t){this.setX(this._x+t)},_.prototype.offsetY=function(t){this.setY(this._y+t)},_.prototype.offsetZoom=function(t){this.setZoom(this._zoom+t)},_.prototype.setMediaAspectRatio=function(t){this._resetParams(),this._params.mediaAspectRatio=t,this._update(this._params)},_.prototype.setSize=function(t){this._resetParams(),this._params.width=t.width,this._params.height=t.height,this._update(this._params)},_.prototype.setParameters=function(t){this._resetParams();var e=this._params;e.x=t.x,e.y=t.y,e.zoom=t.zoom,e.mediaAspectRatio=t.mediaAspectRatio,this._update(e)},_.prototype.setLimiter=function(t){this._limiter=t||null,this._update()},_.prototype._resetParams=function(){var t=this._params;t.x=null,t.y=null,t.zoom=null,t.mediaAspectRatio=null,t.width=null,t.height=null},_.prototype._update=function(t){null==t&&(this._resetParams(),t=this._params);var e=this._x,i=this._y,r=this._zoom,n=this._mediaAspectRatio,o=this._width,s=this._height;if(t.x=null!=t.x?t.x:e,t.y=null!=t.y?t.y:i,t.zoom=null!=t.zoom?t.zoom:r,t.mediaAspectRatio=null!=t.mediaAspectRatio?t.mediaAspectRatio:n,t.width=null!=t.width?t.width:o,t.height=null!=t.height?t.height:s,this._limiter&&!(t=this._limiter(t)))throw new Error("Bad view limiter");var l=t.x,u=t.y,c=t.zoom,p=t.mediaAspectRatio,f=t.width,d=t.height;if(!(a(l)&&a(u)&&a(c)&&a(p)&&a(f)&&a(d)))throw new Error("Bad view - suspect a broken limiter");c=h(c,1e-9,1/0),this._x=l,this._y=u,this._zoom=c,this._mediaAspectRatio=p,this._width=f,this._height=d,l===e&&u===i&&c===r&&p===n&&f===o&&d===s||(this._projectionChanged=!0,this.emit("change")),f===o&&d===s||this.emit("resize")},_.prototype._zoomX=function(){return this._zoom},_.prototype._zoomY=function(){var t=this._mediaAspectRatio,e=this._width/this._height,i=this._zoom,r=i*t/e;return isNaN(r)&&(r=i),r},_.prototype.updateWithControlParameters=function(t){var e=this.zoom(),i=this._zoomX(),r=this._zoomY();this.offsetX(t.axisScaledX*i+t.x*e),this.offsetY(t.axisScaledY*r+t.y*e),this.offsetZoom(t.zoom*e)},_.prototype.projection=function(){var t=this._projectionMatrix;if(this._projectionChanged){var e=this._x,i=this._y,r=this._zoomX(),o=this._zoomY(),s=this._viewFrustum,a=s[0]=.5-i+.5*o,h=s[1]=e-.5+.5*r,l=s[2]=.5-i-.5*o,u=s[3]=e-.5-.5*r;n.ortho(t,u,h,l,a,-1,1),this._projectionChanged=!1}return t},_.prototype.intersects=function(t){var e=this._viewFrustum;this.projection();for(var i=0;i<e.length;i++){for(var r=e[i],n=m[i],o=v[i],s=!1,a=0;a<t.length;a++){var h=t[a];if(o<0&&h[n]<r||o>0&&h[n]>r){s=!0;break}}if(!s)return!1}return!0},_.prototype.selectLevel=function(t){for(var e=s()*this.width(),i=this._zoom,r=0;r<t.length;r++){var n=t[r];if(i*n.width()>=e)return n}return t[t.length-1]},_.prototype.coordinatesToScreen=function(t,e){var i=this._vertex;e||(e={});var r=this._width,n=this._height;if(r<=0||n<=0)return e.x=null,e.y=null,null;var s=t&&null!=t.x?t.x:p,a=t&&null!=t.y?t.y:f;o.set(i,s-.5,.5-a,-1,1),o.transformMat4(i,i,this.projection());for(var h=0;h<3;h++)i[h]/=i[3];return e.x=r*(i[0]+1)/2,e.y=n*(1-i[1])/2,e},_.prototype.screenToCoordinates=function(t,e){var i=this._vertex,r=this._invProj;e||(e={});var s=this._width,a=this._height;n.invert(r,this.projection());var h=2*t.x/s-1,l=1-2*t.y/a;return o.set(i,h,l,1,1),o.transformMat4(i,i,r),e.x=.5+i[0],e.y=.5-i[1],e},_.limit={x:function(t,e){return function(i){return i.x=h(i.x,t,e),i}},y:function(t,e){return function(i){return i.y=h(i.y,t,e),i}},zoom:function(t,e){return function(i){return i.zoom=h(i.zoom,t,e),i}},resolution:function(t){return function(e){if(e.width<=0||e.height<=0)return e;var i=e.width,r=s()*i/t;return e.zoom=h(e.zoom,r,1/0),e}},visibleX:function(t,e){return function(i){var r=e-t;i.zoom>r&&(i.zoom=r);var n=t+.5*i.zoom,o=e-.5*i.zoom;return i.x=h(i.x,n,o),i}},visibleY:function(t,e){return function(i){if(i.width<=0||i.height<=0)return i;var r=i.width/i.height/i.mediaAspectRatio,n=(e-t)*r;i.zoom>n&&(i.zoom=n);var o=t+.5*i.zoom/r,s=e-.5*i.zoom/r;return i.y=h(i.y,o,s),i}},letterbox:function(){return function(t){if(t.width<=0||t.height<=0)return t;var e,i,r,n,o=t.width/t.height,s=o/t.mediaAspectRatio;return t.mediaAspectRatio>=o&&(t.zoom=Math.min(t.zoom,1)),t.mediaAspectRatio<=o&&(t.zoom=Math.min(t.zoom,s)),t.zoom>1?e=i=.5:(e=0+.5*t.zoom/1,i=1-.5*t.zoom/1),t.zoom>s?r=n=.5:(r=0+.5*t.zoom/s,n=1-.5*t.zoom/s),t.x=h(t.x,e,i),t.y=h(t.y,r,n),t}}},_.type=_.prototype.type="flat",t.exports=_},function(t,e,i){"use strict";var r=i(16),n=i(126),o=i(240),s=i(132),a=i(175),h=i(69),l={x:"x",y:"y",z:"z",f:"face"},u=4,c=1e4;function p(t,e){e=e||{},this._loadPool=new o({concurrency:e.concurrency||u}),this._retryDelay=e.retryDelay||c,this._retryMap={},this._sourceFromTile=t}function f(t){return new RegExp("\\{("+t+")\\}","g")}r(p),p.prototype.loadAsset=function(t,e,i){var r,o=this,l=this._retryDelay,u=this._retryMap,c=this._sourceFromTile(e),p=c.url,f=c.rect,d=t.loadImage.bind(t,p,f),m=u[p];if(null!=m){var v=h()-m;v<l?r=l-v:(r=0,delete u[p])}var _=a.bind(null,r);return s(_,function(t){return o._loadPool.push(d,function(i,r){i?(i instanceof n&&(u[p]=h(),o.emit("networkError",r,i)),t(i,e)):(delete u[p],t(null,e,r))})})(i)},p.fromString=function(t,e){var i=(e=e||{})&&e.cubeMapPreviewFaceOrder||"bdflru";return new p(e.cubeMapPreviewUrl?function(t){return 0===t.z?function(t){var r=i.indexOf(t.face)/6;return{url:e.cubeMapPreviewUrl,rect:{x:0,y:r,width:1,height:1/6}}}(t):r(t)}:r,e);function r(e){var i=t;for(var r in l){var n=l[r],o=f(r),s=e.hasOwnProperty(n)?e[n]:"";i=i.replace(o,s)}return{url:i}}},t.exports=p},function(t,e,i){"use strict";var r=i(125),n=i(85);function o(t){this._concurrency=t&&t.concurrency||1,this._paused=t&&!!t.paused||!1,this._pool=[];for(var e=0;e<this._concurrency;e++)this._pool.push(new r(t));this._next=0}o.prototype.length=function(){for(var t=0,e=0;e<this._pool.length;e++)t+=this._pool[e].length();return t},o.prototype.push=function(t,e){var i=this._next,r=this._pool[i].push(t,e);return this._next=n(this._next+1,this._concurrency),r},o.prototype.pause=function(){if(!this._paused){this._paused=!0;for(var t=0;t<this._concurrency;t++)this._pool[t].pause()}},o.prototype.resume=function(){if(this._paused){this._paused=!1;for(var t=0;t<this._concurrency;t++)this._pool[t].resume()}},t.exports=o},function(t,e,i){"use strict";function r(t){this._asset=t}r.prototype.asset=function(){return this._asset},r.prototype.loadAsset=function(t,e,i){var r=this,n=setTimeout(function(){i(null,e,r._asset)},0);return function(){clearTimeout(n),i.apply(null,arguments)}},t.exports=r},function(t,e,i){"use strict";var r=i(16),n=i(6);function o(t,e){e=e||{},this._opts=e,this._element=t,this._timestamp=0}r(o),o.prototype.dynamic=!0,o.prototype.destroy=function(){n(this)},o.prototype.element=function(){return this._element},o.prototype.width=function(){return this._element.width},o.prototype.height=function(){return this._element.height},o.prototype.timestamp=function(){return this._timestamp},o.prototype.changed=function(){this._timestamp++,this.emit("change")},t.exports=o},function(t,e,i){"use strict";var r=i(85);function n(t,e,i){if("function"!=typeof t)throw new Error("LruSet: bad equals function");if(this._equals=t,"function"!=typeof e)throw new Error("LruSet: bad hash function");if(this._hash=e,"number"!=typeof i||isNaN(i)||i<0)throw new Error("LruSet: bad maximum size");this._maxsize=i,this._items=[],this._pivot=0}n.prototype._modulus=function(){return this._maxsize>this._items.length?this._items.length+1:this._maxsize},n.prototype.add=function(t){var e=null,i=!1;if(0===this._maxsize)return t;for(var n=0;n<this._items.length;n++){var o=this._items[n];if(this._equals(t,o)){for(var s=n,a=this._modulus();s!==this._pivot;){var h=r(s+1,a);this._items[s]=this._items[h],s=h}i=!0;break}}return i||(e=this._pivot<this._items.length?this._items[this._pivot]:null),this._items[this._pivot]=t,this._pivot=r(this._pivot+1,this._modulus()),e},n.prototype.remove=function(t){for(var e=0;e<this._items.length;e++){var i=this._items[e];if(this._equals(t,i)){for(var n=e;n<this._items.length-1;n++)this._items[n]=this._items[n+1];return this._items.length=this._items.length-1,e<this._pivot&&(this._pivot=r(this._pivot-1,this._modulus())),i}}return null},n.prototype.has=function(t){for(var e=0;e<this._items.length;e++){var i=this._items[e];if(this._equals(t,i))return!0}return!1},n.prototype.size=function(){return this._items.length},n.prototype.clear=function(){this._items.length=0,this._pivot=0},n.prototype.each=function(t){for(var e=0,i=0;i<this._items.length;i++){t(this._items[i]),e+=1}return e},t.exports=n},function(t,e,i){"use strict";var r,n=i(6);function o(t,e,i){var r=s();if("wheel"===r)this._fun=e,this._elem=t,this._elem.addEventListener("wheel",this._fun,i);else{if("mousewheel"!==r)throw new Error("Browser does not support mouse wheel events");this._fun=function(t){return function(e){e||(e=window.event);var i={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:1,deltaX:0,deltaZ:0,timeStamp:e.timeStamp||Date.now(),preventDefault:e.preventDefault.bind(e)};return i.deltaY=-.025*e.wheelDelta,e.wheelDeltaX&&(i.deltaX=-.025*e.wheelDeltaX),t(i)}}(e),this._elem=t,this._elem.addEventListener("mousewheel",this._fun,i)}}function s(){return void 0!==r?r:r="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":null}o.prototype.destroy=function(){this._elem.removeEventListener(s(),this._fun),n(this)},t.exports=o},function(t,e,i){"use strict";var r=i(16),n=i(55),o=i(6);function s(t){if(!t)throw new Error("VelocityControlMethod: parameter must be defined");this._parameter=t,this._dynamics=new n}r(s),s.prototype.destroy=function(){o(this)},s.prototype.setVelocity=function(t){this._dynamics.velocity=t,this.emit("parameterDynamics",this._parameter,this._dynamics)},s.prototype.setFriction=function(t){this._dynamics.friction=t,this.emit("parameterDynamics",this._parameter,this._dynamics)},t.exports=s},function(t,e,i){"use strict";var r=i(16),n=i(55),o=i(6);function s(t,e,i,r){if(!t)throw new Error("ElementPressControlMethod: element must be defined");if(!e)throw new Error("ElementPressControlMethod: parameter must be defined");if(!i)throw new Error("ElementPressControlMethod: velocity must be defined");if(!r)throw new Error("ElementPressControlMethod: friction must be defined");this._element=t,this._pressHandler=this._handlePress.bind(this),this._releaseHandler=this._handleRelease.bind(this),t.addEventListener("mousedown",this._pressHandler),t.addEventListener("mouseup",this._releaseHandler),t.addEventListener("mouseleave",this._releaseHandler),t.addEventListener("touchstart",this._pressHandler),t.addEventListener("touchmove",this._releaseHandler),t.addEventListener("touchend",this._releaseHandler),this._parameter=e,this._velocity=i,this._friction=r,this._dynamics=new n,this._pressing=!1}r(s),s.prototype.destroy=function(){this._element.removeEventListener("mousedown",this._pressHandler),this._element.removeEventListener("mouseup",this._releaseHandler),this._element.removeEventListener("mouseleave",this._releaseHandler),this._element.removeEventListener("touchstart",this._pressHandler),this._element.removeEventListener("touchmove",this._releaseHandler),this._element.removeEventListener("touchend",this._releaseHandler),o(this)},s.prototype._handlePress=function(){this._pressing=!0,this._dynamics.velocity=this._velocity,this._dynamics.friction=0,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("active")},s.prototype._handleRelease=function(){this._pressing&&(this._dynamics.friction=this._friction,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("inactive")),this._pressing=!1},t.exports=s},function(t,e,i){"use strict";var r=i(16),n=i(55),o=i(69),s=i(6);function a(t){t=t||{},this._methods=[],this._parameters=["x","y","axisScaledX","axisScaledY","zoom","yaw","pitch","roll"],this._clock=t.clock||o,this._composedOffsets={},this._composeReturn={offsets:this._composedOffsets,changing:null}}r(a),a.prototype.add=function(t){if(!this.has(t)){var e={};this._parameters.forEach(function(t){e[t]={dynamics:new n,time:null}});var i=this._updateDynamics.bind(this,e),r={instance:t,dynamics:e,parameterDynamicsHandler:i};t.addEventListener("parameterDynamics",i),this._methods.push(r)}},a.prototype.remove=function(t){var e=this._indexOfInstance(t);if(e>=0){var i=this._methods.splice(e,1)[0];i.instance.removeEventListener("parameterDynamics",i.parameterDynamicsHandler)}},a.prototype.has=function(t){return this._indexOfInstance(t)>=0},a.prototype._indexOfInstance=function(t){for(var e=0;e<this._methods.length;e++)if(this._methods[e].instance===t)return e;return-1},a.prototype.list=function(){for(var t=[],e=0;e<this._methods.length;e++)t.push(this._methods[e].instance);return t},a.prototype._updateDynamics=function(t,e,i){var r=t[e];if(!r)throw new Error("Unknown control parameter "+e);var n=this._clock();r.dynamics.update(i,(n-r.time)/1e3),r.time=n,this.emit("change")},a.prototype._resetComposedOffsets=function(){for(var t=0;t<this._parameters.length;t++)this._composedOffsets[this._parameters[t]]=0},a.prototype.offsets=function(){var t,e=!1,i=this._clock();this._resetComposedOffsets();for(var r=0;r<this._methods.length;r++)for(var n=this._methods[r].dynamics,o=0;o<this._parameters.length;o++){var s=n[t=this._parameters[o]],a=s.dynamics;null!=a.offset&&(this._composedOffsets[t]+=a.offset,a.offset=null);var h=(i-s.time)/1e3,l=a.offsetFromVelocity(h);l&&(this._composedOffsets[t]+=l);var u=a.velocityAfter(h);a.velocity=u,u&&(e=!0),s.time=i}return this._composeReturn.changing=e,this._composeReturn},a.prototype.destroy=function(){for(var t=this.list(),e=0;e<t.length;e++)this.remove(t[e]);s(this)},t.exports=a},function(t,e,i){"use strict";var r=i(80),n=i(16),o=i(180),s=i(188),a=i(189),h=i(250),l=i(146),u=i(152),c=i(153),p=i(251),f=i(101),d=i(193),m=i(172),v=i(9).setOverflowHidden,_=i(9).setAbsolute,y=i(9).setFullSize,g=i(9).setBlocking,w=i(194),x=i(92),M=i(6),b={webgl:l,css:u,flash:c},S=[l,u,c];function E(t,e){var i;if(e=e||{},this._domElement=t,v(t),e.stageType){if(!(i=b[e.stageType]))throw new Error("Unknown stage type: "+e.stageType)}else{for(var n=0;n<S.length;n++)if(S[n].supported()){i=S[n];break}if(!i)throw new Error("None of the stage types are supported")}this._stage=new i(e.stage),m(this._stage),this._domElement.appendChild(this._stage.domElement()),this._controlContainer=document.createElement("div"),_(this._controlContainer),y(this._controlContainer),r.ios&&this._controlContainer.addEventListener("touchmove",function(t){t.preventDefault()});var a=document.createElement("div");_(a),y(a),g(a),this._controlContainer.appendChild(a),t.appendChild(this._controlContainer),this._size={},this.updateSize(),this._updateSizeListener=this.updateSize.bind(this),window.addEventListener("resize",this._updateSizeListener),this._renderLoop=new o(this._stage),this._controls=new s,this._controlMethods=d(this._controls,this._controlContainer,e.controls),this._controls.attach(this._renderLoop),this._hammerManagerTouch=f.get(this._controlContainer,"touch"),this._hammerManagerMouse=f.get(this._controlContainer,"mouse"),this._dragCursor=new p(this._controls,"mouseViewDrag",t,e.cursors&&e.cursors.drag||{}),this._renderLoop.start(),this._scenes=[],this._currentScene=null,this._replacedScene=null,this._cancelCurrentTween=null,this._layerChangeHandler=this._updateSceneLayers.bind(this),this._viewChangeHandler=this.emit.bind(this,"viewChange"),this._idleTimer=new h,this._idleTimer.start(),this._resetIdleTimerHandler=this._resetIdleTimer.bind(this),this.addEventListener("viewChange",this._resetIdleTimerHandler),this._enterIdleHandler=this._enterIdle.bind(this),this._idleTimer.addEventListener("timeout",this._enterIdleHandler),this._leaveIdleHandler=this._leaveIdle.bind(this),this._controls.addEventListener("active",this._leaveIdleHandler),this.addEventListener("sceneChange",this._leaveIdleHandler),this._idleMovement=null}n(E),E.prototype.destroy=function(){for(var t in window.removeEventListener("resize",this._updateSizeListener),this._currentScene&&this._removeSceneEventListeners(this._currentScene),this._replacedScene&&this._removeSceneEventListeners(this._replacedScene),this._dragCursor.destroy(),this._controlMethods)this._controlMethods[t].destroy();for(;this._scenes.length;)this.destroyScene(this._scenes[0]);this._domElement.removeChild(this._stage.domElement()),this._stage.destroy(),this._renderLoop.destroy(),this._controls.destroy(),this._controls=null,this._cancelCurrentTween&&this._cancelCurrentTween(),M(this)},E.prototype.updateSize=function(){var t=this._size;t.width=this._domElement.clientWidth,t.height=this._domElement.clientHeight,this._stage.setSize(t)},E.prototype.stage=function(){return this._stage},E.prototype.renderLoop=function(){return this._renderLoop},E.prototype.controls=function(){return this._controls},E.prototype.domElement=function(){return this._domElement},E.prototype.createScene=function(t){t=t||{};var e=this.createEmptyScene({view:t.view});return e.createLayer({source:t.source,geometry:t.geometry,pinFirstLevel:t.pinFirstLevel,textureStoreOpts:t.textureStoreOpts,layerOpts:t.layerOpts}),e},E.prototype.createEmptyScene=function(t){var e=new a(this,(t=t||{}).view);return this._scenes.push(e),e},E.prototype._updateSceneLayers=function(){var t,e,i=this._stage,r=this._currentScene,n=this._replacedScene,o=i.listLayers(),s=[];if(n&&(s=s.concat(n.listLayers())),r&&(s=s.concat(r.listLayers())),1!==Math.abs(o.length-s.length))throw new Error("Stage and scene out of sync");if(s.length<o.length)for(t=0;t<o.length;t++)if(e=o[t],s.indexOf(e)<0){this._removeLayerFromStage(e);break}if(s.length>o.length)for(t=0;t<s.length;t++)e=s[t],o.indexOf(e)<0&&this._addLayerToStage(e,t)},E.prototype._addLayerToStage=function(t,e){t.pinFirstLevel(),this._stage.addLayer(t,e)},E.prototype._removeLayerFromStage=function(t){this._stage.removeLayer(t),t.unpinFirstLevel(),t.textureStore().clearNotPinned()},E.prototype._addSceneEventListeners=function(t){t.addEventListener("layerChange",this._layerChangeHandler),t.addEventListener("viewChange",this._viewChangeHandler)},E.prototype._removeSceneEventListeners=function(t){t.removeEventListener("layerChange",this._layerChangeHandler),t.removeEventListener("viewChange",this._viewChangeHandler)},E.prototype.destroyScene=function(t){var e,i,r=this._scenes.indexOf(t);if(r<0)throw new Error("No such scene in viewer");if(this._currentScene===t){for(this._removeSceneEventListeners(t),i=t.listLayers(),e=0;e<i.length;e++)this._removeLayerFromStage(i[e]);this._cancelCurrentTween&&(this._cancelCurrentTween(),this._cancelCurrentTween=null),this._currentScene=null,this.emit("sceneChange")}if(this._replacedScene===t){for(this._removeSceneEventListeners(t),i=t.listLayers(),e=0;e<i.length;e++)this._removeLayerFromStage(i[e]);this._replacedScene=null}this._scenes.splice(r,1),t.destroy()},E.prototype.destroyAllScenes=function(){for(;this._scenes.length>0;)this.destroyScene(this._scenes[0])},E.prototype.hasScene=function(t){return this._scenes.indexOf(t)>=0},E.prototype.listScenes=function(){return[].concat(this._scenes)},E.prototype.scene=function(){return this._currentScene},E.prototype.view=function(){var t=this._currentScene;return t?t.view():null},E.prototype.lookTo=function(t,e,i){var r=this._currentScene;r&&r.lookTo(t,e,i)},E.prototype.startMovement=function(t,e){var i=this._currentScene;i&&i.startMovement(t,e)},E.prototype.stopMovement=function(){var t=this._currentScene;t&&t.stopMovement()},E.prototype.setIdleMovement=function(t,e){this._idleTimer.setDuration(t),this._idleMovement=e},E.prototype.breakIdleMovement=function(){this._leaveIdle(),this._resetIdleTimer()},E.prototype._resetIdleTimer=function(){this._idleTimer.start()},E.prototype._enterIdle=function(){var t=this._currentScene,e=this._idleMovement;t&&e&&t.startMovement(e)},E.prototype._leaveIdle=function(){var t=this._currentScene;t&&t.movement()===this._idleMovement&&t.stopMovement()};function I(t,e,i){e.listLayers().forEach(function(e){e.mergeEffects({opacity:t})}),e._hotspotContainer.domElement().style.opacity=t}E.prototype.switchScene=function(t,e,i){var r=this;e=e||{},i=i||x;var n=this._stage,o=this._currentScene;if(o!==t){if(this._scenes.indexOf(t)<0)throw new Error("No such scene in viewer");this._cancelCurrentTween&&(this._cancelCurrentTween(),this._cancelCurrentTween=null);var s=o?o.listLayers():[],a=t.listLayers(),h=n.listLayers();if(o&&(h.length!==s.length||h.length>1&&h[0]!=s[0]))throw new Error("Stage not in sync with viewer");for(var l=null!=e.transitionDuration?e.transitionDuration:1e3,u=null!=e.transitionUpdate?e.transitionUpdate:I,c=0;c<a.length;c++)this._addLayerToStage(a[c]);this._cancelCurrentTween=w(l,function(e){u(e,t,o)},function(){if(r._replacedScene){r._removeSceneEventListeners(r._replacedScene),s=r._replacedScene.listLayers();for(var t=0;t<s.length;t++)r._removeLayerFromStage(s[t]);r._replacedScene=null}r._cancelCurrentTween=null,i()}),this._currentScene=t,this._replacedScene=o,this.emit("sceneChange"),this.emit("viewChange"),this._addSceneEventListeners(t)}else i()},t.exports=E},function(t,e,i){"use strict";var r,n=i(80);t.exports=function(){return void 0!==r?r:r=function(){var t=document.createElement("a").style;t.cssText="pointer-events:auto";var e="auto"===t.pointerEvents,i=n.msie&&parseFloat(n.version)<11;return e&&!i}()}},function(t,e,i){"use strict";var r=i(16),n=i(48),o=i(69),s={duration:1/0};function a(t){t=n(t||{},s),this._duration=t.duration,this._startTime=null,this._handle=null,this._check=this._check.bind(this)}r(a),a.prototype.start=function(){this._startTime=o(),null==this._handle&&this._duration<1/0&&this._setup(this._duration)},a.prototype.started=function(){return null!=this._startTime},a.prototype.stop=function(){this._startTime=null,null!=this._handle&&(clearTimeout(this._handle),this._handle=null)},a.prototype._setup=function(t){this._handle=setTimeout(this._check,t)},a.prototype._teardown=function(){clearTimeout(this._handle),this._handle=null},a.prototype._check=function(){var t=o()-this._startTime,e=this._duration-t;this._teardown(),e<=0?(this.emit("timeout"),this._startTime=null):e<1/0&&this._setup(e)},a.prototype.duration=function(){return this._duration},a.prototype.setDuration=function(t){this._duration=t,null!=this._startTime&&this._check()},t.exports=a},function(t,e,i){"use strict";var r=i(48),n=i(6),o={active:"move",inactive:"default",disabled:"default"};function s(t,e,i,n){n=r(n||{},o),this._element=i,this._controls=t,this._id=e,this._attached=!1,this._setActiveCursor=this._setCursor.bind(this,n.active),this._setInactiveCursor=this._setCursor.bind(this,n.inactive),this._setDisabledCursor=this._setCursor.bind(this,n.disabled),this._setOriginalCursor=this._setCursor.bind(this,this._element.style.cursor),this._updateAttachmentHandler=this._updateAttachment.bind(this),t.addEventListener("methodEnabled",this._updateAttachmentHandler),t.addEventListener("methodDisabled",this._updateAttachmentHandler),t.addEventListener("enabled",this._updateAttachmentHandler),t.addEventListener("disabled",this._updateAttachmentHandler),this._updateAttachment()}s.prototype.destroy=function(){this._detachFromControlMethod(this._controls.method(this._id)),this._setOriginalCursor(),this._controls.removeEventListener("methodEnabled",this._updateAttachmentHandler),this._controls.removeEventListener("methodDisabled",this._updateAttachmentHandler),this._controls.removeEventListener("enabled",this._updateAttachmentHandler),this._controls.removeEventListener("disabled",this._updateAttachmentHandler),n(this)},s.prototype._updateAttachment=function(){var t=this._controls,e=this._id;t.enabled()&&t.method(e).enabled?this._attachToControlMethod(t.method(e)):this._detachFromControlMethod(t.method(e))},s.prototype._attachToControlMethod=function(t){this._attached||(t.instance.addEventListener("active",this._setActiveCursor),t.instance.addEventListener("inactive",this._setInactiveCursor),t.active?this._setActiveCursor():this._setInactiveCursor(),this._attached=!0)},s.prototype._detachFromControlMethod=function(t){this._attached&&(t.instance.removeEventListener("active",this._setActiveCursor),t.instance.removeEventListener("inactive",this._setInactiveCursor),this._setDisabledCursor(),this._attached=!1)},s.prototype._setCursor=function(t){this._element.style.cursor=t},t.exports=s},function(t,e,i){"use strict";var r=i(84),n=i(59);function o(t,e,i){var n,o,s,a,h,l,u;n=i,o=t,s=e.colorMatrix,a=o[0],h=o[1],l=o[2],u=o[3],n[0]=s[0]*a+s[1]*h+s[2]*l+s[3]*u,n[1]=s[4]*a+s[5]*h+s[6]*l+s[7]*u,n[2]=s[8]*a+s[9]*h+s[10]*l+s[11]*u,n[3]=s[12]*a+s[13]*h+s[14]*l+s[15]*u,r.add(i,i,e.colorOffset)}var s=r.create();t.exports={identity:function(t){var e=t||{};return e.colorOffset=e.colorOffset||r.create(),e.colorMatrix=e.colorMatrix||n.create(),e},applyToPixel:o,applyToImageData:function(t,e){for(var i=t.width,n=t.height,a=t.data,h=0;h<i*n;h++)r.set(s,a[4*h+0]/255,a[4*h+1]/255,a[4*h+2]/255,a[4*h+3]/255),o(s,e,s),a[4*h+0]=255*s[0],a[4*h+1]=255*s[1],a[4*h+2]=255*s[2],a[4*h+3]=255*s[3]}}},function(t,e,i){"use strict";var r=i(48),n={yawSpeed:.1,pitchSpeed:.1,fovSpeed:.1,yawAccel:.01,pitchAccel:.01,fovAccel:.01,targetPitch:0,targetFov:null};t.exports=function(t){var e=(t=r(t||{},n)).yawSpeed,i=t.pitchSpeed,o=t.fovSpeed,s=t.yawAccel,a=t.pitchAccel,h=t.fovAccel,l=t.targetPitch,u=t.targetFov;return function(){var t,r,n,c,p=0,f=0,d=0,m=0,v=0,_=0,y=0;return function(g,w){if(t=(w-p)/1e3,v=Math.min(f+t*s,e),r=v*t,g.yaw=g.yaw+r,null!=l&&g.pitch!==l){var x=.5*d*d/a;_=Math.abs(l-g.pitch)>x?Math.min(d+t*a,i):Math.max(d-t*a,0),n=_*t,l<g.pitch&&(g.pitch=Math.max(l,g.pitch-n)),l>g.pitch&&(g.pitch=Math.min(l,g.pitch+n))}if(null!=u&&g.fov!==l){var M=.5*m*m/h;y=Math.abs(u-g.fov)>M?Math.min(m+t*h,o):Math.max(m-t*h,0),c=y*t,u<g.fov&&(g.fov=Math.max(u,g.fov-c)),u>g.fov&&(g.fov=Math.min(u,g.fov+c))}return p=w,f=v,d=_,m=y,g}}}},function(t,e,i){"use strict";t.exports=function(t){return t*Math.PI/180}},function(t,e,i){e.glMatrix=i(54),e.mat2=i(256),e.mat2d=i(257),e.mat3=i(195),e.mat4=i(59),e.quat=i(258),e.vec2=i(167),e.vec3=i(82),e.vec4=i(84)},function(t,e,i){var r=i(54),n={create:function(){var t=new r.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},clone:function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},fromValues:function(t,e,i,n){var o=new r.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=i,o[3]=n,o},set:function(t,e,i,r,n){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t},transpose:function(t,e){if(t===e){var i=e[1];t[1]=e[2],t[2]=i}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},invert:function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],s=i*o-n*r;return s?(s=1/s,t[0]=o*s,t[1]=-r*s,t[2]=-n*s,t[3]=i*s,t):null},adjoint:function(t,e){var i=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=i,t},determinant:function(t){return t[0]*t[3]-t[2]*t[1]},multiply:function(t,e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=i[0],h=i[1],l=i[2],u=i[3];return t[0]=r*a+o*h,t[1]=n*a+s*h,t[2]=r*l+o*u,t[3]=n*l+s*u,t}};n.mul=n.multiply,n.rotate=function(t,e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=Math.sin(i),h=Math.cos(i);return t[0]=r*h+o*a,t[1]=n*h+s*a,t[2]=r*-a+o*h,t[3]=n*-a+s*h,t},n.scale=function(t,e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=i[0],h=i[1];return t[0]=r*a,t[1]=n*a,t[2]=o*h,t[3]=s*h,t},n.fromRotation=function(t,e){var i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=-i,t[3]=r,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},n.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},n.LDU=function(t,e,i,r){return t[2]=r[2]/r[0],i[0]=r[0],i[1]=r[1],i[3]=r[3]-t[2]*i[1],[t,e,i]},n.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t},n.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t},n.sub=n.subtract,n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},n.equals=function(t,e){var i=t[0],n=t[1],o=t[2],s=t[3],a=e[0],h=e[1],l=e[2],u=e[3];return Math.abs(i-a)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(n-h)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(o-l)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(s-u)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(u))},n.multiplyScalar=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},n.multiplyScalarAndAdd=function(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t},t.exports=n},function(t,e,i){var r=i(54),n={create:function(){var t=new r.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},clone:function(t){var e=new r.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},fromValues:function(t,e,i,n,o,s){var a=new r.ARRAY_TYPE(6);return a[0]=t,a[1]=e,a[2]=i,a[3]=n,a[4]=o,a[5]=s,a},set:function(t,e,i,r,n,o,s){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t[4]=o,t[5]=s,t},invert:function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],s=e[4],a=e[5],h=i*o-r*n;return h?(h=1/h,t[0]=o*h,t[1]=-r*h,t[2]=-n*h,t[3]=i*h,t[4]=(n*a-o*s)*h,t[5]=(r*s-i*a)*h,t):null},determinant:function(t){return t[0]*t[3]-t[1]*t[2]},multiply:function(t,e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=e[4],h=e[5],l=i[0],u=i[1],c=i[2],p=i[3],f=i[4],d=i[5];return t[0]=r*l+o*u,t[1]=n*l+s*u,t[2]=r*c+o*p,t[3]=n*c+s*p,t[4]=r*f+o*d+a,t[5]=n*f+s*d+h,t}};n.mul=n.multiply,n.rotate=function(t,e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=e[4],h=e[5],l=Math.sin(i),u=Math.cos(i);return t[0]=r*u+o*l,t[1]=n*u+s*l,t[2]=r*-l+o*u,t[3]=n*-l+s*u,t[4]=a,t[5]=h,t},n.scale=function(t,e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=e[4],h=e[5],l=i[0],u=i[1];return t[0]=r*l,t[1]=n*l,t[2]=o*u,t[3]=s*u,t[4]=a,t[5]=h,t},n.translate=function(t,e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=e[4],h=e[5],l=i[0],u=i[1];return t[0]=r,t[1]=n,t[2]=o,t[3]=s,t[4]=r*l+o*u+a,t[5]=n*l+s*u+h,t},n.fromRotation=function(t,e){var i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=-i,t[3]=r,t[4]=0,t[5]=0,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},n.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},n.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},n.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t},n.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t},n.sub=n.subtract,n.multiplyScalar=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t},n.multiplyScalarAndAdd=function(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},n.equals=function(t,e){var i=t[0],n=t[1],o=t[2],s=t[3],a=t[4],h=t[5],l=e[0],u=e[1],c=e[2],p=e[3],f=e[4],d=e[5];return Math.abs(i-l)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(n-u)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(o-c)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(s-p)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(a-f)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(h-d)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(d))},t.exports=n},function(t,e,i){var r,n,o,s,a,h,l=i(54),u=i(195),c=i(82),p=i(84),f={};f.create=function(){var t=new l.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},f.rotationTo=(r=c.create(),n=c.fromValues(1,0,0),o=c.fromValues(0,1,0),function(t,e,i){var s=c.dot(e,i);return s<-.999999?(c.cross(r,n,e),c.length(r)<1e-6&&c.cross(r,o,e),c.normalize(r,r),f.setAxisAngle(t,r,Math.PI),t):s>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(c.cross(r,e,i),t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=1+s,f.normalize(t,t))}),f.setAxes=(s=u.create(),function(t,e,i,r){return s[0]=i[0],s[3]=i[1],s[6]=i[2],s[1]=r[0],s[4]=r[1],s[7]=r[2],s[2]=-e[0],s[5]=-e[1],s[8]=-e[2],f.normalize(t,f.fromMat3(t,s))}),f.clone=p.clone,f.fromValues=p.fromValues,f.copy=p.copy,f.set=p.set,f.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},f.setAxisAngle=function(t,e,i){i*=.5;var r=Math.sin(i);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(i),t},f.getAxisAngle=function(t,e){var i=2*Math.acos(e[3]),r=Math.sin(i/2);return 0!=r?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),i},f.add=p.add,f.multiply=function(t,e,i){var r=e[0],n=e[1],o=e[2],s=e[3],a=i[0],h=i[1],l=i[2],u=i[3];return t[0]=r*u+s*a+n*l-o*h,t[1]=n*u+s*h+o*a-r*l,t[2]=o*u+s*l+r*h-n*a,t[3]=s*u-r*a-n*h-o*l,t},f.mul=f.multiply,f.scale=p.scale,f.rotateX=function(t,e,i){i*=.5;var r=e[0],n=e[1],o=e[2],s=e[3],a=Math.sin(i),h=Math.cos(i);return t[0]=r*h+s*a,t[1]=n*h+o*a,t[2]=o*h-n*a,t[3]=s*h-r*a,t},f.rotateY=function(t,e,i){i*=.5;var r=e[0],n=e[1],o=e[2],s=e[3],a=Math.sin(i),h=Math.cos(i);return t[0]=r*h-o*a,t[1]=n*h+s*a,t[2]=o*h+r*a,t[3]=s*h-n*a,t},f.rotateZ=function(t,e,i){i*=.5;var r=e[0],n=e[1],o=e[2],s=e[3],a=Math.sin(i),h=Math.cos(i);return t[0]=r*h+n*a,t[1]=n*h-r*a,t[2]=o*h+s*a,t[3]=s*h-o*a,t},f.calculateW=function(t,e){var i=e[0],r=e[1],n=e[2];return t[0]=i,t[1]=r,t[2]=n,t[3]=Math.sqrt(Math.abs(1-i*i-r*r-n*n)),t},f.dot=p.dot,f.lerp=p.lerp,f.slerp=function(t,e,i,r){var n,o,s,a,h,l=e[0],u=e[1],c=e[2],p=e[3],f=i[0],d=i[1],m=i[2],v=i[3];return(o=l*f+u*d+c*m+p*v)<0&&(o=-o,f=-f,d=-d,m=-m,v=-v),1-o>1e-6?(n=Math.acos(o),s=Math.sin(n),a=Math.sin((1-r)*n)/s,h=Math.sin(r*n)/s):(a=1-r,h=r),t[0]=a*l+h*f,t[1]=a*u+h*d,t[2]=a*c+h*m,t[3]=a*p+h*v,t},f.sqlerp=(a=f.create(),h=f.create(),function(t,e,i,r,n,o){return f.slerp(a,e,n,o),f.slerp(h,i,r,o),f.slerp(t,a,h,2*o*(1-o)),t}),f.invert=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],s=i*i+r*r+n*n+o*o,a=s?1/s:0;return t[0]=-i*a,t[1]=-r*a,t[2]=-n*a,t[3]=o*a,t},f.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},f.length=p.length,f.len=f.length,f.squaredLength=p.squaredLength,f.sqrLen=f.squaredLength,f.normalize=p.normalize,f.fromMat3=function(t,e){var i,r=e[0]+e[4]+e[8];if(r>0)i=Math.sqrt(r+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);var o=(n+1)%3,s=(n+2)%3;i=Math.sqrt(e[3*n+n]-e[3*o+o]-e[3*s+s]+1),t[n]=.5*i,i=.5/i,t[3]=(e[3*o+s]-e[3*s+o])*i,t[o]=(e[3*o+n]+e[3*n+o])*i,t[s]=(e[3*s+n]+e[3*n+s])*i}return t},f.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},f.exactEquals=p.exactEquals,f.equals=p.equals,t.exports=f},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";i.r(e),function(t){var e=i(15),r=i.n(e),n=(i(144),i(223),i(77)),o=i.n(n),s=i(197),a=i.n(s),h=i(119),l=i.n(h);function u(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.scrollCtrl=new r.a.Controller,this.init()}var i,n,s;return i=e,(n=[{key:"init",value:function(){var e=this;console.log("[SHOWROOM]"),this.$exterior=$("#x-design-view"),$("#x-showroom-sticky").length&&$(".vehicel-design").length&&(new r.a.Scene({triggerElement:".vehicel-design",triggerHook:.1}).setClassToggle("#x-showroom-sticky","is-active").addTo(e.scrollCtrl),$("#x-showroom-sticky").on("click",".sticky-head",function(){$(this).toggleClass("is-active")}).on("click",".has-sub > .link",function(t){$(this).toggleClass("is-active"),t.stopPropagation(),t.preventDefault()})),this.$colorize=$("#x-showroom-colorize"),this.$colorize.length&&(e.$exteriorSwatches=$("#x-exterior-swatches"),e.$interiorSwatches=$("#x-interior-swatches"),e.$toggleVehicleLine=$("#x-toggle-vehicle-line"),e.toggleVehicleLine=0,e.initExterior(),this.$colorize.on("click",".tab",function(t){var i=$(this);i.addClass("is-active").siblings().removeClass("is-active"),"#x-show-interior"===i.attr("href")?(e.initInterior(),e.showInterior()):e.showExterior(),t.stopPropagation(),t.preventDefault()}),e.$interiorSwatches.on("click",".swatch-btn",function(){e.$colorize.hasClass("on-interior")||$('[href="#x-show-interior"]').trigger("click"),e.changeInterior($(this))}),this.$toggleVehicleLine.on("change",function(){var t=e.$toggleVehicleLine.siblings(".label-text:visible").text();$("#x-vehicle-line-name").text(t),e.changeExterior(),$("#x-interior").is(":empty")||e.changeInterior(e.$interiorSwatches.find(".is-active").find(".swatch-btn"))})),$("#seekslider").length&&this.explore(),$(".spread-side").length&&this.spreadSide(),Util.switchedResize("swap-img-video",function(){return t.size>1},function(t){t?$(".bg-img[data-source-src]").each(function(t,e){var i=$(e),r='<video class="bg-video"\n            '.concat($(e).data("video-attr"),'\n            poster="').concat($(e).data("poster-src"),'"\n            src="').concat($(e).data("source-src"),'"></video>\n          ');i.hide(),i.next().length&&i.next().is("video")?(i.next().show(),i.next()[0].play()):($(r).appendTo(i.parent()),$(r)[0].play(),l()(document.querySelectorAll(".bg-video")))}):$(".bg-img[data-source-src]").each(function(t,e){$(e).show().next().hide()})})}},{key:"initExterior",value:function(){var e=this,i=$("#x-exterior-color-name");e.$exteriorSwatches.on("click",".swatch-btn",function(){var t=$(this);e.$colorize.hasClass("on-exterior")||$('[href="#x-show-exterior"]').trigger("click"),e.$exteriorSwatches.find(".swatch").removeClass("is-active"),t.parent().addClass("is-active"),i.text(t.text()),e.changeExterior()}),t.size>2&&e.$exteriorSwatches.find(".is-active").find(".swatch-btn").trigger("click")}},{key:"changeExterior",value:function(){var e,i,r,n,o=this.$exterior.data("url");i=this.$toggleVehicleLine.siblings(".label-text:visible").data("value"),r=this.$exteriorSwatches.find(".is-active").find(".swatch-btn").data("exterior"),n=t.size>2?"d":"m",e="".concat(o).concat(i,"/exterior/").concat(r,"/##-").concat(n,".png"),this.$exterior.reel("images",e)}},{key:"showExterior",value:function(){this.$colorize.removeClass("theme-dark on-interior").addClass("on-exterior")}},{key:"initInterior",value:function(){var t=this;if($("#x-interior").is(":empty")){t.interiorViewArr=[[],[]],t.interiorSceneArr=[[],[]],t.interiorViewer=new o.a.Viewer(document.getElementById("x-interior")),t.interiorGeometry=new o.a.EquirectGeometry([{width:2048}]),t.newLimiters={},t.newLimiters.traditional=o.a.RectilinearView.limit.traditional(2048,100*Math.PI/180),t.interiorLimiter=o.a.util.compose(t.newLimiters.traditional);var e=t.$toggleVehicleLine.is(":checked")?0:1;t.$interiorSwatches.find(".swatch-btn").each(function(i,r){t.creatInteriorScene(e,i,r)}),t.changeInterior(t.$interiorSwatches.find(".is-active").find(".swatch-btn"))}}},{key:"creatInteriorScene",value:function(t,e,i){var r,n=$("#x-interior").data("src"),s=$("#x-interior").data("panorama"),a=[];a[0]=this.$toggleVehicleLine.siblings(".on").data("value"),a[1]=this.$toggleVehicleLine.siblings(".off").data("value");var h=n+a[t]+"/interior/"+$(i).data("interior")+"/"+s;this.interiorViewArr[t][e]=new o.a.RectilinearView(null,this.interiorLimiter),this.interiorViewArr[t][e].setParameters({yaw:0*Math.PI/180,pitch:15*Math.PI/180,fov:80*Math.PI/180}),this.interiorViewArr[t][e].offsetYaw(-50*Math.PI/180),this.interiorViewArr[t][e].offsetPitch(0*Math.PI/180),this.interiorViewArr[t][e].offsetFov(.5*Math.PI/180),r=o.a.ImageUrlSource.fromString(h),this.interiorSceneArr[t][e]=this.interiorViewer.createScene({source:r,geometry:this.interiorGeometry,view:this.interiorViewArr[t][e],pinFirstLevel:!0})}},{key:"changeInterior",value:function(t){var e=this,i=this.$toggleVehicleLine.is(":checked")?0:1,r=t.parent().index();t.parent().addClass("is-active").siblings().removeClass("is-active"),e.interiorSceneArr[i].length||e.$interiorSwatches.find(".swatch-btn").each(function(t,r){e.creatInteriorScene(i,t,r)}),e.interiorSceneArr[i][r].switchTo({transitionDuration:1e3})}},{key:"showInterior",value:function(){this.$colorize.addClass("theme-dark on-interior").removeClass("on-exterior")}},{key:"explore",value:function(){var e=$(".interactive-explore"),i=e.find(".h4"),n=document.getElementById("seekslider"),o=document.getElementById("design-explore"),s=$(o),h=$(n),l=$(".explore-desc"),u=[];if($.each(s.data("timeline").split(","),function(t,e){u.push(parseFloat(e))}),s.length){var c=[s.attr("src"),s.data("src")];Util.switchedResize("changeVideo",function(){return t.size>1},function(t){t?s.attr("src",c[1]):s.attr("src",c[0])});var p,f,d,m,v=0,_=0;$(".explore-desc").addClass(function(){return"dl-"+$(this).index()}),o.pause(),new r.a.Scene({triggerElement:".interactive-explore",triggerHook:.8}).on("enter",function(){s.hasClass("setup")||(s.addClass("setup"),o.currentTime=0,o.play(),v=u[0],m=requestAnimationFrame(b),setTimeout(function(){!function t(){_<u.length-1?(n.noUiSlider.set(u[_+1]),d=setTimeout(function(){t()},5500)):(n.noUiSlider.set(u[0]),window.clearTimeout(d))}()},4500))}).addTo(this.scrollCtrl),a.a.create(n,{start:0,snap:!0,connect:[!0,!1],range:{min:u[0],"20%":u[1],"40%":u[2],"60%":u[3],"80%":u[4],max:u[5]},pips:{mode:"values",values:u,density:12}}),$(".noUi-value").each(function(t,e){var i=$(".explore-desc").eq(t).find("dt").find(".eyebrow").text();$(e).text($(".explore-desc").eq(t).find("dt").text().replace(i,""))}),n.noUiSlider.on("start",function(){window.clearTimeout(d)}),n.noUiSlider.on("update.seek",function(e,r,n,s,a){s&&window.clearTimeout(d),window.clearTimeout(p),window.clearTimeout(f),_=a[r]/20,v=e[r],isNaN(o.duration)||(o.currentTime=_-1<0?0:u[_-1]),o.play(),m=window.requestAnimationFrame(b),l.removeClass("is-active"),l.eq(_).css("display","block"),p=setTimeout(function(){!function(t){l.not(l.eq(t)).hide()}(_)},t.size>2?600:0),f=setTimeout(function(){!function(t){switch(l.eq(t).addClass("is-active"),t){case 0:h.removeClass("is-dark"),i.removeClass("is-invert");break;case 1:h.removeClass("is-dark"),i.addClass("is-invert");break;case 2:h.addClass("is-dark"),i.removeClass("is-invert");break;case 3:h.addClass("is-dark"),i.addClass("is-invert");break;case 4:h.removeClass("is-dark"),i.removeClass("is-invert");break;case 5:h.removeClass("is-dark"),i.addClass("is-invert")}}(_)},t.size>2?1e3:10),h.find(".noUi-marker-large").removeClass("highlight").eq(_).prevAll().addClass("highlight")}),h.on("click",".noUi-marker-large",function(t){n.noUiSlider.set(u[$(t.target).index(".noUi-marker-large")])});var y=0,g=0,w=0,x=0,M=e.find(".video-wrap");M.on("touchstart",function(t){y=t.originalEvent.changedTouches[0].screenX,g=t.originalEvent.changedTouches[0].screenY}),M.on("touchend",function(t){w=t.originalEvent.changedTouches[0].screenX,x=t.originalEvent.changedTouches[0].screenY,function(){var t;w<y&&Math.abs(x-g)<40&&((t=Math.min(_+1,u.length-1))!==_&&n.noUiSlider.set(u[t]),window.clearTimeout(d));w>y&&Math.abs(x-g)<40&&((t=Math.max(_-1,0))!==_&&n.noUiSlider.set(u[t]),window.clearTimeout(d))}()})}function b(){o.currentTime>=v?(o.pause(),window.cancelAnimationFrame(m)):m=window.requestAnimationFrame(b)}}},{key:"spreadSide",value:function(){var e=$(".l-wrap");t.$win.on("scroll.play-start",function(){$.each(e,function(e,i){var r=$(i),n=r.find("video");r.hasClass("played")||t.scrollTop+300>r.offset().top&&t.scrollTop<r.offset().top+r.height()&&(r.addClass("played"),n.length&&(n.hasClass("is-loaded")||n.attr("src",function(){return $(this).attr("data-src")}).addClass("is-loaded"),r.find("video")[0].play()))}),e.is(".played").length===e.length&&t.$win.off("scroll.play-start")})}}])&&u(i.prototype,n),s&&u(i,s),e}();$(function(){new c})}.call(this,i(3))}]);